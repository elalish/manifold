var Bh=Object.create,Ra=Object.defineProperty,$h=Object.getOwnPropertyDescriptor,Ia=Object.getOwnPropertyNames,Vh=Object.getPrototypeOf,Gh=Object.prototype.hasOwnProperty,ut=(e,t)=>function(){return e&&(t=(0,e[Ia(e)[0]])(e=0)),t},Sr=(e,t)=>function(){return t||(0,e[Ia(e)[0]])((t={exports:{}}).exports,t),t.exports},Sa=(e,t)=>{for(var n in t)Ra(e,n,{get:t[n],enumerable:!0})},zh=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Ia(t))!Gh.call(e,s)&&s!==n&&Ra(e,s,{get:()=>t[s],enumerable:!(r=$h(t,s))||r.enumerable});return e},ps=(e,t,n)=>(n=e!=null?Bh(Vh(e)):{},zh(Ra(n,"default",{value:e,enumerable:!0}),e)),Mi,nr,Nc,kn,Je,Jt,He,Xn,Oc,el=ut({"node_modules/property-graph/dist/index.mjs"(){Mi=class{_listeners={};addEventListener(e,t){const n=this._listeners;return n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t),this}removeEventListener(e,t){const n=this._listeners[e];if(n!==void 0){const r=n.indexOf(t);r!==-1&&n.splice(r,1)}return this}dispatchEvent(e){const t=this._listeners[e.type];if(t!==void 0){const n=t.slice(0);for(let r=0,s=n.length;r<s;r++)n[r].call(this,e)}return this}dispose(){for(const e in this._listeners)delete this._listeners[e]}},nr=class{_disposed=!1;_name;_parent;_child;_attributes;constructor(e,t,n,r={}){if(this._name=e,this._parent=t,this._child=n,this._attributes=r,!t.isOnGraph(n))throw new Error("Cannot connect disconnected graphs.")}getName(){return this._name}getParent(){return this._parent}getChild(){return this._child}setChild(e){return this._child=e,this}getAttributes(){return this._attributes}dispose(){this._disposed||(this._parent._destroyRef(this),this._disposed=!0)}isDisposed(){return this._disposed}},Nc=class extends Mi{_emptySet=new Set;_edges=new Set;_parentEdges=new Map;_childEdges=new Map;listEdges(){return Array.from(this._edges)}listParentEdges(e){return Array.from(this._childEdges.get(e)||this._emptySet)}listParents(e){const t=new Set;for(const n of this.listParentEdges(e))t.add(n.getParent());return Array.from(t)}listChildEdges(e){return Array.from(this._parentEdges.get(e)||this._emptySet)}listChildren(e){const t=new Set;for(const n of this.listChildEdges(e))t.add(n.getChild());return Array.from(t)}disconnectParents(e,t){for(const n of this.listParentEdges(e))(!t||t(n.getParent()))&&n.dispose();return this}_createEdge(e,t,n,r){const s=new nr(e,t,n,r);this._edges.add(s);const i=s.getParent();this._parentEdges.has(i)||this._parentEdges.set(i,new Set),this._parentEdges.get(i).add(s);const o=s.getChild();return this._childEdges.has(o)||this._childEdges.set(o,new Set),this._childEdges.get(o).add(s),s}_destroyEdge(e){return this._edges.delete(e),this._parentEdges.get(e.getParent()).delete(e),this._childEdges.get(e.getChild()).delete(e),this}},kn=class{list=[];constructor(e){if(e)for(const t of e)this.list.push(t)}add(e){this.list.push(e)}remove(e){const t=this.list.indexOf(e);t>=0&&this.list.splice(t,1)}removeChild(e){const t=[];for(const n of this.list)n.getChild()===e&&t.push(n);for(const n of t)this.remove(n);return t}listRefsByChild(e){const t=[];for(const n of this.list)n.getChild()===e&&t.push(n);return t}values(){return this.list}},Je=class{set=new Set;map=new Map;constructor(e){if(e)for(const t of e)this.add(t)}add(e){const t=e.getChild();this.removeChild(t),this.set.add(e),this.map.set(t,e)}remove(e){this.set.delete(e),this.map.delete(e.getChild())}removeChild(e){const t=this.map.get(e)||null;return t&&this.remove(t),t}getRefByChild(e){return this.map.get(e)||null}values(){return Array.from(this.set)}},Jt=class{map={};constructor(e){e&&Object.assign(this.map,e)}set(e,t){this.map[e]=t}delete(e){delete this.map[e]}get(e){return this.map[e]||null}keys(){return Object.keys(this.map)}values(){return Object.values(this.map)}},He=Symbol("attributes"),Xn=Symbol("immutableKeys"),Oc=class Dc extends Mi{_disposed=!1;graph;[He];[Xn];constructor(t){super(),this.graph=t,this[Xn]=new Set,this[He]=this._createAttributes()}getDefaults(){return{}}_createAttributes(){const t=this.getDefaults(),n={};for(const r in t){const s=t[r];if(s instanceof Dc){const i=this.graph._createEdge(r,this,s);this[Xn].add(r),n[r]=i}else n[r]=s}return n}isOnGraph(t){return this.graph===t.graph}isDisposed(){return this._disposed}dispose(){this._disposed||(this.graph.listChildEdges(this).forEach(t=>t.dispose()),this.graph.disconnectParents(this),this._disposed=!0,this.dispatchEvent({type:"dispose"}))}detach(){return this.graph.disconnectParents(this),this}swap(t,n){for(const r in this[He]){const s=this[He][r];if(s instanceof nr){const i=s;i.getChild()===t&&this.setRef(r,n,i.getAttributes())}else if(s instanceof kn)for(const i of s.listRefsByChild(t)){const o=i.getAttributes();this.removeRef(r,t),this.addRef(r,n,o)}else if(s instanceof Je){const i=s.getRefByChild(t);if(i){const o=i.getAttributes();this.removeRef(r,t),this.addRef(r,n,o)}}else if(s instanceof Jt)for(const i of s.keys()){const o=s.get(i);o.getChild()===t&&this.setRefMap(r,i,n,o.getAttributes())}}return this}get(t){return this[He][t]}set(t,n){return this[He][t]=n,this.dispatchEvent({type:"change",attribute:t})}getRef(t){const n=this[He][t];return n?n.getChild():null}setRef(t,n,r){if(this[Xn].has(t))throw new Error(`Cannot overwrite immutable attribute, "${t}".`);const s=this[He][t];if(s&&s.dispose(),!n)return this;const i=this.graph._createEdge(t,this,n,r);return this[He][t]=i,this.dispatchEvent({type:"change",attribute:t})}listRefs(t){return this.assertRefList(t).values().map(n=>n.getChild())}addRef(t,n,r){const s=this.graph._createEdge(t,this,n,r);return this.assertRefList(t).add(s),this.dispatchEvent({type:"change",attribute:t})}removeRef(t,n){const r=this.assertRefList(t);if(r instanceof kn)for(const s of r.listRefsByChild(n))s.dispose();else{const s=r.getRefByChild(n);s&&s.dispose()}return this}assertRefList(t){const n=this[He][t];if(n instanceof kn||n instanceof Je)return n;throw new Error(`Expected RefList or RefSet for attribute "${t}"`)}listRefMapKeys(t){return this.assertRefMap(t).keys()}listRefMapValues(t){return this.assertRefMap(t).values().map(n=>n.getChild())}getRefMap(t,n){const r=this.assertRefMap(t).get(n);return r?r.getChild():null}setRefMap(t,n,r,s){const i=this.assertRefMap(t),o=i.get(n);if(o&&o.dispose(),!r)return this;s=Object.assign(s||{},{key:n});const a=this.graph._createEdge(t,this,r,{...s,key:n});return i.set(n,a),this.dispatchEvent({type:"change",attribute:t,key:n})}assertRefMap(t){const n=this[He][t];if(n instanceof Jt)return n;throw new Error(`Expected RefMap for attribute "${t}"`)}dispatchEvent(t){return super.dispatchEvent({...t,target:this}),this.graph.dispatchEvent({...t,target:this,type:`node:${t.type}`}),this}_destroyRef(t){const n=t.getName();if(this[He][n]===t)this[He][n]=null,this[Xn].has(n)&&t.getChild().dispose();else if(this[He][n]instanceof kn)this[He][n].remove(t);else if(this[He][n]instanceof Je)this[He][n].remove(t);else if(this[He][n]instanceof Jt){const r=this[He][n];for(const s of r.keys())r.get(s)===t&&r.delete(s)}else return;this.graph._destroyEdge(t),this.dispatchEvent({type:"change",attribute:n})}}}});function Hh(e,t){if(t>e.byteLength)throw new TypeError("Corrupt JPG, exceeded buffer limits");if(e.getUint8(t)!==255)throw new TypeError("Invalid JPG, marker table corrupted");return e}function Wh(){var e=new Hs(3);return Hs!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Ci(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}function Xh(e,t,n){var r=t[0],s=t[1],i=t[2],o=n[3]*r+n[7]*s+n[11]*i+n[15];return o=o||1,e[0]=(n[0]*r+n[4]*s+n[8]*i+n[12])/o,e[1]=(n[1]*r+n[5]*s+n[9]*i+n[13])/o,e[2]=(n[2]*r+n[6]*s+n[10]*i+n[14])/o,e}function qh(e){const t=Pc(),n=e.propertyType===k.NODE?[e]:e.listChildren();for(const r of n)r.traverse(s=>{const i=s.getMesh();if(!i)return;const o=Kh(i,s.getWorldMatrix());o.min.every(isFinite)&&o.max.every(isFinite)&&(ea(o.min,t),ea(o.max,t))});return t}function Kh(e,t){const n=Pc();for(const r of e.listPrimitives()){const s=r.getAttribute("POSITION"),i=r.getIndices();if(!s)continue;let o=[0,0,0],a=[0,0,0];for(let u=0,f=i?i.getCount():s.getCount();u<f;u++){const m=i?i.getScalar(u):u;o=s.getElement(m,o),a=Xh(a,o,t),ea(a,n)}}return n}function ea(e,t){for(let n=0;n<3;n++)t.min[n]=Math.min(e[n],t.min[n]),t.max[n]=Math.max(e[n],t.max[n])}function Pc(){return{min:[1/0,1/0,1/0],max:[-1/0,-1/0,-1/0]}}function tl(e){return Object.prototype.toString.call(e)==="[object Object]"}function rr(e){if(tl(e)===!1)return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(tl(n)===!1||Object.hasOwn(n,"isPrototypeOf")===!1)}function Yh(e){var t=e[0],n=e[1],r=e[2],s=e[3],i=e[4],o=e[5],a=e[6],u=e[7],f=e[8],m=e[9],y=e[10],g=e[11],p=e[12],M=e[13],R=e[14],h=e[15],V=t*o-n*i,I=t*a-r*i,C=n*a-r*o,S=f*M-m*p,G=f*R-y*p,v=m*R-y*M,w=t*v-n*G+r*S,N=i*v-o*G+a*S,P=f*C-m*I+y*V,U=p*C-M*I+R*V;return u*w-s*N+h*P-g*U}function Jh(e,t,n){var r=t[0],s=t[1],i=t[2],o=t[3],a=t[4],u=t[5],f=t[6],m=t[7],y=t[8],g=t[9],p=t[10],M=t[11],R=t[12],h=t[13],V=t[14],I=t[15],C=n[0],S=n[1],G=n[2],v=n[3];return e[0]=C*r+S*a+G*y+v*R,e[1]=C*s+S*u+G*g+v*h,e[2]=C*i+S*f+G*p+v*V,e[3]=C*o+S*m+G*M+v*I,C=n[4],S=n[5],G=n[6],v=n[7],e[4]=C*r+S*a+G*y+v*R,e[5]=C*s+S*u+G*g+v*h,e[6]=C*i+S*f+G*p+v*V,e[7]=C*o+S*m+G*M+v*I,C=n[8],S=n[9],G=n[10],v=n[11],e[8]=C*r+S*a+G*y+v*R,e[9]=C*s+S*u+G*g+v*h,e[10]=C*i+S*f+G*p+v*V,e[11]=C*o+S*m+G*M+v*I,C=n[12],S=n[13],G=n[14],v=n[15],e[12]=C*r+S*a+G*y+v*R,e[13]=C*s+S*u+G*g+v*h,e[14]=C*i+S*f+G*p+v*V,e[15]=C*o+S*m+G*M+v*I,e}function Zh(e,t){var n=t[0],r=t[1],s=t[2],i=t[4],o=t[5],a=t[6],u=t[8],f=t[9],m=t[10];return e[0]=Math.sqrt(n*n+r*r+s*s),e[1]=Math.sqrt(i*i+o*o+a*a),e[2]=Math.sqrt(u*u+f*f+m*m),e}function Qh(e,t){var n=new Hs(3);Zh(n,t);var r=1/n[0],s=1/n[1],i=1/n[2],o=t[0]*r,a=t[1]*s,u=t[2]*i,f=t[4]*r,m=t[5]*s,y=t[6]*i,g=t[8]*r,p=t[9]*s,M=t[10]*i,R=o+m+M,h=0;return R>0?(h=Math.sqrt(R+1)*2,e[3]=.25*h,e[0]=(y-p)/h,e[1]=(g-u)/h,e[2]=(a-f)/h):o>m&&o>M?(h=Math.sqrt(1+o-m-M)*2,e[3]=(y-p)/h,e[0]=.25*h,e[1]=(a+f)/h,e[2]=(g+u)/h):m>M?(h=Math.sqrt(1+m-o-M)*2,e[3]=(g-u)/h,e[0]=(a+f)/h,e[1]=.25*h,e[2]=(y+p)/h):(h=Math.sqrt(1+M-o-m)*2,e[3]=(a-f)/h,e[0]=(g+u)/h,e[1]=(y+p)/h,e[2]=.25*h),e}function ed(e,t){if(!!e!=!!t)return!1;const n=e.getChild(),r=t.getChild();return n===r||n.equals(r)}function td(e,t){if(!!e!=!!t)return!1;const n=e.values(),r=t.values();if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++){const i=n[s],o=r[s];if(i.getChild()!==o.getChild()&&!i.getChild().equals(o.getChild()))return!1}return!0}function nd(e,t){if(!!e!=!!t)return!1;const n=e.keys(),r=t.keys();if(n.length!==r.length)return!1;for(const s of n){const i=e.get(s),o=t.get(s);if(!!i!=!!o)return!1;const a=i.getChild(),u=o.getChild();if(a!==u&&!a.equals(u))return!1}return!0}function Fc(e,t){if(e===t)return!0;if(!!e!=!!t||!e||!t||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Uc(e,t){if(e===t)return!0;if(!!e!=!!t)return!1;if(!rr(e)||!rr(t))return e===t;const n=e,r=t;let s=0,i=0,o;for(o in n)s++;for(o in r)i++;if(s!==i)return!1;for(o in n){const a=n[o],u=r[o];if(zs(a)&&zs(u)){if(!Fc(a,u))return!1}else if(rr(a)&&rr(u)){if(!Uc(a,u))return!1}else if(a!==u)return!1}return!0}function zs(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function rd(e){switch(e.constructor){case Float32Array:return ge.ComponentType.FLOAT;case Uint32Array:return ge.ComponentType.UNSIGNED_INT;case Uint16Array:return ge.ComponentType.UNSIGNED_SHORT;case Uint8Array:return ge.ComponentType.UNSIGNED_BYTE;case Int16Array:return ge.ComponentType.SHORT;case Int8Array:return ge.ComponentType.BYTE;default:throw new Error("Unknown accessor componentType.")}}function Dt(){return Dt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Dt.apply(null,arguments)}function sd(e,t){const n=t.jsonDoc,r=t.bufferViews[e.bufferView],s=n.json.bufferViews[e.bufferView],i=cs[e.componentType],o=ge.getElementSize(e.type),a=i.BYTES_PER_ELEMENT,u=e.byteOffset||0,f=new i(e.count*o),m=new DataView(r.buffer,r.byteOffset,r.byteLength),y=s.byteStride;for(let g=0;g<e.count;g++)for(let p=0;p<o;p++){const M=u+g*y+p*a;let R;switch(e.componentType){case ge.ComponentType.FLOAT:R=m.getFloat32(M,!0);break;case ge.ComponentType.UNSIGNED_INT:R=m.getUint32(M,!0);break;case ge.ComponentType.UNSIGNED_SHORT:R=m.getUint16(M,!0);break;case ge.ComponentType.UNSIGNED_BYTE:R=m.getUint8(M);break;case ge.ComponentType.SHORT:R=m.getInt16(M,!0);break;case ge.ComponentType.BYTE:R=m.getInt8(M);break;default:throw new Error(`Unexpected componentType "${e.componentType}".`)}f[g*o+p]=R}return f}function Us(e,t){const n=t.jsonDoc,r=t.bufferViews[e.bufferView],s=n.json.bufferViews[e.bufferView],i=cs[e.componentType],o=ge.getElementSize(e.type),a=i.BYTES_PER_ELEMENT,u=o*a;if(s.byteStride!==void 0&&s.byteStride!==u)return sd(e,t);const f=r.byteOffset+(e.byteOffset||0),m=e.count*o*a;return new i(r.buffer.slice(f,f+m))}function id(e,t){const n=cs[e.componentType],r=ge.getElementSize(e.type);let s;e.bufferView!==void 0?s=Us(e,t):s=new n(e.count*r);const i=e.sparse;if(!i)return s;const o=i.count,a=Dt({},e,i.indices,{count:o,type:"SCALAR"}),u=Dt({},e,i.values,{count:o}),f=Us(a,t),m=Us(u,t);for(let y=0;y<a.count;y++)for(let g=0;g<r;g++)s[f[y]*r+g]=m[y*r+g];return s}function od(e,t){const n=e.getGraph().listParentEdges(t).find(r=>r.getParent()!==e.getRoot());return n?n.getName().replace(/texture$/i,""):""}function ad(e){const t=[];for(const n in e){const r=e[n];(Array.isArray(r)&&r.length===0||r===null||r===""||r&&typeof r=="object"&&Object.keys(r).length===0)&&t.push(n)}for(const n of t)delete e[n]}function ld(e,t){return t.uri!==void 0&&!(t.uri in e.resources)}function cd(e,t){return t.uri!==void 0&&!(t.uri in e.resources)&&t.bufferView===void 0}function nl(e){if(e.byteLength<3*Uint32Array.BYTES_PER_ELEMENT)return!1;const t=new Uint32Array(e.buffer,e.byteOffset,3);return t[0]===1179937895&&t[1]===2}var Ni,er,k,Is,$t,Kt,Hn,cs,Ne,rl,Oi,ln,Zn,Hs,Di,yr,Pi,Fi,Wn,st,Ui,sl,il,Li,ol,al,Pn,ll,Ss,St,ge,ki,Qr,qr,ji,vr,et,tt,Dr,Pr,Fr,cl,Qn,Bi,$i,_n,ul,Vi,Gi,zi,ta,Ls,Ke,fl,Hi,hl,dl,Ur,Yt,Wi,Lr,pl,gl,ml,yl,vl,As,Tl,Lc,ar=ut({"node_modules/@gltf-transform/core/dist/index.modern.js"(){el(),el(),Ni="v4.3.0",er="@glb.bin",(function(e){e.ACCESSOR="Accessor",e.ANIMATION="Animation",e.ANIMATION_CHANNEL="AnimationChannel",e.ANIMATION_SAMPLER="AnimationSampler",e.BUFFER="Buffer",e.CAMERA="Camera",e.MATERIAL="Material",e.MESH="Mesh",e.PRIMITIVE="Primitive",e.PRIMITIVE_TARGET="PrimitiveTarget",e.NODE="Node",e.ROOT="Root",e.SCENE="Scene",e.SKIN="Skin",e.TEXTURE="Texture",e.TEXTURE_INFO="TextureInfo"})(k||(k={})),(function(e){e.INTERLEAVED="interleaved",e.SEPARATE="separate"})(Is||(Is={})),(function(e){e.ARRAY_BUFFER="ARRAY_BUFFER",e.ELEMENT_ARRAY_BUFFER="ELEMENT_ARRAY_BUFFER",e.INVERSE_BIND_MATRICES="INVERSE_BIND_MATRICES",e.OTHER="OTHER",e.SPARSE="SPARSE"})($t||($t={})),(function(e){e[e.R=4096]="R",e[e.G=256]="G",e[e.B=16]="B",e[e.A=1]="A"})(Kt||(Kt={})),(function(e){e.GLTF="GLTF",e.GLB="GLB"})(Hn||(Hn={})),cs={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Ne=class{static createBufferFromDataURI(e){if(typeof Buffer>"u"){const t=atob(e.split(",")[1]),n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}else{const t=e.split(",")[1],n=e.indexOf("base64")>=0;return Buffer.from(t,n?"base64":"utf8")}}static encodeText(e){return new TextEncoder().encode(e)}static decodeText(e){return new TextDecoder().decode(e)}static concat(e){let t=0;for(const s of e)t+=s.byteLength;const n=new Uint8Array(t);let r=0;for(const s of e)n.set(s,r),r+=s.byteLength;return n}static pad(e,t=0){const n=this.padNumber(e.byteLength);if(n===e.byteLength)return e;const r=new Uint8Array(n);if(r.set(e),t!==0)for(let s=e.byteLength;s<n;s++)r[s]=t;return r}static padNumber(e){return Math.ceil(e/4)*4}static equals(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;let n=e.byteLength;for(;n--;)if(e[n]!==t[n])return!1;return!0}static toView(e,t=0,n=1/0){return new Uint8Array(e.buffer,e.byteOffset+t,Math.min(e.byteLength,n))}static assertView(e){if(e&&!ArrayBuffer.isView(e))throw new Error(`Method requires Uint8Array parameter; received "${typeof e}".`);return e}},rl=class{match(e){return e.length>=3&&e[0]===255&&e[1]===216&&e[2]===255}getSize(e){let t=new DataView(e.buffer,e.byteOffset+4),n,r;for(;t.byteLength;){if(n=t.getUint16(0,!1),Hh(t,n),r=t.getUint8(n+1),r===192||r===193||r===194)return[t.getUint16(n+7,!1),t.getUint16(n+5,!1)];t=new DataView(e.buffer,t.byteOffset+n+2)}throw new TypeError("Invalid JPG, no size found")}getChannels(e){return 3}},Oi=class kc{match(t){return t.length>=8&&t[0]===137&&t[1]===80&&t[2]===78&&t[3]===71&&t[4]===13&&t[5]===10&&t[6]===26&&t[7]===10}getSize(t){const n=new DataView(t.buffer,t.byteOffset);return Ne.decodeText(t.slice(12,16))===kc.PNG_FRIED_CHUNK_NAME?[n.getUint32(32,!1),n.getUint32(36,!1)]:[n.getUint32(16,!1),n.getUint32(20,!1)]}getChannels(t){return 4}},Oi.PNG_FRIED_CHUNK_NAME="CgBI",ln=class{static registerFormat(e,t){this.impls[e]=t}static getMimeType(e){for(const t in this.impls)if(this.impls[t].match(e))return t;return null}static getSize(e,t){return this.impls[t]?this.impls[t].getSize(e):null}static getChannels(e,t){return this.impls[t]?this.impls[t].getChannels(e):null}static getVRAMByteLength(e,t){if(!this.impls[t])return null;if(this.impls[t].getVRAMByteLength)return this.impls[t].getVRAMByteLength(e);let n=0;const r=4,s=this.getSize(e,t);if(!s)return null;for(;s[0]>1||s[1]>1;)n+=s[0]*s[1]*r,s[0]=Math.max(Math.floor(s[0]/2),1),s[1]=Math.max(Math.floor(s[1]/2),1);return n+=1*r,n}static mimeTypeToExtension(e){return e==="image/jpeg"?"jpg":e.split("/").pop()}static extensionToMimeType(e){return e==="jpg"?"image/jpeg":e?`image/${e}`:""}},ln.impls={"image/jpeg":new rl,"image/png":new Oi},Zn=class{static basename(e){const t=e.split(/[\\/]/).pop();return t.substring(0,t.lastIndexOf("."))}static extension(e){if(e.startsWith("data:image/")){const t=e.match(/data:(image\/\w+)/)[1];return ln.mimeTypeToExtension(t)}else{if(e.startsWith("data:model/gltf+json"))return"gltf";if(e.startsWith("data:model/gltf-binary"))return"glb";if(e.startsWith("data:application/"))return"bin"}return e.split(/[\\/]/).pop().split(/[.]/).pop()}},Hs=typeof Float32Array<"u"?Float32Array:Array,(function(){var e=Wh();return function(t,n,r,s,i,o){var a,u;for(n||(n=3),r||(r=0),s?u=Math.min(s*n+r,t.length):u=t.length,a=r;a<u;a+=n)e[0]=t[a],e[1]=t[a+1],e[2]=t[a+2],i(e,e,o),t[a]=e[0],t[a+1]=e[1],t[a+2]=e[2];return t}})(),Di="https://null.example",yr=class{static dirname(e){const t=e.lastIndexOf("/");return t===-1?"./":e.substring(0,t+1)}static basename(e){return Zn.basename(new URL(e,Di).pathname)}static extension(e){return Zn.extension(new URL(e,Di).pathname)}static resolve(e,t){if(!this.isRelativePath(t))return t;const n=e.split("/"),r=t.split("/");n.pop();for(let s=0;s<r.length;s++)r[s]!=="."&&(r[s]===".."?n.pop():n.push(r[s]));return n.join("/")}static isAbsoluteURL(e){return this.PROTOCOL_REGEXP.test(e)}static isRelativePath(e){return!/^(?:[a-zA-Z]+:)?\//.test(e)}},yr.DEFAULT_INIT={},yr.PROTOCOL_REGEXP=/^[a-zA-Z]+:\/\//,(function(e){e[e.SILENT=4]="SILENT",e[e.ERROR=3]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=1]="INFO",e[e.DEBUG=0]="DEBUG"})(Fi||(Fi={})),Wn=class Kr{constructor(t){this.verbosity=void 0,this.verbosity=t}debug(t){this.verbosity<=Kr.Verbosity.DEBUG&&console.debug(t)}info(t){this.verbosity<=Kr.Verbosity.INFO&&console.info(t)}warn(t){this.verbosity<=Kr.Verbosity.WARN&&console.warn(t)}error(t){this.verbosity<=Kr.Verbosity.ERROR&&console.error(t)}},Pi=Wn,Wn.Verbosity=Fi,Wn.DEFAULT_INSTANCE=new Pi(Pi.Verbosity.INFO),st=class Yr{static identity(t){return t}static eq(t,n,r=1e-5){if(t.length!==n.length)return!1;for(let s=0;s<t.length;s++)if(Math.abs(t[s]-n[s])>r)return!1;return!0}static clamp(t,n,r){return t<n?n:t>r?r:t}static decodeNormalizedInt(t,n){switch(n){case 5126:return t;case 5123:return t/65535;case 5121:return t/255;case 5122:return Math.max(t/32767,-1);case 5120:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}static encodeNormalizedInt(t,n){switch(n){case 5126:return t;case 5123:return Math.round(Yr.clamp(t,0,1)*65535);case 5121:return Math.round(Yr.clamp(t,0,1)*255);case 5122:return Math.round(Yr.clamp(t,-1,1)*32767);case 5120:return Math.round(Yr.clamp(t,-1,1)*127);default:throw new Error("Invalid component type.")}}static decompose(t,n,r,s){let i=Ci([t[0],t[1],t[2]]);const o=Ci([t[4],t[5],t[6]]),a=Ci([t[8],t[9],t[10]]);Yh(t)<0&&(i=-i),n[0]=t[12],n[1]=t[13],n[2]=t[14];const f=t.slice(),m=1/i,y=1/o,g=1/a;f[0]*=m,f[1]*=m,f[2]*=m,f[4]*=y,f[5]*=y,f[6]*=y,f[8]*=g,f[9]*=g,f[10]*=g,Qh(r,f),s[0]=i,s[1]=o,s[2]=a}static compose(t,n,r,s){const i=s,o=n[0],a=n[1],u=n[2],f=n[3],m=o+o,y=a+a,g=u+u,p=o*m,M=o*y,R=o*g,h=a*y,V=a*g,I=u*g,C=f*m,S=f*y,G=f*g,v=r[0],w=r[1],N=r[2];return i[0]=(1-(h+I))*v,i[1]=(M+G)*v,i[2]=(R-S)*v,i[3]=0,i[4]=(M-G)*w,i[5]=(1-(p+I))*w,i[6]=(V+C)*w,i[7]=0,i[8]=(R+S)*N,i[9]=(V-C)*N,i[10]=(1-(p+h))*N,i[11]=0,i[12]=t[0],i[13]=t[1],i[14]=t[2],i[15]=1,i}},Ui="23456789abdegjkmnpqrvwxyzABDEGJKMNPQRVWXYZ",sl=999,il=6,Li=new Set,ol=function(){let t="";for(let n=0;n<il;n++)t+=Ui.charAt(Math.floor(Math.random()*Ui.length));return t},al=function(){for(let t=0;t<sl;t++){const n=ol();if(!Li.has(n))return Li.add(n),n}return""},Pn=e=>e,ll=new Set,Ss=class extends Oc{constructor(e,t=""){super(e),this[He].name=t,this.init(),this.dispatchEvent({type:"create"})}getGraph(){return this.graph}getDefaults(){return Object.assign(super.getDefaults(),{name:"",extras:{}})}set(e,t){return Array.isArray(t)&&(t=t.slice()),super.set(e,t)}getName(){return this.get("name")}setName(e){return this.set("name",e)}getExtras(){return this.get("extras")}setExtras(e){return this.set("extras",e)}clone(){const e=this.constructor;return new e(this.graph).copy(this,Pn)}copy(e,t=Pn){for(const n in this[He]){const r=this[He][n];if(r instanceof nr)this[Xn].has(n)||r.dispose();else if(r instanceof kn||r instanceof Je)for(const s of r.values())s.dispose();else if(r instanceof Jt)for(const s of r.values())s.dispose()}for(const n in e[He]){const r=this[He][n],s=e[He][n];if(s instanceof nr)this[Xn].has(n)?r.getChild().copy(t(s.getChild()),t):this.setRef(n,t(s.getChild()),s.getAttributes());else if(s instanceof Je||s instanceof kn)for(const i of s.values())this.addRef(n,t(i.getChild()),i.getAttributes());else if(s instanceof Jt)for(const i of s.keys()){const o=s.get(i);this.setRefMap(n,i,t(o.getChild()),o.getAttributes())}else rr(s)?this[He][n]=JSON.parse(JSON.stringify(s)):Array.isArray(s)||s instanceof ArrayBuffer||ArrayBuffer.isView(s)?this[He][n]=s.slice():this[He][n]=s}return this}equals(e,t=ll){if(this===e)return!0;if(this.propertyType!==e.propertyType)return!1;for(const n in this[He]){if(t.has(n))continue;const r=this[He][n],s=e[He][n];if(r instanceof nr||s instanceof nr){if(!ed(r,s))return!1}else if(r instanceof Je||s instanceof Je||r instanceof kn||s instanceof kn){if(!td(r,s))return!1}else if(r instanceof Jt||s instanceof Jt){if(!nd(r,s))return!1}else if(rr(r)||rr(s)){if(!Uc(r,s))return!1}else if(zs(r)||zs(s)){if(!Fc(r,s))return!1}else if(r!==s)return!1}return!0}detach(){return this.graph.disconnectParents(this,e=>e.propertyType!=="Root"),this}listParents(){return this.graph.listParents(this)}},St=class extends Ss{getDefaults(){return Object.assign(super.getDefaults(),{extensions:new Jt})}getExtension(e){return this.getRefMap("extensions",e)}setExtension(e,t){return t&&t._validateParent(this),this.setRefMap("extensions",e,t)}listExtensions(){return this.listRefMapValues("extensions")}},ge=class Tt extends St{init(){this.propertyType=k.ACCESSOR}getDefaults(){return Object.assign(super.getDefaults(),{array:null,type:Tt.Type.SCALAR,componentType:Tt.ComponentType.FLOAT,normalized:!1,sparse:!1,buffer:null})}static getElementSize(t){switch(t){case Tt.Type.SCALAR:return 1;case Tt.Type.VEC2:return 2;case Tt.Type.VEC3:return 3;case Tt.Type.VEC4:return 4;case Tt.Type.MAT2:return 4;case Tt.Type.MAT3:return 9;case Tt.Type.MAT4:return 16;default:throw new Error("Unexpected type: "+t)}}static getComponentSize(t){switch(t){case Tt.ComponentType.BYTE:return 1;case Tt.ComponentType.UNSIGNED_BYTE:return 1;case Tt.ComponentType.SHORT:return 2;case Tt.ComponentType.UNSIGNED_SHORT:return 2;case Tt.ComponentType.UNSIGNED_INT:return 4;case Tt.ComponentType.FLOAT:return 4;default:throw new Error("Unexpected component type: "+t)}}getMinNormalized(t){const n=this.getNormalized(),r=this.getElementSize(),s=this.getComponentType();if(this.getMin(t),n)for(let i=0;i<r;i++)t[i]=st.decodeNormalizedInt(t[i],s);return t}getMin(t){const n=this.getArray(),r=this.getCount(),s=this.getElementSize();for(let i=0;i<s;i++)t[i]=1/0;for(let i=0;i<r*s;i+=s)for(let o=0;o<s;o++){const a=n[i+o];Number.isFinite(a)&&(t[o]=Math.min(t[o],a))}return t}getMaxNormalized(t){const n=this.getNormalized(),r=this.getElementSize(),s=this.getComponentType();if(this.getMax(t),n)for(let i=0;i<r;i++)t[i]=st.decodeNormalizedInt(t[i],s);return t}getMax(t){const n=this.get("array"),r=this.getCount(),s=this.getElementSize();for(let i=0;i<s;i++)t[i]=-1/0;for(let i=0;i<r*s;i+=s)for(let o=0;o<s;o++){const a=n[i+o];Number.isFinite(a)&&(t[o]=Math.max(t[o],a))}return t}getCount(){const t=this.get("array");return t?t.length/this.getElementSize():0}getType(){return this.get("type")}setType(t){return this.set("type",t)}getElementSize(){return Tt.getElementSize(this.get("type"))}getComponentSize(){return this.get("array").BYTES_PER_ELEMENT}getComponentType(){return this.get("componentType")}getNormalized(){return this.get("normalized")}setNormalized(t){return this.set("normalized",t)}getScalar(t){const n=this.getElementSize(),r=this.getComponentType(),s=this.getArray();return this.getNormalized()?st.decodeNormalizedInt(s[t*n],r):s[t*n]}setScalar(t,n){const r=this.getElementSize(),s=this.getComponentType(),i=this.getArray();return this.getNormalized()?i[t*r]=st.encodeNormalizedInt(n,s):i[t*r]=n,this}getElement(t,n){const r=this.getNormalized(),s=this.getElementSize(),i=this.getComponentType(),o=this.getArray();for(let a=0;a<s;a++)r?n[a]=st.decodeNormalizedInt(o[t*s+a],i):n[a]=o[t*s+a];return n}setElement(t,n){const r=this.getNormalized(),s=this.getElementSize(),i=this.getComponentType(),o=this.getArray();for(let a=0;a<s;a++)r?o[t*s+a]=st.encodeNormalizedInt(n[a],i):o[t*s+a]=n[a];return this}getSparse(){return this.get("sparse")}setSparse(t){return this.set("sparse",t)}getBuffer(){return this.getRef("buffer")}setBuffer(t){return this.setRef("buffer",t)}getArray(){return this.get("array")}setArray(t){return this.set("componentType",t?rd(t):Tt.ComponentType.FLOAT),this.set("array",t),this}getByteLength(){const t=this.get("array");return t?t.byteLength:0}},ge.Type={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4"},ge.ComponentType={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126},ki=class extends St{init(){this.propertyType=k.ANIMATION}getDefaults(){return Object.assign(super.getDefaults(),{channels:new Je,samplers:new Je})}addChannel(e){return this.addRef("channels",e)}removeChannel(e){return this.removeRef("channels",e)}listChannels(){return this.listRefs("channels")}addSampler(e){return this.addRef("samplers",e)}removeSampler(e){return this.removeRef("samplers",e)}listSamplers(){return this.listRefs("samplers")}},Qr=class extends St{init(){this.propertyType=k.ANIMATION_CHANNEL}getDefaults(){return Object.assign(super.getDefaults(),{targetPath:null,targetNode:null,sampler:null})}getTargetPath(){return this.get("targetPath")}setTargetPath(e){return this.set("targetPath",e)}getTargetNode(){return this.getRef("targetNode")}setTargetNode(e){return this.setRef("targetNode",e)}getSampler(){return this.getRef("sampler")}setSampler(e){return this.setRef("sampler",e)}},Qr.TargetPath={TRANSLATION:"translation",ROTATION:"rotation",SCALE:"scale",WEIGHTS:"weights"},qr=class jc extends St{init(){this.propertyType=k.ANIMATION_SAMPLER}getDefaultAttributes(){return Object.assign(super.getDefaults(),{interpolation:jc.Interpolation.LINEAR,input:null,output:null})}getInterpolation(){return this.get("interpolation")}setInterpolation(t){return this.set("interpolation",t)}getInput(){return this.getRef("input")}setInput(t){return this.setRef("input",t,{usage:$t.OTHER})}getOutput(){return this.getRef("output")}setOutput(t){return this.setRef("output",t,{usage:$t.OTHER})}},qr.Interpolation={LINEAR:"LINEAR",STEP:"STEP",CUBICSPLINE:"CUBICSPLINE"},ji=class extends St{init(){this.propertyType=k.BUFFER}getDefaults(){return Object.assign(super.getDefaults(),{uri:""})}getURI(){return this.get("uri")}setURI(e){return this.set("uri",e)}},vr=class Bc extends St{init(){this.propertyType=k.CAMERA}getDefaults(){return Object.assign(super.getDefaults(),{type:Bc.Type.PERSPECTIVE,znear:.1,zfar:100,aspectRatio:null,yfov:Math.PI*2*50/360,xmag:1,ymag:1})}getType(){return this.get("type")}setType(t){return this.set("type",t)}getZNear(){return this.get("znear")}setZNear(t){return this.set("znear",t)}getZFar(){return this.get("zfar")}setZFar(t){return this.set("zfar",t)}getAspectRatio(){return this.get("aspectRatio")}setAspectRatio(t){return this.set("aspectRatio",t)}getYFov(){return this.get("yfov")}setYFov(t){return this.set("yfov",t)}getXMag(){return this.get("xmag")}setXMag(t){return this.set("xmag",t)}getYMag(){return this.get("ymag")}setYMag(t){return this.set("ymag",t)}},vr.Type={PERSPECTIVE:"perspective",ORTHOGRAPHIC:"orthographic"},et=class extends Ss{_validateParent(e){if(!this.parentTypes.includes(e.propertyType))throw new Error(`Parent "${e.propertyType}" invalid for child "${this.propertyType}".`)}},et.EXTENSION_NAME=void 0,tt=class na extends St{init(){this.propertyType=k.TEXTURE_INFO}getDefaults(){return Object.assign(super.getDefaults(),{texCoord:0,magFilter:null,minFilter:null,wrapS:na.WrapMode.REPEAT,wrapT:na.WrapMode.REPEAT})}getTexCoord(){return this.get("texCoord")}setTexCoord(t){return this.set("texCoord",t)}getMagFilter(){return this.get("magFilter")}setMagFilter(t){return this.set("magFilter",t)}getMinFilter(){return this.get("minFilter")}setMinFilter(t){return this.set("minFilter",t)}getWrapS(){return this.get("wrapS")}setWrapS(t){return this.set("wrapS",t)}getWrapT(){return this.get("wrapT")}setWrapT(t){return this.set("wrapT",t)}},tt.WrapMode={CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},tt.MagFilter={NEAREST:9728,LINEAR:9729},tt.MinFilter={NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987},{R:Dr,G:Pr,B:Fr,A:cl}=Kt,Qn=class $c extends St{init(){this.propertyType=k.MATERIAL}getDefaults(){return Object.assign(super.getDefaults(),{alphaMode:$c.AlphaMode.OPAQUE,alphaCutoff:.5,doubleSided:!1,baseColorFactor:[1,1,1,1],baseColorTexture:null,baseColorTextureInfo:new tt(this.graph,"baseColorTextureInfo"),emissiveFactor:[0,0,0],emissiveTexture:null,emissiveTextureInfo:new tt(this.graph,"emissiveTextureInfo"),normalScale:1,normalTexture:null,normalTextureInfo:new tt(this.graph,"normalTextureInfo"),occlusionStrength:1,occlusionTexture:null,occlusionTextureInfo:new tt(this.graph,"occlusionTextureInfo"),roughnessFactor:1,metallicFactor:1,metallicRoughnessTexture:null,metallicRoughnessTextureInfo:new tt(this.graph,"metallicRoughnessTextureInfo")})}getDoubleSided(){return this.get("doubleSided")}setDoubleSided(t){return this.set("doubleSided",t)}getAlpha(){return this.get("baseColorFactor")[3]}setAlpha(t){const n=this.get("baseColorFactor").slice();return n[3]=t,this.set("baseColorFactor",n)}getAlphaMode(){return this.get("alphaMode")}setAlphaMode(t){return this.set("alphaMode",t)}getAlphaCutoff(){return this.get("alphaCutoff")}setAlphaCutoff(t){return this.set("alphaCutoff",t)}getBaseColorFactor(){return this.get("baseColorFactor")}setBaseColorFactor(t){return this.set("baseColorFactor",t)}getBaseColorTexture(){return this.getRef("baseColorTexture")}getBaseColorTextureInfo(){return this.getRef("baseColorTexture")?this.getRef("baseColorTextureInfo"):null}setBaseColorTexture(t){return this.setRef("baseColorTexture",t,{channels:Dr|Pr|Fr|cl,isColor:!0})}getEmissiveFactor(){return this.get("emissiveFactor")}setEmissiveFactor(t){return this.set("emissiveFactor",t)}getEmissiveTexture(){return this.getRef("emissiveTexture")}getEmissiveTextureInfo(){return this.getRef("emissiveTexture")?this.getRef("emissiveTextureInfo"):null}setEmissiveTexture(t){return this.setRef("emissiveTexture",t,{channels:Dr|Pr|Fr,isColor:!0})}getNormalScale(){return this.get("normalScale")}setNormalScale(t){return this.set("normalScale",t)}getNormalTexture(){return this.getRef("normalTexture")}getNormalTextureInfo(){return this.getRef("normalTexture")?this.getRef("normalTextureInfo"):null}setNormalTexture(t){return this.setRef("normalTexture",t,{channels:Dr|Pr|Fr})}getOcclusionStrength(){return this.get("occlusionStrength")}setOcclusionStrength(t){return this.set("occlusionStrength",t)}getOcclusionTexture(){return this.getRef("occlusionTexture")}getOcclusionTextureInfo(){return this.getRef("occlusionTexture")?this.getRef("occlusionTextureInfo"):null}setOcclusionTexture(t){return this.setRef("occlusionTexture",t,{channels:Dr})}getRoughnessFactor(){return this.get("roughnessFactor")}setRoughnessFactor(t){return this.set("roughnessFactor",t)}getMetallicFactor(){return this.get("metallicFactor")}setMetallicFactor(t){return this.set("metallicFactor",t)}getMetallicRoughnessTexture(){return this.getRef("metallicRoughnessTexture")}getMetallicRoughnessTextureInfo(){return this.getRef("metallicRoughnessTexture")?this.getRef("metallicRoughnessTextureInfo"):null}setMetallicRoughnessTexture(t){return this.setRef("metallicRoughnessTexture",t,{channels:Pr|Fr})}},Qn.AlphaMode={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"},Bi=class extends St{init(){this.propertyType=k.MESH}getDefaults(){return Object.assign(super.getDefaults(),{weights:[],primitives:new Je})}addPrimitive(e){return this.addRef("primitives",e)}removePrimitive(e){return this.removeRef("primitives",e)}listPrimitives(){return this.listRefs("primitives")}getWeights(){return this.get("weights")}setWeights(e){return this.set("weights",e)}},$i=class extends St{init(){this.propertyType=k.NODE}getDefaults(){return Object.assign(super.getDefaults(),{translation:[0,0,0],rotation:[0,0,0,1],scale:[1,1,1],weights:[],camera:null,mesh:null,skin:null,children:new Je})}copy(e,t=Pn){if(t===Pn)throw new Error("Node cannot be copied.");return super.copy(e,t)}getTranslation(){return this.get("translation")}getRotation(){return this.get("rotation")}getScale(){return this.get("scale")}setTranslation(e){return this.set("translation",e)}setRotation(e){return this.set("rotation",e)}setScale(e){return this.set("scale",e)}getMatrix(){return st.compose(this.get("translation"),this.get("rotation"),this.get("scale"),[])}setMatrix(e){const t=this.get("translation").slice(),n=this.get("rotation").slice(),r=this.get("scale").slice();return st.decompose(e,t,n,r),this.set("translation",t).set("rotation",n).set("scale",r)}getWorldTranslation(){const e=[0,0,0];return st.decompose(this.getWorldMatrix(),e,[0,0,0,1],[1,1,1]),e}getWorldRotation(){const e=[0,0,0,1];return st.decompose(this.getWorldMatrix(),[0,0,0],e,[1,1,1]),e}getWorldScale(){const e=[1,1,1];return st.decompose(this.getWorldMatrix(),[0,0,0],[0,0,0,1],e),e}getWorldMatrix(){const e=[];for(let r=this;r!=null;r=r.getParentNode())e.push(r);let t;const n=e.pop().getMatrix();for(;t=e.pop();)Jh(n,n,t.getMatrix());return n}addChild(e){const t=e.getParentNode();t&&t.removeChild(e);for(const n of e.listParents())n.propertyType===k.SCENE&&n.removeChild(e);return this.addRef("children",e)}removeChild(e){return this.removeRef("children",e)}listChildren(){return this.listRefs("children")}getParentNode(){for(const e of this.listParents())if(e.propertyType===k.NODE)return e;return null}getMesh(){return this.getRef("mesh")}setMesh(e){return this.setRef("mesh",e)}getCamera(){return this.getRef("camera")}setCamera(e){return this.setRef("camera",e)}getSkin(){return this.getRef("skin")}setSkin(e){return this.setRef("skin",e)}getWeights(){return this.get("weights")}setWeights(e){return this.set("weights",e)}traverse(e){e(this);for(const t of this.listChildren())t.traverse(e);return this}},_n=class Vc extends St{init(){this.propertyType=k.PRIMITIVE}getDefaults(){return Object.assign(super.getDefaults(),{mode:Vc.Mode.TRIANGLES,material:null,indices:null,attributes:new Jt,targets:new Je})}getIndices(){return this.getRef("indices")}setIndices(t){return this.setRef("indices",t,{usage:$t.ELEMENT_ARRAY_BUFFER})}getAttribute(t){return this.getRefMap("attributes",t)}setAttribute(t,n){return this.setRefMap("attributes",t,n,{usage:$t.ARRAY_BUFFER})}listAttributes(){return this.listRefMapValues("attributes")}listSemantics(){return this.listRefMapKeys("attributes")}getMaterial(){return this.getRef("material")}setMaterial(t){return this.setRef("material",t)}getMode(){return this.get("mode")}setMode(t){return this.set("mode",t)}listTargets(){return this.listRefs("targets")}addTarget(t){return this.addRef("targets",t)}removeTarget(t){return this.removeRef("targets",t)}},_n.Mode={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},ul=class extends Ss{init(){this.propertyType=k.PRIMITIVE_TARGET}getDefaults(){return Object.assign(super.getDefaults(),{attributes:new Jt})}getAttribute(e){return this.getRefMap("attributes",e)}setAttribute(e,t){return this.setRefMap("attributes",e,t,{usage:$t.ARRAY_BUFFER})}listAttributes(){return this.listRefMapValues("attributes")}listSemantics(){return this.listRefMapKeys("attributes")}},Vi=class extends St{init(){this.propertyType=k.SCENE}getDefaults(){return Object.assign(super.getDefaults(),{children:new Je})}copy(e,t=Pn){if(t===Pn)throw new Error("Scene cannot be copied.");return super.copy(e,t)}addChild(e){const t=e.getParentNode();return t&&t.removeChild(e),this.addRef("children",e)}removeChild(e){return this.removeRef("children",e)}listChildren(){return this.listRefs("children")}traverse(e){for(const t of this.listChildren())t.traverse(e);return this}},Gi=class extends St{init(){this.propertyType=k.SKIN}getDefaults(){return Object.assign(super.getDefaults(),{skeleton:null,inverseBindMatrices:null,joints:new Je})}getSkeleton(){return this.getRef("skeleton")}setSkeleton(e){return this.setRef("skeleton",e)}getInverseBindMatrices(){return this.getRef("inverseBindMatrices")}setInverseBindMatrices(e){return this.setRef("inverseBindMatrices",e,{usage:$t.INVERSE_BIND_MATRICES})}addJoint(e){return this.addRef("joints",e)}removeJoint(e){return this.removeRef("joints",e)}listJoints(){return this.listRefs("joints")}},zi=class extends St{init(){this.propertyType=k.TEXTURE}getDefaults(){return Object.assign(super.getDefaults(),{image:null,mimeType:"",uri:""})}getMimeType(){return this.get("mimeType")||ln.extensionToMimeType(Zn.extension(this.get("uri")))}setMimeType(e){return this.set("mimeType",e)}getURI(){return this.get("uri")}setURI(e){this.set("uri",e);const t=ln.extensionToMimeType(Zn.extension(e));return t&&this.set("mimeType",t),this}getImage(){return this.get("image")}setImage(e){return this.set("image",Ne.assertView(e))}getSize(){const e=this.get("image");return e?ln.getSize(e,this.getMimeType()):null}},ta=class extends St{init(){this.propertyType=k.ROOT}getDefaults(){return Object.assign(super.getDefaults(),{asset:{generator:`glTF-Transform ${Ni}`,version:"2.0"},defaultScene:null,accessors:new Je,animations:new Je,buffers:new Je,cameras:new Je,materials:new Je,meshes:new Je,nodes:new Je,scenes:new Je,skins:new Je,textures:new Je})}constructor(e){super(e),this._extensions=new Set,e.addEventListener("node:create",t=>{this._addChildOfRoot(t.target)})}clone(){throw new Error("Root cannot be cloned.")}copy(e,t=Pn){if(t===Pn)throw new Error("Root cannot be copied.");this.set("asset",Dt({},e.get("asset"))),this.setName(e.getName()),this.setExtras(Dt({},e.getExtras())),this.setDefaultScene(e.getDefaultScene()?t(e.getDefaultScene()):null);for(const n of e.listRefMapKeys("extensions")){const r=e.getExtension(n);this.setExtension(n,t(r))}return this}_addChildOfRoot(e){return e instanceof Vi?this.addRef("scenes",e):e instanceof $i?this.addRef("nodes",e):e instanceof vr?this.addRef("cameras",e):e instanceof Gi?this.addRef("skins",e):e instanceof Bi?this.addRef("meshes",e):e instanceof Qn?this.addRef("materials",e):e instanceof zi?this.addRef("textures",e):e instanceof ki?this.addRef("animations",e):e instanceof ge?this.addRef("accessors",e):e instanceof ji&&this.addRef("buffers",e),this}getAsset(){return this.get("asset")}listExtensionsUsed(){return Array.from(this._extensions)}listExtensionsRequired(){return this.listExtensionsUsed().filter(e=>e.isRequired())}_enableExtension(e){return this._extensions.add(e),this}_disableExtension(e){return this._extensions.delete(e),this}listScenes(){return this.listRefs("scenes")}setDefaultScene(e){return this.setRef("defaultScene",e)}getDefaultScene(){return this.getRef("defaultScene")}listNodes(){return this.listRefs("nodes")}listCameras(){return this.listRefs("cameras")}listSkins(){return this.listRefs("skins")}listMeshes(){return this.listRefs("meshes")}listMaterials(){return this.listRefs("materials")}listTextures(){return this.listRefs("textures")}listAnimations(){return this.listRefs("animations")}listAccessors(){return this.listRefs("accessors")}listBuffers(){return this.listRefs("buffers")}},Ls=class ra{static fromGraph(t){return ra._GRAPH_DOCUMENTS.get(t)||null}constructor(){this._graph=new Nc,this._root=new ta(this._graph),this._logger=Wn.DEFAULT_INSTANCE,ra._GRAPH_DOCUMENTS.set(this._graph,this)}getRoot(){return this._root}getGraph(){return this._graph}getLogger(){return this._logger}setLogger(t){return this._logger=t,this}clone(){throw new Error("Use 'cloneDocument(source)' from '@gltf-transform/functions'.")}merge(t){throw new Error("Use 'mergeDocuments(target, source)' from '@gltf-transform/functions'.")}async transform(...t){const n=t.map(r=>r.name);for(const r of t)await r(this,{stack:n});return this}createExtension(t){const n=t.EXTENSION_NAME;return this.getRoot().listExtensionsUsed().find(s=>s.extensionName===n)||new t(this)}disposeExtension(t){const n=this.getRoot().listExtensionsUsed().find(r=>r.extensionName===t);n&&n.dispose()}createScene(t=""){return new Vi(this._graph,t)}createNode(t=""){return new $i(this._graph,t)}createCamera(t=""){return new vr(this._graph,t)}createSkin(t=""){return new Gi(this._graph,t)}createMesh(t=""){return new Bi(this._graph,t)}createPrimitive(){return new _n(this._graph)}createPrimitiveTarget(t=""){return new ul(this._graph,t)}createMaterial(t=""){return new Qn(this._graph,t)}createTexture(t=""){return new zi(this._graph,t)}createAnimation(t=""){return new ki(this._graph,t)}createAnimationChannel(t=""){return new Qr(this._graph,t)}createAnimationSampler(t=""){return new qr(this._graph,t)}createAccessor(t="",n=null){return n||(n=this.getRoot().listBuffers()[0]),new ge(this._graph,t).setBuffer(n)}createBuffer(t=""){return new ji(this._graph,t)}},Ls._GRAPH_DOCUMENTS=new WeakMap,Ke=class{constructor(e){this.extensionName="",this.prereadTypes=[],this.prewriteTypes=[],this.readDependencies=[],this.writeDependencies=[],this.document=void 0,this.required=!1,this.properties=new Set,this._listener=void 0,this.document=e,e.getRoot()._enableExtension(this),this._listener=n=>{const r=n,s=r.target;s instanceof et&&s.extensionName===this.extensionName&&(r.type==="node:create"&&this._addExtensionProperty(s),r.type==="node:dispose"&&this._removeExtensionProperty(s))};const t=e.getGraph();t.addEventListener("node:create",this._listener),t.addEventListener("node:dispose",this._listener)}dispose(){this.document.getRoot()._disableExtension(this);const e=this.document.getGraph();e.removeEventListener("node:create",this._listener),e.removeEventListener("node:dispose",this._listener);for(const t of this.properties)t.dispose()}static register(){}isRequired(){return this.required}setRequired(e){return this.required=e,this}listProperties(){return Array.from(this.properties)}_addExtensionProperty(e){return this.properties.add(e),this}_removeExtensionProperty(e){return this.properties.delete(e),this}install(e,t){return this}preread(e,t){return this}prewrite(e,t){return this}},Ke.EXTENSION_NAME=void 0,fl=class{constructor(e){this.jsonDoc=void 0,this.buffers=[],this.bufferViews=[],this.bufferViewBuffers=[],this.accessors=[],this.textures=[],this.textureInfos=new Map,this.materials=[],this.meshes=[],this.cameras=[],this.nodes=[],this.skins=[],this.animations=[],this.scenes=[],this.jsonDoc=e}setTextureInfo(e,t){this.textureInfos.set(e,t),t.texCoord!==void 0&&e.setTexCoord(t.texCoord),t.extras!==void 0&&e.setExtras(t.extras);const n=this.jsonDoc.json.textures[t.index];if(n.sampler===void 0)return;const r=this.jsonDoc.json.samplers[n.sampler];r.magFilter!==void 0&&e.setMagFilter(r.magFilter),r.minFilter!==void 0&&e.setMinFilter(r.minFilter),r.wrapS!==void 0&&e.setWrapS(r.wrapS),r.wrapT!==void 0&&e.setWrapT(r.wrapT)}},Hi={logger:Wn.DEFAULT_INSTANCE,extensions:[],dependencies:{}},hl=new Set([k.BUFFER,k.TEXTURE,k.MATERIAL,k.MESH,k.PRIMITIVE,k.NODE,k.SCENE]),dl=class{static read(e,t=Hi){const n=Dt({},Hi,t),{json:r}=e,s=new Ls().setLogger(n.logger);this.validate(e,n);const i=new fl(e),o=r.asset,a=s.getRoot().getAsset();o.copyright&&(a.copyright=o.copyright),o.extras&&(a.extras=o.extras),r.extras!==void 0&&s.getRoot().setExtras(Dt({},r.extras));const u=r.extensionsUsed||[],f=r.extensionsRequired||[];n.extensions.sort((v,w)=>v.EXTENSION_NAME>w.EXTENSION_NAME?1:-1);for(const v of n.extensions)if(u.includes(v.EXTENSION_NAME)){const w=s.createExtension(v).setRequired(f.includes(v.EXTENSION_NAME)),N=w.prereadTypes.filter(P=>!hl.has(P));N.length&&n.logger.warn(`Preread hooks for some types (${N.join()}), requested by extension ${w.extensionName}, are unsupported. Please file an issue or a PR.`);for(const P of w.readDependencies)w.install(P,n.dependencies[P])}const m=r.buffers||[];s.getRoot().listExtensionsUsed().filter(v=>v.prereadTypes.includes(k.BUFFER)).forEach(v=>v.preread(i,k.BUFFER)),i.buffers=m.map(v=>{const w=s.createBuffer(v.name);return v.extras&&w.setExtras(v.extras),v.uri&&v.uri.indexOf("__")!==0&&w.setURI(v.uri),w});const y=r.bufferViews||[];i.bufferViewBuffers=y.map((v,w)=>{if(!i.bufferViews[w]){const N=e.json.buffers[v.buffer],P=N.uri?e.resources[N.uri]:e.resources[er],U=v.byteOffset||0;i.bufferViews[w]=Ne.toView(P,U,v.byteLength)}return i.buffers[v.buffer]});const g=r.accessors||[];i.accessors=g.map(v=>{const w=i.bufferViewBuffers[v.bufferView],N=s.createAccessor(v.name,w).setType(v.type);return v.extras&&N.setExtras(v.extras),v.normalized!==void 0&&N.setNormalized(v.normalized),v.bufferView===void 0||N.setArray(Us(v,i)),N});const p=r.images||[],M=r.textures||[];s.getRoot().listExtensionsUsed().filter(v=>v.prereadTypes.includes(k.TEXTURE)).forEach(v=>v.preread(i,k.TEXTURE)),i.textures=p.map(v=>{const w=s.createTexture(v.name);if(v.extras&&w.setExtras(v.extras),v.bufferView!==void 0){const N=r.bufferViews[v.bufferView],P=e.json.buffers[N.buffer],U=P.uri?e.resources[P.uri]:e.resources[er],B=N.byteOffset||0,Z=N.byteLength,Se=U.slice(B,B+Z);w.setImage(Se)}else v.uri!==void 0&&(w.setImage(e.resources[v.uri]),v.uri.indexOf("__")!==0&&w.setURI(v.uri));if(v.mimeType!==void 0)w.setMimeType(v.mimeType);else if(v.uri){const N=Zn.extension(v.uri);w.setMimeType(ln.extensionToMimeType(N))}return w}),s.getRoot().listExtensionsUsed().filter(v=>v.prereadTypes.includes(k.MATERIAL)).forEach(v=>v.preread(i,k.MATERIAL));const R=r.materials||[];i.materials=R.map(v=>{const w=s.createMaterial(v.name);v.extras&&w.setExtras(v.extras),v.alphaMode!==void 0&&w.setAlphaMode(v.alphaMode),v.alphaCutoff!==void 0&&w.setAlphaCutoff(v.alphaCutoff),v.doubleSided!==void 0&&w.setDoubleSided(v.doubleSided);const N=v.pbrMetallicRoughness||{};if(N.baseColorFactor!==void 0&&w.setBaseColorFactor(N.baseColorFactor),v.emissiveFactor!==void 0&&w.setEmissiveFactor(v.emissiveFactor),N.metallicFactor!==void 0&&w.setMetallicFactor(N.metallicFactor),N.roughnessFactor!==void 0&&w.setRoughnessFactor(N.roughnessFactor),N.baseColorTexture!==void 0){const P=N.baseColorTexture,U=i.textures[M[P.index].source];w.setBaseColorTexture(U),i.setTextureInfo(w.getBaseColorTextureInfo(),P)}if(v.emissiveTexture!==void 0){const P=v.emissiveTexture,U=i.textures[M[P.index].source];w.setEmissiveTexture(U),i.setTextureInfo(w.getEmissiveTextureInfo(),P)}if(v.normalTexture!==void 0){const P=v.normalTexture,U=i.textures[M[P.index].source];w.setNormalTexture(U),i.setTextureInfo(w.getNormalTextureInfo(),P),v.normalTexture.scale!==void 0&&w.setNormalScale(v.normalTexture.scale)}if(v.occlusionTexture!==void 0){const P=v.occlusionTexture,U=i.textures[M[P.index].source];w.setOcclusionTexture(U),i.setTextureInfo(w.getOcclusionTextureInfo(),P),v.occlusionTexture.strength!==void 0&&w.setOcclusionStrength(v.occlusionTexture.strength)}if(N.metallicRoughnessTexture!==void 0){const P=N.metallicRoughnessTexture,U=i.textures[M[P.index].source];w.setMetallicRoughnessTexture(U),i.setTextureInfo(w.getMetallicRoughnessTextureInfo(),P)}return w}),s.getRoot().listExtensionsUsed().filter(v=>v.prereadTypes.includes(k.MESH)).forEach(v=>v.preread(i,k.MESH));const h=r.meshes||[];s.getRoot().listExtensionsUsed().filter(v=>v.prereadTypes.includes(k.PRIMITIVE)).forEach(v=>v.preread(i,k.PRIMITIVE)),i.meshes=h.map(v=>{const w=s.createMesh(v.name);return v.extras&&w.setExtras(v.extras),v.weights!==void 0&&w.setWeights(v.weights),(v.primitives||[]).forEach(P=>{const U=s.createPrimitive();P.extras&&U.setExtras(P.extras),P.material!==void 0&&U.setMaterial(i.materials[P.material]),P.mode!==void 0&&U.setMode(P.mode);for(const[Se,de]of Object.entries(P.attributes||{}))U.setAttribute(Se,i.accessors[de]);P.indices!==void 0&&U.setIndices(i.accessors[P.indices]);const B=v.extras&&v.extras.targetNames||[];(P.targets||[]).forEach((Se,de)=>{const we=B[de]||de.toString(),Re=s.createPrimitiveTarget(we);for(const[Ie,Ve]of Object.entries(Se))Re.setAttribute(Ie,i.accessors[Ve]);U.addTarget(Re)}),w.addPrimitive(U)}),w});const V=r.cameras||[];i.cameras=V.map(v=>{const w=s.createCamera(v.name).setType(v.type);if(v.extras&&w.setExtras(v.extras),v.type===vr.Type.PERSPECTIVE){const N=v.perspective;w.setYFov(N.yfov),w.setZNear(N.znear),N.zfar!==void 0&&w.setZFar(N.zfar),N.aspectRatio!==void 0&&w.setAspectRatio(N.aspectRatio)}else{const N=v.orthographic;w.setZNear(N.znear).setZFar(N.zfar).setXMag(N.xmag).setYMag(N.ymag)}return w});const I=r.nodes||[];s.getRoot().listExtensionsUsed().filter(v=>v.prereadTypes.includes(k.NODE)).forEach(v=>v.preread(i,k.NODE)),i.nodes=I.map(v=>{const w=s.createNode(v.name);if(v.extras&&w.setExtras(v.extras),v.translation!==void 0&&w.setTranslation(v.translation),v.rotation!==void 0&&w.setRotation(v.rotation),v.scale!==void 0&&w.setScale(v.scale),v.matrix!==void 0){const N=[0,0,0],P=[0,0,0,1],U=[1,1,1];st.decompose(v.matrix,N,P,U),w.setTranslation(N),w.setRotation(P),w.setScale(U)}return v.weights!==void 0&&w.setWeights(v.weights),w});const C=r.skins||[];i.skins=C.map(v=>{const w=s.createSkin(v.name);v.extras&&w.setExtras(v.extras),v.inverseBindMatrices!==void 0&&w.setInverseBindMatrices(i.accessors[v.inverseBindMatrices]),v.skeleton!==void 0&&w.setSkeleton(i.nodes[v.skeleton]);for(const N of v.joints)w.addJoint(i.nodes[N]);return w}),I.map((v,w)=>{const N=i.nodes[w];(v.children||[]).forEach(U=>N.addChild(i.nodes[U])),v.mesh!==void 0&&N.setMesh(i.meshes[v.mesh]),v.camera!==void 0&&N.setCamera(i.cameras[v.camera]),v.skin!==void 0&&N.setSkin(i.skins[v.skin])});const S=r.animations||[];i.animations=S.map(v=>{const w=s.createAnimation(v.name);v.extras&&w.setExtras(v.extras);const P=(v.samplers||[]).map(B=>{const Z=s.createAnimationSampler().setInput(i.accessors[B.input]).setOutput(i.accessors[B.output]).setInterpolation(B.interpolation||qr.Interpolation.LINEAR);return B.extras&&Z.setExtras(B.extras),w.addSampler(Z),Z});return(v.channels||[]).forEach(B=>{const Z=s.createAnimationChannel().setSampler(P[B.sampler]).setTargetPath(B.target.path);B.target.node!==void 0&&Z.setTargetNode(i.nodes[B.target.node]),B.extras&&Z.setExtras(B.extras),w.addChannel(Z)}),w});const G=r.scenes||[];return s.getRoot().listExtensionsUsed().filter(v=>v.prereadTypes.includes(k.SCENE)).forEach(v=>v.preread(i,k.SCENE)),i.scenes=G.map(v=>{const w=s.createScene(v.name);return v.extras&&w.setExtras(v.extras),(v.nodes||[]).map(P=>i.nodes[P]).forEach(P=>w.addChild(P)),w}),r.scene!==void 0&&s.getRoot().setDefaultScene(i.scenes[r.scene]),s.getRoot().listExtensionsUsed().forEach(v=>v.read(i)),g.forEach((v,w)=>{const N=i.accessors[w],P=!!v.sparse,U=!v.bufferView&&!N.getArray();(P||U)&&N.setSparse(!0).setArray(id(v,i))}),s}static validate(e,t){const n=e.json;if(n.asset.version!=="2.0")throw new Error(`Unsupported glTF version, "${n.asset.version}".`);if(n.extensionsRequired){for(const r of n.extensionsRequired)if(!t.extensions.find(s=>s.EXTENSION_NAME===r))throw new Error(`Missing required extension, "${r}".`)}if(n.extensionsUsed)for(const r of n.extensionsUsed)t.extensions.find(s=>s.EXTENSION_NAME===r)||t.logger.warn(`Missing optional extension, "${r}".`)}},(function(e){e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER"})(Ur||(Ur={})),Yt=class{constructor(e,t,n){this._doc=void 0,this.jsonDoc=void 0,this.options=void 0,this.accessorIndexMap=new Map,this.animationIndexMap=new Map,this.bufferIndexMap=new Map,this.cameraIndexMap=new Map,this.skinIndexMap=new Map,this.materialIndexMap=new Map,this.meshIndexMap=new Map,this.nodeIndexMap=new Map,this.imageIndexMap=new Map,this.textureDefIndexMap=new Map,this.textureInfoDefMap=new Map,this.samplerDefIndexMap=new Map,this.sceneIndexMap=new Map,this.imageBufferViews=[],this.otherBufferViews=new Map,this.otherBufferViewsIndexMap=new Map,this.extensionData={},this.bufferURIGenerator=void 0,this.imageURIGenerator=void 0,this.logger=void 0,this._accessorUsageMap=new Map,this.accessorUsageGroupedByParent=new Set(["ARRAY_BUFFER"]),this.accessorParents=new Map,this._doc=e,this.jsonDoc=t,this.options=n;const r=e.getRoot(),s=r.listBuffers().length,i=r.listTextures().length;this.bufferURIGenerator=new Wi(s>1,()=>n.basename||"buffer"),this.imageURIGenerator=new Wi(i>1,o=>od(e,o)||n.basename||"texture"),this.logger=e.getLogger()}createTextureInfoDef(e,t){const n={magFilter:t.getMagFilter()||void 0,minFilter:t.getMinFilter()||void 0,wrapS:t.getWrapS(),wrapT:t.getWrapT()},r=JSON.stringify(n);this.samplerDefIndexMap.has(r)||(this.samplerDefIndexMap.set(r,this.jsonDoc.json.samplers.length),this.jsonDoc.json.samplers.push(n));const s={source:this.imageIndexMap.get(e),sampler:this.samplerDefIndexMap.get(r)},i=JSON.stringify(s);this.textureDefIndexMap.has(i)||(this.textureDefIndexMap.set(i,this.jsonDoc.json.textures.length),this.jsonDoc.json.textures.push(s));const o={index:this.textureDefIndexMap.get(i)};return t.getTexCoord()!==0&&(o.texCoord=t.getTexCoord()),Object.keys(t.getExtras()).length>0&&(o.extras=t.getExtras()),this.textureInfoDefMap.set(t,o),o}createPropertyDef(e){const t={};return e.getName()&&(t.name=e.getName()),Object.keys(e.getExtras()).length>0&&(t.extras=e.getExtras()),t}createAccessorDef(e){const t=this.createPropertyDef(e);return t.type=e.getType(),t.componentType=e.getComponentType(),t.count=e.getCount(),this._doc.getGraph().listParentEdges(e).some(r=>r.getName()==="attributes"&&r.getAttributes().key==="POSITION"||r.getName()==="input")&&(t.max=e.getMax([]).map(Math.fround),t.min=e.getMin([]).map(Math.fround)),e.getNormalized()&&(t.normalized=e.getNormalized()),t}createImageData(e,t,n){if(this.options.format===Hn.GLB)this.imageBufferViews.push(t),e.bufferView=this.jsonDoc.json.bufferViews.length,this.jsonDoc.json.bufferViews.push({buffer:0,byteOffset:-1,byteLength:t.byteLength});else{const r=ln.mimeTypeToExtension(n.getMimeType());e.uri=this.imageURIGenerator.createURI(n,r),this.assignResourceURI(e.uri,t,!1)}}assignResourceURI(e,t,n){const r=this.jsonDoc.resources;if(!(e in r)){r[e]=t;return}if(t===r[e]){this.logger.warn(`Duplicate resource URI, "${e}".`);return}const s=`Resource URI "${e}" already assigned to different data.`;if(!n){this.logger.warn(s);return}throw new Error(s)}getAccessorUsage(e){const t=this._accessorUsageMap.get(e);if(t)return t;if(e.getSparse())return $t.SPARSE;for(const n of this._doc.getGraph().listParentEdges(e)){const{usage:r}=n.getAttributes();if(r)return r;n.getParent().propertyType!==k.ROOT&&this.logger.warn(`Missing attribute ".usage" on edge, "${n.getName()}".`)}return $t.OTHER}addAccessorToUsageGroup(e,t){const n=this._accessorUsageMap.get(e);if(n&&n!==t)throw new Error(`Accessor with usage "${n}" cannot be reused as "${t}".`);return this._accessorUsageMap.set(e,t),this}},Yt.BufferViewTarget=Ur,Yt.BufferViewUsage=$t,Yt.USAGE_TO_TARGET={[$t.ARRAY_BUFFER]:Ur.ARRAY_BUFFER,[$t.ELEMENT_ARRAY_BUFFER]:Ur.ELEMENT_ARRAY_BUFFER},Wi=class{constructor(e,t){this.multiple=void 0,this.basename=void 0,this.counter={},this.multiple=e,this.basename=t}createURI(e,t){if(e.getURI())return e.getURI();if(this.multiple){const n=this.basename(e);return this.counter[n]=this.counter[n]||1,`${n}_${this.counter[n]++}.${t}`}else return`${this.basename(e)}.${t}`}},{BufferViewUsage:Lr}=Yt,{UNSIGNED_INT:pl,UNSIGNED_SHORT:gl,UNSIGNED_BYTE:ml}=ge.ComponentType,yl=new Set([k.ACCESSOR,k.BUFFER,k.MATERIAL,k.MESH]),vl=class{static write(e,t){const n=e.getGraph(),r=e.getRoot(),s={asset:Dt({generator:`glTF-Transform ${Ni}`},r.getAsset()),extras:Dt({},r.getExtras())},i={json:s,resources:{}},o=new Yt(e,i,t),a=t.logger||Wn.DEFAULT_INSTANCE,u=new Set(t.extensions.map(h=>h.EXTENSION_NAME)),f=e.getRoot().listExtensionsUsed().filter(h=>u.has(h.extensionName)).sort((h,V)=>h.extensionName>V.extensionName?1:-1),m=e.getRoot().listExtensionsRequired().filter(h=>u.has(h.extensionName)).sort((h,V)=>h.extensionName>V.extensionName?1:-1);f.length<e.getRoot().listExtensionsUsed().length&&a.warn("Some extensions were not registered for I/O, and will not be written.");for(const h of f){const V=h.prewriteTypes.filter(I=>!yl.has(I));V.length&&a.warn(`Prewrite hooks for some types (${V.join()}), requested by extension ${h.extensionName}, are unsupported. Please file an issue or a PR.`);for(const I of h.writeDependencies)h.install(I,t.dependencies[I])}function y(h,V,I,C){const S=[];let G=0;for(const N of h){const P=o.createAccessorDef(N);P.bufferView=s.bufferViews.length;const U=N.getArray(),B=Ne.pad(Ne.toView(U));P.byteOffset=G,G+=B.byteLength,S.push(B),o.accessorIndexMap.set(N,s.accessors.length),s.accessors.push(P)}const v=Ne.concat(S),w={buffer:V,byteOffset:I,byteLength:v.byteLength};return C&&(w.target=C),s.bufferViews.push(w),{buffers:S,byteLength:G}}function g(h,V,I){const C=h[0].getCount();let S=0;for(const P of h){const U=o.createAccessorDef(P);U.bufferView=s.bufferViews.length,U.byteOffset=S;const B=P.getElementSize(),Z=P.getComponentSize();S+=Ne.padNumber(B*Z),o.accessorIndexMap.set(P,s.accessors.length),s.accessors.push(U)}const G=C*S,v=new ArrayBuffer(G),w=new DataView(v);for(let P=0;P<C;P++){let U=0;for(const B of h){const Z=B.getElementSize(),Se=B.getComponentSize(),de=B.getComponentType(),we=B.getArray();for(let Re=0;Re<Z;Re++){const Ie=P*S+U+Re*Se,Ve=we[P*Z+Re];switch(de){case ge.ComponentType.FLOAT:w.setFloat32(Ie,Ve,!0);break;case ge.ComponentType.BYTE:w.setInt8(Ie,Ve);break;case ge.ComponentType.SHORT:w.setInt16(Ie,Ve,!0);break;case ge.ComponentType.UNSIGNED_BYTE:w.setUint8(Ie,Ve);break;case ge.ComponentType.UNSIGNED_SHORT:w.setUint16(Ie,Ve,!0);break;case ge.ComponentType.UNSIGNED_INT:w.setUint32(Ie,Ve,!0);break;default:throw new Error("Unexpected component type: "+de)}}U+=Ne.padNumber(Z*Se)}}const N={buffer:V,byteOffset:I,byteLength:G,byteStride:S,target:Yt.BufferViewTarget.ARRAY_BUFFER};return s.bufferViews.push(N),{byteLength:G,buffers:[new Uint8Array(v)]}}function p(h,V,I){const C=[];let S=0;const G=new Map;let v=-1/0,w=!1;for(const de of h){const we=o.createAccessorDef(de);s.accessors.push(we),o.accessorIndexMap.set(de,s.accessors.length-1);const Re=[],Ie=[],Ve=[],wt=new Array(de.getElementSize()).fill(0);for(let dt=0,pt=de.getCount();dt<pt;dt++)if(de.getElement(dt,Ve),!st.eq(Ve,wt,0)){v=Math.max(dt,v),Re.push(dt);for(let Ge=0;Ge<Ve.length;Ge++)Ie.push(Ve[Ge])}const Pt=Re.length,at={accessorDef:we,count:Pt};if(G.set(de,at),Pt===0)continue;Pt>de.getCount()/2&&(w=!0);const Ft=cs[de.getComponentType()];at.indices=Re,at.values=new Ft(Ie)}if(!Number.isFinite(v))return{buffers:C,byteLength:S};w&&a.warn("Some sparse accessors have >50% non-zero elements, which may increase file size.");const N=v<255?Uint8Array:v<65535?Uint16Array:Uint32Array,P=v<255?ml:v<65535?gl:pl,U={buffer:V,byteOffset:I+S,byteLength:0};for(const de of h){const we=G.get(de);if(we.count===0)continue;we.indicesByteOffset=U.byteLength;const Re=Ne.pad(Ne.toView(new N(we.indices)));C.push(Re),S+=Re.byteLength,U.byteLength+=Re.byteLength}s.bufferViews.push(U);const B=s.bufferViews.length-1,Z={buffer:V,byteOffset:I+S,byteLength:0};for(const de of h){const we=G.get(de);if(we.count===0)continue;we.valuesByteOffset=Z.byteLength;const Re=Ne.pad(Ne.toView(we.values));C.push(Re),S+=Re.byteLength,Z.byteLength+=Re.byteLength}s.bufferViews.push(Z);const Se=s.bufferViews.length-1;for(const de of h){const we=G.get(de);we.count!==0&&(we.accessorDef.sparse={count:we.count,indices:{bufferView:B,byteOffset:we.indicesByteOffset,componentType:P},values:{bufferView:Se,byteOffset:we.valuesByteOffset}})}return{buffers:C,byteLength:S}}if(s.accessors=[],s.bufferViews=[],s.samplers=[],s.textures=[],s.images=r.listTextures().map((h,V)=>{const I=o.createPropertyDef(h);h.getMimeType()&&(I.mimeType=h.getMimeType());const C=h.getImage();return C&&o.createImageData(I,C,h),o.imageIndexMap.set(h,V),I}),f.filter(h=>h.prewriteTypes.includes(k.ACCESSOR)).forEach(h=>h.prewrite(o,k.ACCESSOR)),r.listAccessors().forEach(h=>{const V=o.accessorUsageGroupedByParent,I=o.accessorParents;if(o.accessorIndexMap.has(h))return;const C=o.getAccessorUsage(h);if(o.addAccessorToUsageGroup(h,C),V.has(C)){const S=n.listParents(h).find(G=>G.propertyType!==k.ROOT);I.set(h,S)}}),f.filter(h=>h.prewriteTypes.includes(k.BUFFER)).forEach(h=>h.prewrite(o,k.BUFFER)),(r.listAccessors().length>0||o.otherBufferViews.size>0||r.listTextures().length>0&&t.format===Hn.GLB)&&r.listBuffers().length===0)throw new Error("Buffer required for Document resources, but none was found.");s.buffers=[],r.listBuffers().forEach((h,V)=>{const I=o.createPropertyDef(h),C=o.accessorUsageGroupedByParent,S=h.listParents().filter(Z=>Z instanceof ge),G=new Set(S.map(Z=>o.accessorParents.get(Z))),v=new Map(Array.from(G).map((Z,Se)=>[Z,Se])),w={};for(const Z of S){var N;if(o.accessorIndexMap.has(Z))continue;const Se=o.getAccessorUsage(Z);let de=Se;if(C.has(Se)){const we=o.accessorParents.get(Z);de+=`:${v.get(we)}`}w[N=de]||(w[N]={usage:Se,accessors:[]}),w[de].accessors.push(Z)}const P=[],U=s.buffers.length;let B=0;for(const{usage:Z,accessors:Se}of Object.values(w))if(Z===Lr.ARRAY_BUFFER&&t.vertexLayout===Is.INTERLEAVED){const de=g(Se,U,B);B+=de.byteLength;for(const we of de.buffers)P.push(we)}else if(Z===Lr.ARRAY_BUFFER)for(const de of Se){const we=g([de],U,B);B+=we.byteLength;for(const Re of we.buffers)P.push(Re)}else if(Z===Lr.SPARSE){const de=p(Se,U,B);B+=de.byteLength;for(const we of de.buffers)P.push(we)}else if(Z===Lr.ELEMENT_ARRAY_BUFFER){const de=Yt.BufferViewTarget.ELEMENT_ARRAY_BUFFER,we=y(Se,U,B,de);B+=we.byteLength;for(const Re of we.buffers)P.push(Re)}else{const de=y(Se,U,B);B+=de.byteLength;for(const we of de.buffers)P.push(we)}if(o.imageBufferViews.length&&V===0){for(let Z=0;Z<o.imageBufferViews.length;Z++)if(s.bufferViews[s.images[Z].bufferView].byteOffset=B,B+=o.imageBufferViews[Z].byteLength,P.push(o.imageBufferViews[Z]),B%8){const Se=8-B%8;B+=Se,P.push(new Uint8Array(Se))}}if(o.otherBufferViews.has(h))for(const Z of o.otherBufferViews.get(h))s.bufferViews.push({buffer:U,byteOffset:B,byteLength:Z.byteLength}),o.otherBufferViewsIndexMap.set(Z,s.bufferViews.length-1),B+=Z.byteLength,P.push(Z);if(B){let Z;t.format===Hn.GLB?Z=er:(Z=o.bufferURIGenerator.createURI(h,"bin"),I.uri=Z),I.byteLength=B,o.assignResourceURI(Z,Ne.concat(P),!0)}s.buffers.push(I),o.bufferIndexMap.set(h,V)}),r.listAccessors().find(h=>!h.getBuffer())&&a.warn("Skipped writing one or more Accessors: no Buffer assigned."),f.filter(h=>h.prewriteTypes.includes(k.MATERIAL)).forEach(h=>h.prewrite(o,k.MATERIAL)),s.materials=r.listMaterials().map((h,V)=>{const I=o.createPropertyDef(h);if(h.getAlphaMode()!==Qn.AlphaMode.OPAQUE&&(I.alphaMode=h.getAlphaMode()),h.getAlphaMode()===Qn.AlphaMode.MASK&&(I.alphaCutoff=h.getAlphaCutoff()),h.getDoubleSided()&&(I.doubleSided=!0),I.pbrMetallicRoughness={},st.eq(h.getBaseColorFactor(),[1,1,1,1])||(I.pbrMetallicRoughness.baseColorFactor=h.getBaseColorFactor()),st.eq(h.getEmissiveFactor(),[0,0,0])||(I.emissiveFactor=h.getEmissiveFactor()),h.getRoughnessFactor()!==1&&(I.pbrMetallicRoughness.roughnessFactor=h.getRoughnessFactor()),h.getMetallicFactor()!==1&&(I.pbrMetallicRoughness.metallicFactor=h.getMetallicFactor()),h.getBaseColorTexture()){const C=h.getBaseColorTexture(),S=h.getBaseColorTextureInfo();I.pbrMetallicRoughness.baseColorTexture=o.createTextureInfoDef(C,S)}if(h.getEmissiveTexture()){const C=h.getEmissiveTexture(),S=h.getEmissiveTextureInfo();I.emissiveTexture=o.createTextureInfoDef(C,S)}if(h.getNormalTexture()){const C=h.getNormalTexture(),S=h.getNormalTextureInfo(),G=o.createTextureInfoDef(C,S);h.getNormalScale()!==1&&(G.scale=h.getNormalScale()),I.normalTexture=G}if(h.getOcclusionTexture()){const C=h.getOcclusionTexture(),S=h.getOcclusionTextureInfo(),G=o.createTextureInfoDef(C,S);h.getOcclusionStrength()!==1&&(G.strength=h.getOcclusionStrength()),I.occlusionTexture=G}if(h.getMetallicRoughnessTexture()){const C=h.getMetallicRoughnessTexture(),S=h.getMetallicRoughnessTextureInfo();I.pbrMetallicRoughness.metallicRoughnessTexture=o.createTextureInfoDef(C,S)}return o.materialIndexMap.set(h,V),I}),f.filter(h=>h.prewriteTypes.includes(k.MESH)).forEach(h=>h.prewrite(o,k.MESH)),s.meshes=r.listMeshes().map((h,V)=>{const I=o.createPropertyDef(h);let C=null;return I.primitives=h.listPrimitives().map(S=>{const G={attributes:{}};G.mode=S.getMode();const v=S.getMaterial();v&&(G.material=o.materialIndexMap.get(v)),Object.keys(S.getExtras()).length&&(G.extras=S.getExtras());const w=S.getIndices();w&&(G.indices=o.accessorIndexMap.get(w));for(const N of S.listSemantics())G.attributes[N]=o.accessorIndexMap.get(S.getAttribute(N));for(const N of S.listTargets()){const P={};for(const U of N.listSemantics())P[U]=o.accessorIndexMap.get(N.getAttribute(U));G.targets=G.targets||[],G.targets.push(P)}return S.listTargets().length&&!C&&(C=S.listTargets().map(N=>N.getName())),G}),h.getWeights().length&&(I.weights=h.getWeights()),C&&(I.extras=I.extras||{},I.extras.targetNames=C),o.meshIndexMap.set(h,V),I}),s.cameras=r.listCameras().map((h,V)=>{const I=o.createPropertyDef(h);if(I.type=h.getType(),I.type===vr.Type.PERSPECTIVE){I.perspective={znear:h.getZNear(),zfar:h.getZFar(),yfov:h.getYFov()};const C=h.getAspectRatio();C!==null&&(I.perspective.aspectRatio=C)}else I.orthographic={znear:h.getZNear(),zfar:h.getZFar(),xmag:h.getXMag(),ymag:h.getYMag()};return o.cameraIndexMap.set(h,V),I}),s.nodes=r.listNodes().map((h,V)=>{const I=o.createPropertyDef(h);return st.eq(h.getTranslation(),[0,0,0])||(I.translation=h.getTranslation()),st.eq(h.getRotation(),[0,0,0,1])||(I.rotation=h.getRotation()),st.eq(h.getScale(),[1,1,1])||(I.scale=h.getScale()),h.getWeights().length&&(I.weights=h.getWeights()),o.nodeIndexMap.set(h,V),I}),s.skins=r.listSkins().map((h,V)=>{const I=o.createPropertyDef(h),C=h.getInverseBindMatrices();C&&(I.inverseBindMatrices=o.accessorIndexMap.get(C));const S=h.getSkeleton();return S&&(I.skeleton=o.nodeIndexMap.get(S)),I.joints=h.listJoints().map(G=>o.nodeIndexMap.get(G)),o.skinIndexMap.set(h,V),I}),r.listNodes().forEach((h,V)=>{const I=s.nodes[V],C=h.getMesh();C&&(I.mesh=o.meshIndexMap.get(C));const S=h.getCamera();S&&(I.camera=o.cameraIndexMap.get(S));const G=h.getSkin();G&&(I.skin=o.skinIndexMap.get(G)),h.listChildren().length>0&&(I.children=h.listChildren().map(v=>o.nodeIndexMap.get(v)))}),s.animations=r.listAnimations().map((h,V)=>{const I=o.createPropertyDef(h),C=new Map;return I.samplers=h.listSamplers().map((S,G)=>{const v=o.createPropertyDef(S);return v.input=o.accessorIndexMap.get(S.getInput()),v.output=o.accessorIndexMap.get(S.getOutput()),v.interpolation=S.getInterpolation(),C.set(S,G),v}),I.channels=h.listChannels().map(S=>{const G=o.createPropertyDef(S);return G.sampler=C.get(S.getSampler()),G.target={node:o.nodeIndexMap.get(S.getTargetNode()),path:S.getTargetPath()},G}),o.animationIndexMap.set(h,V),I}),s.scenes=r.listScenes().map((h,V)=>{const I=o.createPropertyDef(h);return I.nodes=h.listChildren().map(C=>o.nodeIndexMap.get(C)),o.sceneIndexMap.set(h,V),I});const R=r.getDefaultScene();return R&&(s.scene=r.listScenes().indexOf(R)),s.extensionsUsed=f.map(h=>h.extensionName),s.extensionsRequired=m.map(h=>h.extensionName),f.forEach(h=>h.write(o)),ad(s),i}},(function(e){e[e.JSON=1313821514]="JSON",e[e.BIN=5130562]="BIN"})(As||(As={})),Tl=class{constructor(){this._logger=Wn.DEFAULT_INSTANCE,this._extensions=new Set,this._dependencies={},this._vertexLayout=Is.INTERLEAVED,this._strictResources=!0,this.lastReadBytes=0,this.lastWriteBytes=0}setLogger(e){return this._logger=e,this}registerExtensions(e){for(const t of e)this._extensions.add(t),t.register();return this}registerDependencies(e){return Object.assign(this._dependencies,e),this}setVertexLayout(e){return this._vertexLayout=e,this}setStrictResources(e){return this._strictResources=e,this}async read(e){return await this.readJSON(await this.readAsJSON(e))}async readAsJSON(e){const t=await this.readURI(e,"view");this.lastReadBytes=t.byteLength;const n=nl(t)?this._binaryToJSON(t):{json:JSON.parse(Ne.decodeText(t)),resources:{}};return await this._readResourcesExternal(n,this.dirname(e)),this._readResourcesInternal(n),n}async readJSON(e){return e=this._copyJSON(e),this._readResourcesInternal(e),dl.read(e,{extensions:Array.from(this._extensions),dependencies:this._dependencies,logger:this._logger})}async binaryToJSON(e){const t=this._binaryToJSON(Ne.assertView(e));this._readResourcesInternal(t);const n=t.json;if(n.buffers&&n.buffers.some(r=>ld(t,r)))throw new Error("Cannot resolve external buffers with binaryToJSON().");if(n.images&&n.images.some(r=>cd(t,r)))throw new Error("Cannot resolve external images with binaryToJSON().");return t}async readBinary(e){return this.readJSON(await this.binaryToJSON(Ne.assertView(e)))}async writeJSON(e,t={}){if(t.format===Hn.GLB&&e.getRoot().listBuffers().length>1)throw new Error("GLB must have 01 buffers.");return vl.write(e,{format:t.format||Hn.GLTF,basename:t.basename||"",logger:this._logger,vertexLayout:this._vertexLayout,dependencies:Dt({},this._dependencies),extensions:Array.from(this._extensions)})}async writeBinary(e){const{json:t,resources:n}=await this.writeJSON(e,{format:Hn.GLB}),r=new Uint32Array([1179937895,2,12]),s=JSON.stringify(t),i=Ne.pad(Ne.encodeText(s),32),o=Ne.toView(new Uint32Array([i.byteLength,1313821514])),a=Ne.concat([o,i]);r[r.length-1]+=a.byteLength;const u=Object.values(n)[0];if(!u||!u.byteLength)return Ne.concat([Ne.toView(r),a]);const f=Ne.pad(u,0),m=Ne.toView(new Uint32Array([f.byteLength,5130562])),y=Ne.concat([m,f]);return r[r.length-1]+=y.byteLength,Ne.concat([Ne.toView(r),a,y])}async _readResourcesExternal(e,t){var n=this;const r=e.json.images||[],s=e.json.buffers||[],i=[...r,...s].map(async function(o){const a=o.uri;if(!a||a.match(/data:/))return Promise.resolve();try{e.resources[a]=await n.readURI(n.resolve(t,a),"view"),n.lastReadBytes+=e.resources[a].byteLength}catch(u){if(!n._strictResources&&r.includes(o))n._logger.warn(`Failed to load image URI, "${a}". ${u}`),e.resources[a]=null;else throw u}});await Promise.all(i)}_readResourcesInternal(e){function t(s){if(s.uri){if(s.uri in e.resources){Ne.assertView(e.resources[s.uri]);return}if(s.uri.match(/data:/)){const i=`__${al()}.${Zn.extension(s.uri)}`;e.resources[i]=Ne.createBufferFromDataURI(s.uri),s.uri=i}}}(e.json.images||[]).forEach(s=>{if(s.bufferView===void 0&&s.uri===void 0)throw new Error("Missing resource URI or buffer view.");t(s)}),(e.json.buffers||[]).forEach(t)}_copyJSON(e){const{images:t,buffers:n}=e.json;return e={json:Dt({},e.json),resources:Dt({},e.resources)},t&&(e.json.images=t.map(r=>Dt({},r))),n&&(e.json.buffers=n.map(r=>Dt({},r))),e}_binaryToJSON(e){if(!nl(e))throw new Error("Invalid glTF 2.0 binary.");const t=new Uint32Array(e.buffer,e.byteOffset+12,2);if(t[1]!==As.JSON)throw new Error("Missing required GLB JSON chunk.");const n=20,r=t[0],s=Ne.decodeText(Ne.toView(e,n,r)),i=JSON.parse(s),o=n+r;if(e.byteLength<=o)return{json:i,resources:{}};const a=new Uint32Array(e.buffer,e.byteOffset+o,2);if(a[1]!==As.BIN)return{json:i,resources:{}};const u=a[0],f=Ne.toView(e,o+8,u);return{json:i,resources:{[er]:f}}}},Lc=class extends Tl{constructor(e=yr.DEFAULT_INIT){super(),this._fetchConfig=void 0,this._fetchConfig=e}async readURI(e,t){const n=await fetch(e,this._fetchConfig);switch(t){case"view":return new Uint8Array(await n.arrayBuffer());case"text":return n.text()}}resolve(e,t){return yr.resolve(e,t)}dirname(e){return yr.dirname(e)}}}}),xl,sa,ud=ut({"manifold.js"(){xl=(()=>{var e=import.meta.url;return(async function(t={}){var n,r=t,s,i,o=new Promise((l,c)=>{s=l,i=c}),a=typeof window=="object",u=typeof importScripts=="function",f=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(f){const{createRequire:l}=await import("./__vite-browser-external-9wXp6ZBx.js");var m=l(import.meta.url)}var y=!1;r.setup=function(){if(y)return;y=!0,r.initTBB();function l(_,L,q=(se=>se)){if(L)for(let se of L)_.push_back(q(se));return _}function c(_,L=(q=>q)){const q=[],se=_.size();for(let Me=0;Me<se;Me++)q.push(L(_.get(Me)));return q}function d(_,L=(q=>q)){const q=[],se=_.size();for(let Me=0;Me<se;Me++){const Ye=_.get(Me),ht=Ye.size(),Bt=[];for(let vt=0;vt<ht;vt++)Bt.push(L(Ye.get(vt)));q.push(Bt)}return q}function T(_){return _[0].length<3&&(_=[_]),l(new r.Vector2_vec2,_,L=>l(new r.Vector_vec2,L,q=>q instanceof Array?{x:q[0],y:q[1]}:q))}function D(_){for(let L=0;L<_.size();L++)_.get(L).delete();_.delete()}function j(_){return _[0]instanceof Array?{x:_[0][0],y:_[0][1]}:typeof _[0]=="number"?{x:_[0]||0,y:_[1]||0}:_[0]}function K(_){return _[0]instanceof Array?{x:_[0][0],y:_[0][1],z:_[0][2]}:typeof _[0]=="number"?{x:_[0]||0,y:_[1]||0,z:_[2]||0}:_[0]}function $(_){return _=="EvenOdd"?0:_=="NonZero"?1:_=="Negative"?3:2}function ee(_){return _=="Round"?1:_=="Miter"?2:0}const re=r.CrossSection;function ce(_,L="Positive"){if(_ instanceof re)return _;{const q=T(_),se=new re(q,$(L));return D(q),se}}r.CrossSection.prototype.translate=function(..._){return this._Translate(j(_))},r.CrossSection.prototype.scale=function(_){return typeof _=="number"?this._Scale({x:_,y:_}):this._Scale(j([_]))},r.CrossSection.prototype.mirror=function(_){return this._Mirror(j([_]))},r.CrossSection.prototype.warp=function(_){const L=Nr(function(se){const Me=Et(se,"double"),Ye=Et(se+8,"double"),ht=[Me,Ye];_(ht),jt(se,ht[0],"double"),jt(se+8,ht[1],"double")},"vi"),q=this._Warp(L);return Or(L),q},r.CrossSection.prototype.decompose=function(){const _=this._Decompose(),L=c(_);return _.delete(),L},r.CrossSection.prototype.bounds=function(){const _=this._Bounds();return{min:["x","y"].map(L=>_.min[L]),max:["x","y"].map(L=>_.max[L])}},r.CrossSection.prototype.offset=function(_,L="Round",q=2,se=0){return this._Offset(_,ee(L),q,se)},r.CrossSection.prototype.simplify=function(_=1e-6){return this._Simplify(_)},r.CrossSection.prototype.extrude=function(_,L=0,q=0,se=[1,1],Me=!1){se=j([se]);const Ye=r._Extrude(this._ToPolygons(),_,L,q,se);return Me?Ye.translate([0,0,-_/2]):Ye},r.CrossSection.prototype.revolve=function(_=0,L=360){return r._Revolve(this._ToPolygons(),_,L)},r.CrossSection.prototype.add=function(_){return this._add(ce(_))},r.CrossSection.prototype.subtract=function(_){return this._subtract(ce(_))},r.CrossSection.prototype.intersect=function(_){return this._intersect(ce(_))},r.CrossSection.prototype.toPolygons=function(){const _=this._ToPolygons(),L=d(_,q=>[q.x,q.y]);return _.delete(),L},r.Manifold.prototype.smoothOut=function(_=60,L=0){return this._SmoothOut(_,L)},r.Manifold.prototype.warp=function(_){const L=Nr(function(Me){const Ye=Et(Me,"double"),ht=Et(Me+8,"double"),Bt=Et(Me+16,"double"),vt=[Ye,ht,Bt];_(vt),jt(Me,vt[0],"double"),jt(Me+8,vt[1],"double"),jt(Me+16,vt[2],"double")},"vi"),q=this._Warp(L);Or(L);const se=q.status();if(se!=="NoError")throw new r.ManifoldError(se);return q},r.Manifold.prototype.calculateNormals=function(_,L=60){return this._CalculateNormals(_,L)},r.Manifold.prototype.setProperties=function(_,L){const q=this.numProp(),se=Nr(function(Ye,ht,Bt){const vt=[];for(let ot=0;ot<_;++ot)vt[ot]=Et(Ye+8*ot,"double");const gr=[];for(let ot=0;ot<3;++ot)gr[ot]=Et(ht+8*ot,"double");const mr=[];for(let ot=0;ot<q;++ot)mr[ot]=Et(Bt+8*ot,"double");L(vt,gr,mr);for(let ot=0;ot<_;++ot)jt(Ye+8*ot,vt[ot],"double")},"viii"),Me=this._SetProperties(_,se);return Or(se),Me},r.Manifold.prototype.translate=function(..._){return this._Translate(K(_))},r.Manifold.prototype.rotate=function(_,L,q){return Array.isArray(_)?this._Rotate(..._):this._Rotate(_,L||0,q||0)},r.Manifold.prototype.scale=function(_){return typeof _=="number"?this._Scale({x:_,y:_,z:_}):this._Scale(K([_]))},r.Manifold.prototype.mirror=function(_){return this._Mirror(K([_]))},r.Manifold.prototype.trimByPlane=function(_,L=0){return this._TrimByPlane(K([_]),L)},r.Manifold.prototype.slice=function(_=0){const L=this._Slice(_),q=new re(L,$("Positive"));return D(L),q},r.Manifold.prototype.project=function(){const _=this._Project(),L=new re(_,$("Positive"));return D(_),L},r.Manifold.prototype.split=function(_){const L=this._Split(_),q=c(L);return L.delete(),q},r.Manifold.prototype.splitByPlane=function(_,L=0){const q=this._SplitByPlane(K([_]),L),se=c(q);return q.delete(),se},r.Manifold.prototype.decompose=function(){const _=this._Decompose(),L=c(_);return _.delete(),L},r.Manifold.prototype.boundingBox=function(){const _=this._boundingBox();return{min:["x","y","z"].map(L=>_.min[L]),max:["x","y","z"].map(L=>_.max[L])}},r.Manifold.prototype.simplify=function(_=0){return this._Simplify(_)};class Ae{constructor({numProp:L=3,triVerts:q=new Uint32Array,vertProperties:se=new Float32Array,mergeFromVert:Me,mergeToVert:Ye,runIndex:ht,runOriginalID:Bt,faceID:vt,halfedgeTangent:gr,runTransform:mr,tolerance:ot=0}={}){this.numProp=L,this.triVerts=q,this.vertProperties=se,this.mergeFromVert=Me,this.mergeToVert=Ye,this.runIndex=ht,this.runOriginalID=Bt,this.faceID=vt,this.halfedgeTangent=gr,this.runTransform=mr,this.tolerance=ot}get numTri(){return this.triVerts.length/3}get numVert(){return this.vertProperties.length/this.numProp}get numRun(){return this.runOriginalID.length}merge(){const{changed:L,mesh:q}=r._Merge(this);return Object.assign(this,{...q}),L}verts(L){return this.triVerts.subarray(3*L,3*(L+1))}position(L){return this.vertProperties.subarray(this.numProp*L,this.numProp*L+3)}extras(L){return this.vertProperties.subarray(this.numProp*L+3,this.numProp*(L+1))}tangent(L){return this.halfedgeTangent.subarray(4*L,4*(L+1))}transform(L){const q=new Array(16);for(const se of[0,1,2,3])for(const Me of[0,1,2])q[4*se+Me]=this.runTransform[12*L+3*se+Me];return q[15]=1,q}}r.Mesh=Ae,r.Manifold.prototype.getMesh=function(_=-1){return new Ae(this._GetMeshJS(_))},r.ManifoldError=function(L,...q){let se="Unknown error";switch(L){case"NonFiniteVertex":se="Non-finite vertex";break;case"NotManifold":se="Not manifold";break;case"VertexOutOfBounds":se="Vertex index out of bounds";break;case"PropertiesWrongLength":se="Properties have wrong length";break;case"MissingPositionProperties":se="Less than three properties";break;case"MergeVectorsDifferentLengths":se="Merge vectors have different lengths";break;case"MergeIndexOutOfBounds":se="Merge index out of bounds";break;case"TransformWrongLength":se="Transform vector has wrong length";break;case"RunIndexWrongLength":se="Run index vector has wrong length";break;case"FaceIDWrongLength":se="Face ID vector has wrong length";case"InvalidConstruction":se="Manifold constructed with invalid parameters"}const Me=Error.apply(this,[se,...q]);Me.name=this.name="ManifoldError",this.message=Me.message,this.stack=Me.stack,this.code=L},r.ManifoldError.prototype=Object.create(Error.prototype,{constructor:{value:r.ManifoldError,writable:!0,configurable:!0}}),r.CrossSection=function(_,L="Positive"){const q=T(_),se=new re(q,$(L));return D(q),se},r.CrossSection.ofPolygons=function(_,L="Positive"){return new r.CrossSection(_,L)},r.CrossSection.square=function(..._){let L;_.length==0?L={x:1,y:1}:typeof _[0]=="number"?L={x:_[0],y:_[0]}:L=j(_);const q=_[1]||!1;return r._Square(L,q)},r.CrossSection.circle=function(_,L=0){return r._Circle(_,L)};function ze(_){return function(...L){L.length==1&&(L=L[0]);const q=new r.Vector_crossSection;for(const Me of L)q.push_back(ce(Me));const se=r["_crossSection"+_](q);return q.delete(),se}}r.CrossSection.compose=ze("Compose"),r.CrossSection.union=ze("UnionN"),r.CrossSection.difference=ze("DifferenceN"),r.CrossSection.intersection=ze("IntersectionN");function gt(_,L){l(_,L,q=>q instanceof Array?{x:q[0],y:q[1]}:q)}r.CrossSection.hull=function(..._){_.length==1&&(_=_[0]);let L=new r.Vector_vec2;for(const se of _)if(se instanceof re)r._crossSectionCollectVertices(L,se);else if(se instanceof Array&&se.length==2&&typeof se[0]=="number")L.push_back({x:se[0],y:se[1]});else if(se.x)L.push_back(se);else{const Ye=se[0].length==2&&typeof se[0][0]=="number"||se[0].x?[se]:se;for(const ht of Ye)gt(L,ht)}const q=r._crossSectionHullPoints(L);return L.delete(),q},r.CrossSection.prototype=Object.create(re.prototype),Object.defineProperty(r.CrossSection,Symbol.hasInstance,{get:()=>_=>_ instanceof re});const lt=r.Manifold;r.Manifold=function(_){const L=new lt(_),q=L.status();if(q!=="NoError")throw new r.ManifoldError(q);return L},r.Manifold.ofMesh=function(_){return new r.Manifold(_)},r.Manifold.tetrahedron=function(){return r._Tetrahedron()},r.Manifold.cube=function(..._){let L;_.length==0?L={x:1,y:1,z:1}:typeof _[0]=="number"?L={x:_[0],y:_[0],z:_[0]}:L=K(_);const q=_[1]||!1;return r._Cube(L,q)},r.Manifold.cylinder=function(_,L,q=-1,se=0,Me=!1){return r._Cylinder(_,L,q,se,Me)},r.Manifold.sphere=function(_,L=0){return r._Sphere(_,L)},r.Manifold.smooth=function(_,L=[]){const q=new r.Vector_smoothness;l(q,L);const se=r._Smooth(_,q);return q.delete(),se},r.Manifold.extrude=function(_,L,q=0,se=0,Me=[1,1],Ye=!1){return(_ instanceof re?_:r.CrossSection(_,"Positive")).extrude(L,q,se,Me,Ye)},r.Manifold.revolve=function(_,L=0,q=360){return(_ instanceof re?_:r.CrossSection(_,"Positive")).revolve(L,q)},r.Manifold.reserveIDs=function(_){return r._ReserveIDs(_)};function sn(_){return function(...L){L.length==1&&(L=L[0]);const q=new r.Vector_manifold;for(const Me of L)q.push_back(Me);const se=r["_manifold"+_+"N"](q);return q.delete(),se}}r.Manifold.union=sn("Union"),r.Manifold.compose=r.Manifold.union,r.Manifold.difference=sn("Difference"),r.Manifold.intersection=sn("Intersection"),r.Manifold.levelSet=function(_,L,q,se=0,Me=-1){const Ye={min:{x:L.min[0],y:L.min[1],z:L.min[2]},max:{x:L.max[0],y:L.max[1],z:L.max[2]}},ht=Nr(function(vt){const gr=Et(vt,"double"),mr=Et(vt+8,"double"),ot=Et(vt+16,"double");return _([gr,mr,ot])},"di"),Bt=r._LevelSet(ht,Ye,q,se,Me);return Or(ht),Bt};function on(_,L){l(_,L,q=>q instanceof Array?{x:q[0],y:q[1],z:q[2]}:q)}r.Manifold.hull=function(..._){_.length==1&&(_=_[0]);let L=new r.Vector_vec3;for(const se of _)se instanceof lt?r._manifoldCollectVertices(L,se):se instanceof Array&&se.length==3&&typeof se[0]=="number"?L.push_back({x:se[0],y:se[1],z:se[2]}):se.x?L.push_back(se):on(L,se);const q=r._manifoldHullPoints(L);return L.delete(),q},r.Manifold.prototype=Object.create(lt.prototype),Object.defineProperty(r.Manifold,Symbol.hasInstance,{get:()=>_=>_ instanceof lt}),r.triangulate=function(_,L=-1,q=!0){const se=T(_),Me=c(r._Triangulate(se,L,q),Ye=>[Ye[0],Ye[1],Ye[2]]);return D(se),Me}};var g=Object.assign({},r),p="";function M(l){return r.locateFile?r.locateFile(l,p):p+l}var R,h;if(f){var V=m("fs"),I=m("path");p=m("url").fileURLToPath(new URL("./",import.meta.url)),h=l=>{l=Ct(l)?new URL(l):I.normalize(l);var c=V.readFileSync(l);return c},R=(l,c=!0)=>(l=Ct(l)?new URL(l):I.normalize(l),new Promise((d,T)=>{V.readFile(l,c?void 0:"utf8",(D,j)=>{D?T(D):d(c?j.buffer:j)})})),!r.thisProgram&&process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2)}else(a||u)&&(u?p=self.location.href:typeof document<"u"&&document.currentScript&&(p=document.currentScript.src),e&&(p=e),p.startsWith("blob:")?p="":p=p.substr(0,p.replace(/[?#].*/,"").lastIndexOf("/")+1),u&&(h=l=>{var c=new XMLHttpRequest;return c.open("GET",l,!1),c.responseType="arraybuffer",c.send(null),new Uint8Array(c.response)}),R=l=>Ct(l)?new Promise((c,d)=>{var T=new XMLHttpRequest;T.open("GET",l,!0),T.responseType="arraybuffer",T.onload=()=>{(T.status==200||T.status==0&&T.response)&&d(T.response),c(T.status)},T.onerror=c,T.send(null)}):fetch(l,{credentials:"same-origin"}).then(c=>c.ok?c.arrayBuffer():Promise.reject(new Error(c.status+" : "+c.url))));r.print||console.log.bind(console);var C=r.printErr||console.error.bind(console);Object.assign(r,g),g=null,r.arguments&&r.arguments,r.thisProgram&&r.thisProgram,r.quit&&r.quit;var S;r.wasmBinary&&(S=r.wasmBinary);var G,v=!1,w,N,P,U,B,Z,Se,de;function we(){var l=G.buffer;r.HEAP8=w=new Int8Array(l),r.HEAP16=P=new Int16Array(l),r.HEAPU8=N=new Uint8Array(l),r.HEAPU16=U=new Uint16Array(l),r.HEAP32=B=new Int32Array(l),r.HEAPU32=Z=new Uint32Array(l),r.HEAPF32=Se=new Float32Array(l),r.HEAPF64=de=new Float64Array(l)}var Re=[],Ie=[],Ve=[];function wt(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)Ft(r.preRun.shift());ur(Re)}function Pt(){ur(Ie)}function at(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)pt(r.postRun.shift());ur(Ve)}function Ft(l){Re.unshift(l)}function dt(l){Ie.unshift(l)}function pt(l){Ve.unshift(l)}var Ge=0,O=null;function qe(l){Ge++,r.monitorRunDependencies?.(Ge)}function In(l){if(Ge--,r.monitorRunDependencies?.(Ge),Ge==0&&O){var c=O;O=null,c()}}function Lt(l){r.onAbort?.(l),l="Aborted("+l+")",C(l),v=!0,l+=". Build with -sASSERTIONS for more info.";var c=new WebAssembly.RuntimeError(l);throw i(c),c}var nt="data:application/octet-stream;base64,",$e=l=>l.startsWith(nt),Ct=l=>l.startsWith("file://");function Sn(){if(r.locateFile){var l="manifold.wasm";return $e(l)?l:M(l)}return new URL("manifold.wasm",import.meta.url).href}var kt;function vs(l){if(l==kt&&S)return new Uint8Array(S);if(h)return h(l);throw"both async and sync fetching of the wasm failed"}function gi(l){return S?Promise.resolve().then(()=>vs(l)):R(l).then(c=>new Uint8Array(c),()=>vs(l))}function Ts(l,c,d){return gi(l).then(T=>WebAssembly.instantiate(T,c)).then(d,T=>{C(`failed to asynchronously prepare wasm: ${T}`),Lt(T)})}function xs(l,c,d,T){return!l&&typeof WebAssembly.instantiateStreaming=="function"&&!$e(c)&&!Ct(c)&&!f&&typeof fetch=="function"?fetch(c,{credentials:"same-origin"}).then(D=>{var j=WebAssembly.instantiateStreaming(D,d);return j.then(T,function(K){return C(`wasm streaming compile failed: ${K}`),C("falling back to ArrayBuffer instantiation"),Ts(c,d,T)})}):Ts(c,d,T)}function cr(){return{a:kh}}function An(){var l=cr();function c(T,D){return rn=T.exports,rn=jh(rn),G=rn.J,we(),De=rn.M,dt(rn.K),In(),rn}qe();function d(T){c(T.instance)}if(r.instantiateWasm)try{return r.instantiateWasm(l,c)}catch(T){C(`Module.instantiateWasm callback failed with error: ${T}`),i(T)}return kt||(kt=Sn()),xs(S,kt,l,d).catch(i),{}}var ur=l=>{for(;l.length>0;)l.shift()(r)};function Et(l,c="i8"){switch(c.endsWith("*")&&(c="*"),c){case"i1":return w[l>>>0];case"i8":return w[l>>>0];case"i16":return P[l>>>1>>>0];case"i32":return B[l>>>2>>>0];case"i64":Lt("to do getValue(i64) use WASM_BIGINT");case"float":return Se[l>>>2>>>0];case"double":return de[l>>>3>>>0];case"*":return Z[l>>>2>>>0];default:Lt(`invalid type for getValue: ${c}`)}}r.noExitRuntime;function jt(l,c,d="i8"){switch(d.endsWith("*")&&(d="*"),d){case"i1":w[l>>>0]=c;break;case"i8":w[l>>>0]=c;break;case"i16":P[l>>>1>>>0]=c;break;case"i32":B[l>>>2>>>0]=c;break;case"i64":Lt("to do setValue(i64) use WASM_BIGINT");case"float":Se[l>>>2>>>0]=c;break;case"double":de[l>>>3>>>0]=c;break;case"*":Z[l>>>2>>>0]=c;break;default:Lt(`invalid type for setValue: ${d}`)}}class ws{constructor(c){this.excPtr=c,this.ptr=c-24}set_type(c){Z[this.ptr+4>>>2>>>0]=c}get_type(){return Z[this.ptr+4>>>2>>>0]}set_destructor(c){Z[this.ptr+8>>>2>>>0]=c}get_destructor(){return Z[this.ptr+8>>>2>>>0]}set_caught(c){c=c?1:0,w[this.ptr+12>>>0]=c}get_caught(){return w[this.ptr+12>>>0]!=0}set_rethrown(c){c=c?1:0,w[this.ptr+13>>>0]=c}get_rethrown(){return w[this.ptr+13>>>0]!=0}init(c,d){this.set_adjusted_ptr(0),this.set_type(c),this.set_destructor(d)}set_adjusted_ptr(c){Z[this.ptr+16>>>2>>>0]=c}get_adjusted_ptr(){return Z[this.ptr+16>>>2>>>0]}get_exception_ptr(){var c=Za(this.get_type());if(c)return Z[this.excPtr>>>2>>>0];var d=this.get_adjusted_ptr();return d!==0?d:this.excPtr}}var zt=0;function fr(l,c,d){l>>>=0,c>>>=0,d>>>=0;var T=new ws(l);throw T.init(c,d),zt=l,zt}var mi=()=>{Lt("")},hr={},Vn=l=>{for(;l.length;){var c=l.pop(),d=l.pop();d(c)}};function Kn(l){return this.fromWireType(Z[l>>>2>>>0])}var Gn={},Mn={},dr={},Es,pr=l=>{throw new Es(l)},Cn=(l,c,d)=>{l.forEach(function($){dr[$]=c});function T($){var ee=d($);ee.length!==l.length&&pr("Mismatched type converter count");for(var re=0;re<l.length;++re)Ht(l[re],ee[re])}var D=new Array(c.length),j=[],K=0;c.forEach(($,ee)=>{Mn.hasOwnProperty($)?D[ee]=Mn[$]:(j.push($),Gn.hasOwnProperty($)||(Gn[$]=[]),Gn[$].push(()=>{D[ee]=Mn[$],++K,K===j.length&&T(D)}))}),j.length===0&&T(D)},yi=function(l){l>>>=0;var c=hr[l];delete hr[l];var d=c.rawConstructor,T=c.rawDestructor,D=c.fields,j=D.map(K=>K.getterReturnType).concat(D.map(K=>K.setterArgumentType));Cn([l],j,K=>{var $={};return D.forEach((ee,re)=>{var ce=ee.fieldName,Ae=K[re],ze=ee.getter,gt=ee.getterContext,lt=K[re+D.length],sn=ee.setter,on=ee.setterContext;$[ce]={read:_=>Ae.fromWireType(ze(gt,_)),write:(_,L)=>{var q=[];sn(on,_,lt.toWireType(q,L)),Vn(q)}}}),[{name:c.name,fromWireType:ee=>{var re={};for(var ce in $)re[ce]=$[ce].read(ee);return T(ee),re},toWireType:(ee,re)=>{for(var ce in $)if(!(ce in re))throw new TypeError(`Missing field: "${ce}"`);var Ae=d();for(ce in $)$[ce].write(Ae,re[ce]);return ee!==null&&ee.push(T,Ae),Ae},argPackAdvance:Wt,readValueFromPointer:Kn,destructorFunction:T}]})};function vi(l,c,d,T,D){}var Ti=()=>{for(var l=new Array(256),c=0;c<256;++c)l[c]=String.fromCharCode(c);bs=l},bs,Ze=l=>{for(var c="",d=l;N[d>>>0];)c+=bs[N[d++>>>0]];return c},tn,ke=l=>{throw new tn(l)};function Yn(l,c,d={}){var T=c.name;if(l||ke(`type "${T}" must have a positive integer typeid pointer`),Mn.hasOwnProperty(l)){if(d.ignoreDuplicateRegistrations)return;ke(`Cannot register type '${T}' twice`)}if(Mn[l]=c,delete dr[l],Gn.hasOwnProperty(l)){var D=Gn[l];delete Gn[l],D.forEach(j=>j())}}function Ht(l,c,d={}){if(!("argPackAdvance"in c))throw new TypeError("registerType registeredInstance requires argPackAdvance");return Yn(l,c,d)}var Wt=8;function xi(l,c,d,T){l>>>=0,c>>>=0,c=Ze(c),Ht(l,{name:c,fromWireType:function(D){return!!D},toWireType:function(D,j){return j?d:T},argPackAdvance:Wt,readValueFromPointer:function(D){return this.fromWireType(N[D>>>0])},destructorFunction:null})}var x=l=>({count:l.count,deleteScheduled:l.deleteScheduled,preservePointerOnDelete:l.preservePointerOnDelete,ptr:l.ptr,ptrType:l.ptrType,smartPtr:l.smartPtr,smartPtrType:l.smartPtrType}),E=l=>{function c(d){return d.$$.ptrType.registeredClass.name}ke(c(l)+" instance already deleted")},A=!1,W=l=>{},ie=l=>{l.smartPtr?l.smartPtrType.rawDestructor(l.smartPtr):l.ptrType.registeredClass.rawDestructor(l.ptr)},ae=l=>{l.count.value-=1;var c=l.count.value===0;c&&ie(l)},te=(l,c,d)=>{if(c===d)return l;if(d.baseClass===void 0)return null;var T=te(l,c,d.baseClass);return T===null?null:d.downcast(T)},ye={},J=()=>Object.keys(Fe).length,Ue=()=>{var l=[];for(var c in Fe)Fe.hasOwnProperty(c)&&l.push(Fe[c]);return l},Ce=[],be=()=>{for(;Ce.length;){var l=Ce.pop();l.$$.deleteScheduled=!1,l.delete()}},Le,Oe=l=>{Le=l,Ce.length&&Le&&Le(be)},je=()=>{r.getInheritedInstanceCount=J,r.getLiveInheritedInstances=Ue,r.flushPendingDeletes=be,r.setDelayFunction=Oe},Fe={},xe=(l,c)=>{for(c===void 0&&ke("ptr should not be undefined");l.baseClass;)c=l.upcast(c),l=l.baseClass;return c},Qe=(l,c)=>(c=xe(l,c),Fe[c]),ve=(l,c)=>{(!c.ptrType||!c.ptr)&&pr("makeClassHandle requires ptr and ptrType");var d=!!c.smartPtrType,T=!!c.smartPtr;return d!==T&&pr("Both smartPtrType and smartPtr must be specified"),c.count={value:1},oe(Object.create(l,{$$:{value:c,writable:!0}}))};function Te(l){var c=this.getPointee(l);if(!c)return this.destructor(l),null;var d=Qe(this.registeredClass,c);if(d!==void 0){if(d.$$.count.value===0)return d.$$.ptr=c,d.$$.smartPtr=l,d.clone();var T=d.clone();return this.destructor(l),T}function D(){return this.isSmartPointer?ve(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:c,smartPtrType:this,smartPtr:l}):ve(this.registeredClass.instancePrototype,{ptrType:this,ptr:l})}var j=this.registeredClass.getActualType(c),K=ye[j];if(!K)return D.call(this);var $;this.isConst?$=K.constPointerType:$=K.pointerType;var ee=te(c,this.registeredClass,$.registeredClass);return ee===null?D.call(this):this.isSmartPointer?ve($.registeredClass.instancePrototype,{ptrType:$,ptr:ee,smartPtrType:this,smartPtr:l}):ve($.registeredClass.instancePrototype,{ptrType:$,ptr:ee})}var oe=l=>typeof FinalizationRegistry>"u"?(oe=c=>c,l):(A=new FinalizationRegistry(c=>{ae(c.$$)}),oe=c=>{var d=c.$$,T=!!d.smartPtr;if(T){var D={$$:d};A.register(c,D,c)}return c},W=c=>A.unregister(c),oe(l)),Y=()=>{Object.assign(F.prototype,{isAliasOf(l){if(!(this instanceof F)||!(l instanceof F))return!1;var c=this.$$.ptrType.registeredClass,d=this.$$.ptr;l.$$=l.$$;for(var T=l.$$.ptrType.registeredClass,D=l.$$.ptr;c.baseClass;)d=c.upcast(d),c=c.baseClass;for(;T.baseClass;)D=T.upcast(D),T=T.baseClass;return c===T&&d===D},clone(){if(this.$$.ptr||E(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var l=oe(Object.create(Object.getPrototypeOf(this),{$$:{value:x(this.$$)}}));return l.$$.count.value+=1,l.$$.deleteScheduled=!1,l},delete(){this.$$.ptr||E(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&ke("Object already scheduled for deletion"),W(this),ae(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||E(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&ke("Object already scheduled for deletion"),Ce.push(this),Ce.length===1&&Le&&Le(be),this.$$.deleteScheduled=!0,this}})};function F(){}var H=(l,c)=>Object.defineProperty(c,"name",{value:l}),Q=(l,c,d)=>{if(l[c].overloadTable===void 0){var T=l[c];l[c]=function(...D){return l[c].overloadTable.hasOwnProperty(D.length)||ke(`Function '${d}' called with an invalid number of arguments (${D.length}) - expects one of (${l[c].overloadTable})!`),l[c].overloadTable[D.length].apply(this,D)},l[c].overloadTable=[],l[c].overloadTable[T.argCount]=T}},ue=(l,c,d)=>{r.hasOwnProperty(l)?((d===void 0||r[l].overloadTable!==void 0&&r[l].overloadTable[d]!==void 0)&&ke(`Cannot register public name '${l}' twice`),Q(r,l,l),r.hasOwnProperty(d)&&ke(`Cannot register multiple overloads of a function with the same number of arguments (${d})!`),r[l].overloadTable[d]=c):(r[l]=c,d!==void 0&&(r[l].numArguments=d))},me=48,X=57,ne=l=>{if(l===void 0)return"_unknown";l=l.replace(/[^a-zA-Z0-9_]/g,"$");var c=l.charCodeAt(0);return c>=me&&c<=X?`_${l}`:l};function he(l,c,d,T,D,j,K,$){this.name=l,this.constructor=c,this.instancePrototype=d,this.rawDestructor=T,this.baseClass=D,this.getActualType=j,this.upcast=K,this.downcast=$,this.pureVirtualFunctions=[]}var b=(l,c,d)=>{for(;c!==d;)c.upcast||ke(`Expected null or instance of ${d.name}, got an instance of ${c.name}`),l=c.upcast(l),c=c.baseClass;return l};function z(l,c){if(c===null)return this.isReference&&ke(`null is not a valid ${this.name}`),0;c.$$||ke(`Cannot pass "${_i(c)}" as a ${this.name}`),c.$$.ptr||ke(`Cannot pass deleted object as a pointer of type ${this.name}`);var d=c.$$.ptrType.registeredClass,T=b(c.$$.ptr,d,this.registeredClass);return T}function fe(l,c){var d;if(c===null)return this.isReference&&ke(`null is not a valid ${this.name}`),this.isSmartPointer?(d=this.rawConstructor(),l!==null&&l.push(this.rawDestructor,d),d):0;(!c||!c.$$)&&ke(`Cannot pass "${_i(c)}" as a ${this.name}`),c.$$.ptr||ke(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&c.$$.ptrType.isConst&&ke(`Cannot convert argument of type ${c.$$.smartPtrType?c.$$.smartPtrType.name:c.$$.ptrType.name} to parameter type ${this.name}`);var T=c.$$.ptrType.registeredClass;if(d=b(c.$$.ptr,T,this.registeredClass),this.isSmartPointer)switch(c.$$.smartPtr===void 0&&ke("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:c.$$.smartPtrType===this?d=c.$$.smartPtr:ke(`Cannot convert argument of type ${c.$$.smartPtrType?c.$$.smartPtrType.name:c.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:d=c.$$.smartPtr;break;case 2:if(c.$$.smartPtrType===this)d=c.$$.smartPtr;else{var D=c.clone();d=this.rawShare(d,yt.toHandle(()=>D.delete())),l!==null&&l.push(this.rawDestructor,d)}break;default:ke("Unsupporting sharing policy")}return d}function le(l,c){if(c===null)return this.isReference&&ke(`null is not a valid ${this.name}`),0;c.$$||ke(`Cannot pass "${_i(c)}" as a ${this.name}`),c.$$.ptr||ke(`Cannot pass deleted object as a pointer of type ${this.name}`),c.$$.ptrType.isConst&&ke(`Cannot convert argument of type ${c.$$.ptrType.name} to parameter type ${this.name}`);var d=c.$$.ptrType.registeredClass,T=b(c.$$.ptr,d,this.registeredClass);return T}var _e=()=>{Object.assign(Xe.prototype,{getPointee(l){return this.rawGetPointee&&(l=this.rawGetPointee(l)),l},destructor(l){this.rawDestructor?.(l)},argPackAdvance:Wt,readValueFromPointer:Kn,fromWireType:Te})};function Xe(l,c,d,T,D,j,K,$,ee,re,ce){this.name=l,this.registeredClass=c,this.isReference=d,this.isConst=T,this.isSmartPointer=D,this.pointeeType=j,this.sharingPolicy=K,this.rawGetPointee=$,this.rawConstructor=ee,this.rawShare=re,this.rawDestructor=ce,!D&&c.baseClass===void 0?T?(this.toWireType=z,this.destructorFunction=null):(this.toWireType=le,this.destructorFunction=null):this.toWireType=fe}var pe=(l,c,d)=>{r.hasOwnProperty(l)||pr("Replacing nonexistent public symbol"),r[l].overloadTable!==void 0&&d!==void 0?r[l].overloadTable[d]=c:(r[l]=c,r[l].argCount=d)},Be=(l,c,d)=>{l=l.replace(/p/g,"i");var T=r["dynCall_"+l];return T(c,...d)},De,Pe=l=>De.get(l),Rt=(l,c,d=[])=>{if(l.includes("j"))return Be(l,c,d);var T=Pe(c)(...d);return l[0]=="p"?T>>>0:T},rt=(l,c)=>(...d)=>Rt(l,c,d),ft=(l,c)=>{l=Ze(l);function d(){return l.includes("j")||l.includes("p")?rt(l,c):Pe(c)}var T=d();return typeof T!="function"&&ke(`unknown function pointer with signature ${l}: ${c}`),T},Ee=(l,c)=>{var d=H(c,function(T){this.name=c,this.message=T;var D=new Error(T).stack;D!==void 0&&(this.stack=this.toString()+`
`+D.replace(/^Error(:[^\n]*)?\n/,""))});return d.prototype=Object.create(l.prototype),d.prototype.constructor=d,d.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},d},Xt,Nt=l=>{var c=Ja(l),d=Ze(c);return Dn(c),d},Ot=(l,c)=>{var d=[],T={};function D(j){if(!T[j]&&!Mn[j]){if(dr[j]){dr[j].forEach(D);return}d.push(j),T[j]=!0}}throw c.forEach(D),new Xt(`${l}: `+d.map(Nt).join([", "]))};function nn(l,c,d,T,D,j,K,$,ee,re,ce,Ae,ze){l>>>=0,c>>>=0,d>>>=0,T>>>=0,D>>>=0,j>>>=0,K>>>=0,$>>>=0,ee>>>=0,re>>>=0,ce>>>=0,Ae>>>=0,ze>>>=0,ce=Ze(ce),j=ft(D,j),$&&=ft(K,$),re&&=ft(ee,re),ze=ft(Ae,ze);var gt=ne(ce);ue(gt,function(){Ot(`Cannot construct ${ce} due to unbound types`,[T])}),Cn([l,c,d],T?[T]:[],lt=>{lt=lt[0];var sn,on;T?(sn=lt.registeredClass,on=sn.instancePrototype):on=F.prototype;var _=H(ce,function(...ht){if(Object.getPrototypeOf(this)!==L)throw new tn("Use 'new' to construct "+ce);if(q.constructor_body===void 0)throw new tn(ce+" has no accessible constructor");var Bt=q.constructor_body[ht.length];if(Bt===void 0)throw new tn(`Tried to invoke ctor of ${ce} with invalid number of parameters (${ht.length}) - expected (${Object.keys(q.constructor_body).toString()}) parameters instead!`);return Bt.apply(this,ht)}),L=Object.create(on,{constructor:{value:_}});_.prototype=L;var q=new he(ce,_,L,ze,sn,j,$,re);q.baseClass&&(q.baseClass.__derivedClasses??=[],q.baseClass.__derivedClasses.push(q));var se=new Xe(ce,q,!0,!1,!1),Me=new Xe(ce+"*",q,!1,!1,!1),Ye=new Xe(ce+" const*",q,!1,!0,!1);return ye[l]={pointerType:Me,constPointerType:Ye},pe(gt,_),[se,Me,Ye]})}var It=(l,c)=>{for(var d=[],T=0;T<l;T++)d.push(Z[c+T*4>>>2>>>0]);return d};function zn(l){for(var c=1;c<l.length;++c)if(l[c]!==null&&l[c].destructorFunction===void 0)return!0;return!1}function Nn(l,c){if(!(l instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof l} which is not a function`);var d=H(l.name||"unknownFunctionName",function(){});d.prototype=l.prototype;var T=new d,D=l.apply(T,c);return D instanceof Object?D:T}function wi(l,c,d,T){for(var D=zn(l),j=l.length,K="",$="",ee=0;ee<j-2;++ee)K+=(ee!==0?", ":"")+"arg"+ee,$+=(ee!==0?", ":"")+"arg"+ee+"Wired";var re=`
        return function (${K}) {
        if (arguments.length !== ${j-2}) {
          throwBindingError('function ' + humanName + ' called with ' + arguments.length + ' arguments, expected ${j-2}');
        }`;D&&(re+=`var destructors = [];
`);var ce=D?"destructors":"null",Ae=["humanName","throwBindingError","invoker","fn","runDestructors","retType","classParam"];c&&(re+="var thisWired = classParam['toWireType']("+ce+`, this);
`);for(var ee=0;ee<j-2;++ee)re+="var arg"+ee+"Wired = argType"+ee+"['toWireType']("+ce+", arg"+ee+`);
`,Ae.push("argType"+ee);if(c&&($="thisWired"+($.length>0?", ":"")+$),re+=(d||T?"var rv = ":"")+"invoker(fn"+($.length>0?", ":"")+$+`);
`,D)re+=`runDestructors(destructors);
`;else for(var ee=c?1:2;ee<l.length;++ee){var ze=ee===1?"thisWired":"arg"+(ee-2)+"Wired";l[ee].destructorFunction!==null&&(re+=`${ze}_dtor(${ze});
`,Ae.push(`${ze}_dtor`))}return d&&(re+=`var ret = retType['fromWireType'](rv);
return ret;
`),re+=`}
`,[Ae,re]}function Cr(l,c,d,T,D,j){var K=c.length;K<2&&ke("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var $=c[1]!==null&&d!==null,ee=zn(c),re=c[0].name!=="void",ce=[l,ke,T,D,Vn,c[0],c[1]],Ae=0;Ae<K-2;++Ae)ce.push(c[Ae+2]);if(!ee)for(var Ae=$?1:2;Ae<c.length;++Ae)c[Ae].destructorFunction!==null&&ce.push(c[Ae].destructorFunction);let[ze,gt]=wi(c,$,re,j);ze.push(gt);var lt=Nn(Function,ze)(...ce);return H(l,lt)}var Lf=function(l,c,d,T,D,j){l>>>=0,d>>>=0,T>>>=0,D>>>=0,j>>>=0;var K=It(c,d);D=ft(T,D),Cn([],[l],$=>{$=$[0];var ee=`constructor ${$.name}`;if($.registeredClass.constructor_body===void 0&&($.registeredClass.constructor_body=[]),$.registeredClass.constructor_body[c-1]!==void 0)throw new tn(`Cannot register multiple constructors with identical number of parameters (${c-1}) for class '${$.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return $.registeredClass.constructor_body[c-1]=()=>{Ot(`Cannot construct ${$.name} due to unbound types`,K)},Cn([],K,re=>(re.splice(1,0,null),$.registeredClass.constructor_body[c-1]=Cr(ee,re,null,D,j),[])),[]})},za=l=>{l=l.trim();const c=l.indexOf("(");return c!==-1?l.substr(0,c):l},kf=function(l,c,d,T,D,j,K,$,ee){l>>>=0,c>>>=0,T>>>=0,D>>>=0,j>>>=0,K>>>=0;var re=It(d,T);c=Ze(c),c=za(c),j=ft(D,j),Cn([],[l],ce=>{ce=ce[0];var Ae=`${ce.name}.${c}`;c.startsWith("@@")&&(c=Symbol[c.substring(2)]),$&&ce.registeredClass.pureVirtualFunctions.push(c);function ze(){Ot(`Cannot call ${Ae} due to unbound types`,re)}var gt=ce.registeredClass.instancePrototype,lt=gt[c];return lt===void 0||lt.overloadTable===void 0&&lt.className!==ce.name&&lt.argCount===d-2?(ze.argCount=d-2,ze.className=ce.name,gt[c]=ze):(Q(gt,c,Ae),gt[c].overloadTable[d-2]=ze),Cn([],re,sn=>{var on=Cr(Ae,sn,ce,j,K,ee);return gt[c].overloadTable===void 0?(on.argCount=d-2,gt[c]=on):gt[c].overloadTable[d-2]=on,[]}),[]})},Ei=[],On=[];function bi(l){l>>>=0,l>9&&--On[l+1]===0&&(On[l]=void 0,Ei.push(l))}var jf=()=>On.length/2-5-Ei.length,Bf=()=>{On.push(0,1,void 0,1,null,1,!0,1,!1,1),r.count_emval_handles=jf},yt={toValue:l=>(l||ke("Cannot use deleted val. handle = "+l),On[l]),toHandle:l=>{switch(l){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{const c=Ei.pop()||On.length;return On[c]=l,On[c+1]=1,c}}}},$f={name:"emscripten::val",fromWireType:l=>{var c=yt.toValue(l);return bi(l),c},toWireType:(l,c)=>yt.toHandle(c),argPackAdvance:Wt,readValueFromPointer:Kn,destructorFunction:null};function Ha(l){return l>>>=0,Ht(l,$f)}var Vf=(l,c,d)=>{switch(c){case 1:return d?function(T){return this.fromWireType(w[T>>>0])}:function(T){return this.fromWireType(N[T>>>0])};case 2:return d?function(T){return this.fromWireType(P[T>>>1>>>0])}:function(T){return this.fromWireType(U[T>>>1>>>0])};case 4:return d?function(T){return this.fromWireType(B[T>>>2>>>0])}:function(T){return this.fromWireType(Z[T>>>2>>>0])};default:throw new TypeError(`invalid integer width (${c}): ${l}`)}};function Gf(l,c,d,T){l>>>=0,c>>>=0,d>>>=0,c=Ze(c);function D(){}D.values={},Ht(l,{name:c,constructor:D,fromWireType:function(j){return this.constructor.values[j]},toWireType:(j,K)=>K.value,argPackAdvance:Wt,readValueFromPointer:Vf(c,d,T),destructorFunction:null}),ue(c,D)}var _s=(l,c)=>{var d=Mn[l];return d===void 0&&ke(`${c} has unknown type ${Nt(l)}`),d};function zf(l,c,d){l>>>=0,c>>>=0;var T=_s(l,"enum");c=Ze(c);var D=T.constructor,j=Object.create(T.constructor.prototype,{value:{value:d},constructor:{value:H(`${T.name}_${c}`,function(){})}});D.values[d]=j,D[c]=j}var _i=l=>{if(l===null)return"null";var c=typeof l;return c==="object"||c==="array"||c==="function"?l.toString():""+l},Hf=(l,c)=>{switch(c){case 4:return function(d){return this.fromWireType(Se[d>>>2>>>0])};case 8:return function(d){return this.fromWireType(de[d>>>3>>>0])};default:throw new TypeError(`invalid float width (${c}): ${l}`)}},Wf=function(l,c,d){l>>>=0,c>>>=0,d>>>=0,c=Ze(c),Ht(l,{name:c,fromWireType:T=>T,toWireType:(T,D)=>D,argPackAdvance:Wt,readValueFromPointer:Hf(c,d),destructorFunction:null})};function Xf(l,c,d,T,D,j,K){l>>>=0,d>>>=0,T>>>=0,D>>>=0,j>>>=0;var $=It(c,d);l=Ze(l),l=za(l),D=ft(T,D),ue(l,function(){Ot(`Cannot call ${l} due to unbound types`,$)},c-1),Cn([],$,ee=>{var re=[ee[0],null].concat(ee.slice(1));return pe(l,Cr(l,re,null,D,j,K),c-1),[]})}var qf=(l,c,d)=>{switch(c){case 1:return d?T=>w[T>>>0]:T=>N[T>>>0];case 2:return d?T=>P[T>>>1>>>0]:T=>U[T>>>1>>>0];case 4:return d?T=>B[T>>>2>>>0]:T=>Z[T>>>2>>>0];default:throw new TypeError(`invalid integer width (${c}): ${l}`)}};function Kf(l,c,d,T,D){l>>>=0,c>>>=0,d>>>=0,c=Ze(c);var j=ce=>ce;if(T===0){var K=32-8*d;j=ce=>ce<<K>>>K}var $=c.includes("unsigned"),ee=(ce,Ae)=>{},re;$?re=function(ce,Ae){return ee(Ae,this.name),Ae>>>0}:re=function(ce,Ae){return ee(Ae,this.name),Ae},Ht(l,{name:c,fromWireType:j,toWireType:re,argPackAdvance:Wt,readValueFromPointer:qf(c,d,T!==0),destructorFunction:null})}function Yf(l,c,d){l>>>=0,d>>>=0;var T=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],D=T[c];function j(K){var $=Z[K>>>2>>>0],ee=Z[K+4>>>2>>>0];return new D(w.buffer,ee,$)}d=Ze(d),Ht(l,{name:d,fromWireType:j,argPackAdvance:Wt,readValueFromPointer:j},{ignoreDuplicateRegistrations:!0})}function Jf(l,c){l>>>=0,Ha(l)}var Zf=(l,c,d,T)=>{if(d>>>=0,!(T>0))return 0;for(var D=d,j=d+T-1,K=0;K<l.length;++K){var $=l.charCodeAt(K);if($>=55296&&$<=57343){var ee=l.charCodeAt(++K);$=65536+(($&1023)<<10)|ee&1023}if($<=127){if(d>=j)break;c[d++>>>0]=$}else if($<=2047){if(d+1>=j)break;c[d++>>>0]=192|$>>6,c[d++>>>0]=128|$&63}else if($<=65535){if(d+2>=j)break;c[d++>>>0]=224|$>>12,c[d++>>>0]=128|$>>6&63,c[d++>>>0]=128|$&63}else{if(d+3>=j)break;c[d++>>>0]=240|$>>18,c[d++>>>0]=128|$>>12&63,c[d++>>>0]=128|$>>6&63,c[d++>>>0]=128|$&63}}return c[d>>>0]=0,d-D},Qf=(l,c,d)=>Zf(l,N,c,d),eh=l=>{for(var c=0,d=0;d<l.length;++d){var T=l.charCodeAt(d);T<=127?c++:T<=2047?c+=2:T>=55296&&T<=57343?(c+=4,++d):c+=3}return c},Wa=typeof TextDecoder<"u"?new TextDecoder:void 0,th=(l,c,d)=>{c>>>=0;for(var T=c+d,D=c;l[D]&&!(D>=T);)++D;if(D-c>16&&l.buffer&&Wa)return Wa.decode(l.subarray(c,D));for(var j="";c<D;){var K=l[c++];if(!(K&128)){j+=String.fromCharCode(K);continue}var $=l[c++]&63;if((K&224)==192){j+=String.fromCharCode((K&31)<<6|$);continue}var ee=l[c++]&63;if((K&240)==224?K=(K&15)<<12|$<<6|ee:K=(K&7)<<18|$<<12|ee<<6|l[c++]&63,K<65536)j+=String.fromCharCode(K);else{var re=K-65536;j+=String.fromCharCode(55296|re>>10,56320|re&1023)}}return j},nh=(l,c)=>(l>>>=0,l?th(N,l,c):"");function rh(l,c){l>>>=0,c>>>=0,c=Ze(c);var d=c==="std::string";Ht(l,{name:c,fromWireType(T){var D=Z[T>>>2>>>0],j=T+4,K;if(d)for(var $=j,ee=0;ee<=D;++ee){var re=j+ee;if(ee==D||N[re>>>0]==0){var ce=re-$,Ae=nh($,ce);K===void 0?K=Ae:(K+="\0",K+=Ae),$=re+1}}else{for(var ze=new Array(D),ee=0;ee<D;++ee)ze[ee]=String.fromCharCode(N[j+ee>>>0]);K=ze.join("")}return Dn(T),K},toWireType(T,D){D instanceof ArrayBuffer&&(D=new Uint8Array(D));var j,K=typeof D=="string";K||D instanceof Uint8Array||D instanceof Uint8ClampedArray||D instanceof Int8Array||ke("Cannot pass non-string to std::string"),d&&K?j=eh(D):j=D.length;var $=Ai(4+j+1),ee=$+4;if(Z[$>>>2>>>0]=j,d&&K)Qf(D,ee,j+1);else if(K)for(var re=0;re<j;++re){var ce=D.charCodeAt(re);ce>255&&(Dn(ee),ke("String has UTF-16 code units that do not fit in 8 bits")),N[ee+re>>>0]=ce}else for(var re=0;re<j;++re)N[ee+re>>>0]=D[re];return T!==null&&T.push(Dn,$),$},argPackAdvance:Wt,readValueFromPointer:Kn,destructorFunction(T){Dn(T)}})}var Xa=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,sh=(l,c)=>{for(var d=l,T=d>>1,D=T+c/2;!(T>=D)&&U[T>>>0];)++T;if(d=T<<1,d-l>32&&Xa)return Xa.decode(N.subarray(l>>>0,d>>>0));for(var j="",K=0;!(K>=c/2);++K){var $=P[l+K*2>>>1>>>0];if($==0)break;j+=String.fromCharCode($)}return j},ih=(l,c,d)=>{if(d??=2147483647,d<2)return 0;d-=2;for(var T=c,D=d<l.length*2?d/2:l.length,j=0;j<D;++j){var K=l.charCodeAt(j);P[c>>>1>>>0]=K,c+=2}return P[c>>>1>>>0]=0,c-T},oh=l=>l.length*2,ah=(l,c)=>{for(var d=0,T="";!(d>=c/4);){var D=B[l+d*4>>>2>>>0];if(D==0)break;if(++d,D>=65536){var j=D-65536;T+=String.fromCharCode(55296|j>>10,56320|j&1023)}else T+=String.fromCharCode(D)}return T},lh=(l,c,d)=>{if(c>>>=0,d??=2147483647,d<4)return 0;for(var T=c,D=T+d-4,j=0;j<l.length;++j){var K=l.charCodeAt(j);if(K>=55296&&K<=57343){var $=l.charCodeAt(++j);K=65536+((K&1023)<<10)|$&1023}if(B[c>>>2>>>0]=K,c+=4,c+4>D)break}return B[c>>>2>>>0]=0,c-T},ch=l=>{for(var c=0,d=0;d<l.length;++d){var T=l.charCodeAt(d);T>=55296&&T<=57343&&++d,c+=4}return c},uh=function(l,c,d){l>>>=0,c>>>=0,d>>>=0,d=Ze(d);var T,D,j,K;c===2?(T=sh,D=ih,K=oh,j=$=>U[$>>>1>>>0]):c===4&&(T=ah,D=lh,K=ch,j=$=>Z[$>>>2>>>0]),Ht(l,{name:d,fromWireType:$=>{for(var ee=Z[$>>>2>>>0],re,ce=$+4,Ae=0;Ae<=ee;++Ae){var ze=$+4+Ae*c;if(Ae==ee||j(ze)==0){var gt=ze-ce,lt=T(ce,gt);re===void 0?re=lt:(re+="\0",re+=lt),ce=ze+c}}return Dn($),re},toWireType:($,ee)=>{typeof ee!="string"&&ke(`Cannot pass non-string to C++ string type ${d}`);var re=K(ee),ce=Ai(4+re+c);return Z[ce>>>2>>>0]=re/c,D(ee,ce+4,re+c),$!==null&&$.push(Dn,ce),ce},argPackAdvance:Wt,readValueFromPointer:Kn,destructorFunction($){Dn($)}})};function fh(l,c,d,T,D,j){l>>>=0,c>>>=0,d>>>=0,T>>>=0,D>>>=0,j>>>=0,hr[l]={name:Ze(c),rawConstructor:ft(d,T),rawDestructor:ft(D,j),fields:[]}}function hh(l,c,d,T,D,j,K,$,ee,re){l>>>=0,c>>>=0,d>>>=0,T>>>=0,D>>>=0,j>>>=0,K>>>=0,$>>>=0,ee>>>=0,re>>>=0,hr[l].fields.push({fieldName:Ze(c),getterReturnType:d,getter:ft(T,D),getterContext:j,setterArgumentType:K,setter:ft($,ee),setterContext:re})}var dh=function(l,c){l>>>=0,c>>>=0,c=Ze(c),Ht(l,{isVoid:!0,name:c,argPackAdvance:0,fromWireType:()=>{},toWireType:(d,T)=>{}})};function ph(l,c,d){return l>>>=0,c>>>=0,d>>>=0,N.copyWithin(l>>>0,c>>>0,c+d>>>0)}var qa=(l,c,d)=>{var T=[],D=l.toWireType(T,d);return T.length&&(Z[c>>>2>>>0]=yt.toHandle(T)),D};function gh(l,c,d){return l>>>=0,c>>>=0,d>>>=0,l=yt.toValue(l),c=_s(c,"emval::as"),qa(c,d,l)}var mh={},Ka=l=>{var c=mh[l];return c===void 0?Ze(l):c},Ri=[];function yh(l,c,d,T,D){return l>>>=0,c>>>=0,d>>>=0,T>>>=0,D>>>=0,l=Ri[l],c=yt.toValue(c),d=Ka(d),l(c,c[d],T,D)}function vh(l,c){return l>>>=0,c>>>=0,l=yt.toValue(l),c=yt.toValue(c),l==c}var Th=l=>{var c=Ri.length;return Ri.push(l),c},xh=(l,c)=>{for(var d=new Array(l),T=0;T<l;++T)d[T]=_s(Z[c+T*4>>>2>>>0],"parameter "+T);return d};function wh(l,c,d){c>>>=0;var T=xh(l,c),D=T.shift();l--;var j=`return function (obj, func, destructorsRef, args) {
`,K=0,$=[];d===0&&$.push("obj");for(var ee=["retType"],re=[D],ce=0;ce<l;++ce)$.push("arg"+ce),ee.push("argType"+ce),re.push(T[ce]),j+=`  var arg${ce} = argType${ce}.readValueFromPointer(args${K?"+"+K:""});
`,K+=T[ce].argPackAdvance;var Ae=d===1?"new func":"func.call";j+=`  var rv = ${Ae}(${$.join(", ")});
`,D.isVoid||(ee.push("emval_returnValue"),re.push(qa),j+=`  return emval_returnValue(retType, destructorsRef, rv);
`),j+=`};
`,ee.push(j);var ze=Nn(Function,ee)(...re),gt=`methodCaller<(${T.map(lt=>lt.name).join(", ")}) => ${D.name}>`;return Th(H(gt,ze))}function Eh(l,c){return l>>>=0,c>>>=0,l=yt.toValue(l),c=yt.toValue(c),yt.toHandle(l[c])}function bh(l){l>>>=0,l>9&&(On[l+1]+=1)}function _h(l){return l>>>=0,yt.toHandle(Ka(l))}function Rh(){return yt.toHandle({})}function Ih(l){l>>>=0;var c=yt.toValue(l);Vn(c),bi(l)}function Sh(l,c,d){l>>>=0,c>>>=0,d>>>=0,l=yt.toValue(l),c=yt.toValue(c),d=yt.toValue(d),l[c]=d}function Ah(l,c){l>>>=0,c>>>=0,l=_s(l,"_emval_take_value");var d=l.readValueFromPointer(c);return yt.toHandle(d)}var Mh=()=>4294901760,Ch=l=>{var c=G.buffer,d=(l-c.byteLength+65535)/65536;try{return G.grow(d),we(),1}catch{}};function Nh(l){l>>>=0;var c=N.length,d=Mh();if(l>d)return!1;for(var T=(ee,re)=>ee+(re-ee%re)%re,D=1;D<=4;D*=2){var j=c*(1+.2/D);j=Math.min(j,l+100663296);var K=Math.min(d,T(Math.max(l,j),65536)),$=Ch(K);if($)return!0}return!1}var Ya=(l,c)=>{l<128?c.push(l):c.push(l%128|128,l>>7)},Oh=l=>{for(var c={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},d={parameters:[],results:l[0]=="v"?[]:[c[l[0]]]},T=1;T<l.length;++T)d.parameters.push(c[l[T]]);return d},Dh=(l,c)=>{var d=l.slice(0,1),T=l.slice(1),D={i:127,p:127,j:126,f:125,d:124,e:111};c.push(96),Ya(T.length,c);for(var j=0;j<T.length;++j)c.push(D[T[j]]);d=="v"?c.push(0):c.push(1,D[d])},Ph=(l,c)=>{if(typeof WebAssembly.Function=="function")return new WebAssembly.Function(Oh(c),l);var d=[1];Dh(c,d);var T=[0,97,115,109,1,0,0,0,1];Ya(d.length,T),T.push(...d),T.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var D=new WebAssembly.Module(new Uint8Array(T)),j=new WebAssembly.Instance(D,{e:{f:l}}),K=j.exports.f;return K},Fh=(l,c)=>{if(Jn)for(var d=l;d<l+c;d++){var T=Pe(d);T&&Jn.set(T,d)}},Jn,Uh=l=>(Jn||(Jn=new WeakMap,Fh(0,De.length)),Jn.get(l)||0),Ii=[],Lh=()=>{if(Ii.length)return Ii.pop();try{De.grow(1)}catch(l){throw l instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":l}return De.length-1},Si=(l,c)=>De.set(l,c),Nr=(l,c)=>{var d=Uh(l);if(d)return d;var T=Lh();try{Si(T,l)}catch(j){if(!(j instanceof TypeError))throw j;var D=Ph(l,c);Si(T,D)}return Jn.set(l,T),T},Or=l=>{Jn.delete(Pe(l)),Si(l,null),Ii.push(l)};Es=r.InternalError=class extends Error{constructor(c){super(c),this.name="InternalError"}},Ti(),tn=r.BindingError=class extends Error{constructor(c){super(c),this.name="BindingError"}},Y(),je(),_e(),Xt=r.UnboundTypeError=Ee(Error,"UnboundTypeError"),Bf();var kh={g:fr,D:mi,n:yi,C:vi,H:xi,i:nn,h:Lf,a:kf,G:Ha,u:Gf,e:zf,x:Wf,c:Xf,j:Kf,f:Yf,k:Jf,w:rh,t:uh,o:fh,m:hh,I:dh,F:ph,s:gh,z:yh,b:bi,l:vh,y:wh,B:Eh,v:bh,q:_h,A:Rh,p:Ih,r:Sh,d:Ah,E:Nh},rn=An(),Ja=l=>(Ja=rn.L)(l),Ai=l=>(Ai=rn.N)(l),Dn=l=>(Dn=rn.O)(l),Za=l=>(Za=rn.P)(l);function jh(l){l=Object.assign({},l);var c=T=>D=>T(D)>>>0,d=T=>()=>T()>>>0;return l.L=c(l.L),l.N=c(l.N),l._emscripten_stack_alloc=c(l._emscripten_stack_alloc),l.emscripten_stack_get_current=d(l.emscripten_stack_get_current),l}r.addFunction=Nr,r.removeFunction=Or;var Rs;O=function l(){Rs||Qa(),Rs||(O=l)};function Qa(){if(Ge>0||(wt(),Ge>0))return;function l(){Rs||(Rs=!0,r.calledRun=!0,!v&&(Pt(),s(r),r.onRuntimeInitialized?.(),at()))}r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),l()},1)):l()}if(r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return Qa(),n=o,n})})(),sa=xl}});function fd(e){ts=e}async function hd(){let e=null;return typeof ts=="string"&&ts?e=await sa({locateFile:()=>ts}):e=await sa(),e.setup(),e}async function Gc(){return es||(es=await hd()),es}function Rn(){return es}var es,ts,Ar=ut({"lib/wasm.ts"(){ud(),es=null,ts=null}});function wl(){return Ws}function zc(){Ws.length=0}async function Hc(e){if(Array.isArray(e))return await e.map(Hc).reduce(async(t,n)=>[...await t,...await n],new Promise(t=>t([])));if(e instanceof Jr)return[e];if(e.constructor.name==="Manifold"){const t=new sr;return t.manifold=e,[t]}else if(e.constructor.name==="CrossSection"){const t=new ir;return t.crossSection=e,[t]}throw new Error("Cannot convert model to GLTFNode!")}var Ws,Jr,sr,Wc,ei,ir,Xc,lr=ut({"lib/gltf-node.ts"(){Ar(),Ws=new Array,Jr=class{_parent;name;translation;rotation;scale;constructor(e){this._parent=e}get parent(){return this._parent}isEmpty(){return!0}},sr=class qc extends Jr{manifold;material;clone(t){const n=new qc(t??this.parent);return Object.assign(n,this),n}isEmpty(){return this.manifold?.isEmpty()??!0}},Wc=class Kc extends sr{constructor(t){super(t),Ws.push(this)}clone(t){const n=new Kc(t??this.parent);return Object.assign(n,this),n}},ei=class Yc extends Jr{node;document;uri;constructor(t){super(t)}clone(t){const n=new Yc(t??this.parent);return Object.assign(n,this),n}isEmpty(){return!this.document}},ir=class Jc extends Jr{crossSection;material;_runid;constructor(t){super(t)}clone(t){const n=new Jc(t??this.parent);return Object.assign(n,this),n}isEmpty(){return this.crossSection?.isEmpty()??!0}get runID(){return this._runid===void 0&&(this._runid=Rn().Manifold.reserveIDs(1)),this._runid}},Xc=()=>{zc()}}});function ti(e){const[t,n,r]=e.map(a=>Zc(a*ia/360)),[s,i,o]=e.map(a=>Qc(a*ia/360));return[s*n*r-t*i*o,t*i*r+s*n*o,t*n*o-s*i*r,t*n*r+s*i*o]}function dd(e,t){const[n,r,s,i]=e,[o,a,u,f]=t;return[n*f+i*o+r*u-s*a,r*f+i*a+s*o-n*u,s*f+i*u+n*a-r*o,i*f-n*o-r*a-s*u]}var Zc,Qc,pd,ia,Aa=ut({"lib/math.ts"(){({cos:Zc,sin:Qc,sqrt:pd,PI:ia}=Math)}});function gd(e){Mr=e}function md(){return Mr}function yd(e){Rr=e}function vd(){return Rr}function Td(e){gs=e}function xd(){return gs}function wd(){qn.clear(),Mr="loop",Rr=1,gs=30}function Xi(e,t,n,r){const s=n[t];if(s==null)return null;if(typeof s!="function")return s;const i=us.getCount(),o=t=="rotation"?4:3,a=new Float32Array(o*i);for(let y=0;y<i;++y){const g=y/(i-1),p=s(Mr!=="ping-pong"?g:(1-Math.cos(g*2*Math.PI))/2);a.set(o===4?ti(p):p,o*y)}const u=e.createAccessor(n.name+" "+t+" frames").setBuffer(e.getRoot().listBuffers()[0]).setArray(a).setType(o===4?ge.Type.VEC4:ge.Type.VEC3),f=e.createAnimationSampler().setInput(us).setOutput(u).setInterpolation("LINEAR"),m=e.createAnimationChannel().setTargetPath(t).setTargetNode(r).setSampler(f);return Ir.addSampler(f),Ir.addChannel(m),ni=!0,s(0)}function Ed(e,t,n){if(qn.has(n)){const r=e.createAnimationChannel().setTargetPath("weights").setTargetNode(t).setSampler(Xs);Ir.addChannel(r),ni=!0}}function bd(e,t){const n=[];if(t==null)return n;for(let r=0;r<e.numVert;++r)for(let s=0;s<3;++s)n[r*3+s]=e.vertProperties[r*e.numProp+s];if(t.start)for(let r=0;r<e.numVert;++r){const s=e.vertProperties,i=r*e.numProp,o=n.slice(i,i+3);t.start(o);for(let a=0;a<3;++a)s[i+a]=o[a]}return n}function _d(e,t,n,r,s){s!=null&&(n.setWeights([0]),n.listPrimitives().forEach((i,o)=>{if(s.end)for(let g=0;g<t.numVert;++g){const p=r.slice(3*g,3*(g+1));s.end(p),r.splice(3*g,3,...p)}const a=i.getAttribute("POSITION").getArray(),u=new Float32Array(a.length),f=t.runIndex[o];for(let g=0;g<u.length;++g)u[g]=r[f+g]-a[g];const m=e.createAccessor(n.getName()+" morph target").setBuffer(e.getRoot().listBuffers()[0]).setArray(u).setType(ge.Type.VEC3),y=e.createPrimitiveTarget().setAttribute("POSITION",m);i.addTarget(y)}))}function Rd(e,t){const n=qn.get(e);n!=null?n.start=t:qn.set(e,{start:t})}function Id(e,t){const n=qn.get(e);n!=null?n.end=t:qn.set(e,{end:t})}function Sd(e){const t=e.getRoot().listBuffers()[0];Ir=e.createAnimation(""),ni=!1;const n=Math.round(Rr*gs)+1,r=new Float32Array(n),s=new Float32Array(n);for(let i=0;i<n;++i){const o=i/(n-1);r[i]=o*Rr,s[i]=Mr!=="ping-pong"?o:(1-Math.cos(o*2*Math.PI))/2}us=e.createAccessor("animation times").setBuffer(t).setArray(r).setType(ge.Type.SCALAR),oa=e.createAccessor("animation weights").setBuffer(t).setArray(s).setType(ge.Type.SCALAR),Xs=e.createAnimationSampler().setInput(us).setOutput(oa).setInterpolation("LINEAR"),Ir.addSampler(Xs)}function Ad(){ni||(us.dispose(),oa.dispose(),Xs.dispose(),Ir.dispose())}var Mr,Rr,gs,qn,Ir,us,oa,Xs,ni,eu,ri=ut({"lib/animation.ts"(){ar(),lr(),Aa(),Mr="loop",Rr=1,gs=30,qn=new Map,eu=e=>qn.get(e)}}),tu=Sr({"node_modules/@jridgewell/resolve-uri/dist/resolve-uri.umd.js"(e,t){(function(n,r){typeof e=="object"&&typeof t<"u"?t.exports=r():typeof define=="function"&&define.amd?define(r):(n=typeof globalThis<"u"?globalThis:n||self,n.resolveURI=r())})(e,(function(){const n=/^[\w+.-]+:\/\//,r=/^([\w+.-]+:)\/\/([^@/#?]*@)?([^:/#?]*)(:\d+)?(\/[^#?]*)?(\?[^#]*)?(#.*)?/,s=/^file:(?:\/\/((?![a-z]:)[^/#?]*)?)?(\/?[^#?]*)(\?[^#]*)?(#.*)?/i;function i(I){return n.test(I)}function o(I){return I.startsWith("//")}function a(I){return I.startsWith("/")}function u(I){return I.startsWith("file:")}function f(I){return/^[.?#]/.test(I)}function m(I){const C=r.exec(I);return g(C[1],C[2]||"",C[3],C[4]||"",C[5]||"/",C[6]||"",C[7]||"")}function y(I){const C=s.exec(I),S=C[2];return g("file:","",C[1]||"","",a(S)?S:"/"+S,C[3]||"",C[4]||"")}function g(I,C,S,G,v,w,N){return{scheme:I,user:C,host:S,port:G,path:v,query:w,hash:N,type:7}}function p(I){if(o(I)){const S=m("http:"+I);return S.scheme="",S.type=6,S}if(a(I)){const S=m("http://foo.com"+I);return S.scheme="",S.host="",S.type=5,S}if(u(I))return y(I);if(i(I))return m(I);const C=m("http://foo.com/"+I);return C.scheme="",C.host="",C.type=I?I.startsWith("?")?3:I.startsWith("#")?2:4:1,C}function M(I){if(I.endsWith("/.."))return I;const C=I.lastIndexOf("/");return I.slice(0,C+1)}function R(I,C){h(C,C.type),I.path==="/"?I.path=C.path:I.path=M(C.path)+I.path}function h(I,C){const S=C<=4,G=I.path.split("/");let v=1,w=0,N=!1;for(let U=1;U<G.length;U++){const B=G[U];if(!B){N=!0;continue}if(N=!1,B!=="."){if(B===".."){w?(N=!0,w--,v--):S&&(G[v++]=B);continue}G[v++]=B,w++}}let P="";for(let U=1;U<v;U++)P+="/"+G[U];(!P||N&&!P.endsWith("/.."))&&(P+="/"),I.path=P}function V(I,C){if(!I&&!C)return"";const S=p(I);let G=S.type;if(C&&G!==7){const w=p(C),N=w.type;switch(G){case 1:S.hash=w.hash;case 2:S.query=w.query;case 3:case 4:R(S,w);case 5:S.user=w.user,S.host=w.host,S.port=w.port;case 6:S.scheme=w.scheme}N>G&&(G=N)}h(S,G);const v=S.query+S.hash;switch(G){case 2:case 3:return v;case 4:{const w=S.path.slice(1);return w?f(C||I)&&!f(w)?"./"+w+v:w+v:v||"."}case 5:return S.path+v;default:return S.scheme+"//"+S.user+S.host+S.port+S.path+v}}return V}))}}),Md=Sr({"node_modules/esbuild-wasm/lib/browser.js"(e,t){(n=>{var r=Object.defineProperty,s=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,o=Object.prototype.hasOwnProperty,a=(x,E)=>{for(var A in E)r(x,A,{get:E[A],enumerable:!0})},u=(x,E,A,W)=>{if(E&&typeof E=="object"||typeof E=="function")for(let ie of i(E))!o.call(x,ie)&&ie!==A&&r(x,ie,{get:()=>E[ie],enumerable:!(W=s(E,ie))||W.enumerable});return x},f=x=>u(r({},"__esModule",{value:!0}),x),m=(x,E,A)=>new Promise((W,ie)=>{var ae=J=>{try{ye(A.next(J))}catch(Ue){ie(Ue)}},te=J=>{try{ye(A.throw(J))}catch(Ue){ie(Ue)}},ye=J=>J.done?W(J.value):Promise.resolve(J.value).then(ae,te);ye((A=A.apply(x,E)).next())}),y={};a(y,{analyzeMetafile:()=>pr,analyzeMetafileSync:()=>Ti,build:()=>Gn,buildSync:()=>Cn,context:()=>Mn,default:()=>xi,formatMessages:()=>Es,formatMessagesSync:()=>vi,initialize:()=>Ht,stop:()=>bs,transform:()=>dr,transformSync:()=>yi,version:()=>Kn}),n.exports=f(y);function g(x){let E=W=>{if(W===null)A.write8(0);else if(typeof W=="boolean")A.write8(1),A.write8(+W);else if(typeof W=="number")A.write8(2),A.write32(W|0);else if(typeof W=="string")A.write8(3),A.write(R(W));else if(W instanceof Uint8Array)A.write8(4),A.write(W);else if(W instanceof Array){A.write8(5),A.write32(W.length);for(let ie of W)E(ie)}else{let ie=Object.keys(W);A.write8(6),A.write32(ie.length);for(let ae of ie)A.write(R(ae)),E(W[ae])}},A=new M;return A.write32(0),A.write32(x.id<<1|+!x.isRequest),E(x.value),C(A.buf,A.len-4,0),A.buf.subarray(0,A.len)}function p(x){let E=()=>{switch(A.read8()){case 0:return null;case 1:return!!A.read8();case 2:return A.read32();case 3:return h(A.read());case 4:return A.read();case 5:{let te=A.read32(),ye=[];for(let J=0;J<te;J++)ye.push(E());return ye}case 6:{let te=A.read32(),ye={};for(let J=0;J<te;J++)ye[h(A.read())]=E();return ye}default:throw new Error("Invalid packet")}},A=new M(x),W=A.read32(),ie=(W&1)===0;W>>>=1;let ae=E();if(A.ptr!==x.length)throw new Error("Invalid packet");return{id:W,isRequest:ie,value:ae}}var M=class{constructor(x=new Uint8Array(1024)){this.buf=x,this.len=0,this.ptr=0}_write(x){if(this.len+x>this.buf.length){let E=new Uint8Array((this.len+x)*2);E.set(this.buf),this.buf=E}return this.len+=x,this.len-x}write8(x){let E=this._write(1);this.buf[E]=x}write32(x){let E=this._write(4);C(this.buf,x,E)}write(x){let E=this._write(4+x.length);C(this.buf,x.length,E),this.buf.set(x,E+4)}_read(x){if(this.ptr+x>this.buf.length)throw new Error("Invalid packet");return this.ptr+=x,this.ptr-x}read8(){return this.buf[this._read(1)]}read32(){return I(this.buf,this._read(4))}read(){let x=this.read32(),E=new Uint8Array(x),A=this._read(E.length);return E.set(this.buf.subarray(A,A+x)),E}},R,h,V;if(typeof TextEncoder<"u"&&typeof TextDecoder<"u"){let x=new TextEncoder,E=new TextDecoder;R=A=>x.encode(A),h=A=>E.decode(A),V='new TextEncoder().encode("")'}else if(typeof Buffer<"u")R=x=>Buffer.from(x),h=x=>{let{buffer:E,byteOffset:A,byteLength:W}=x;return Buffer.from(E,A,W).toString()},V='Buffer.from("")';else throw new Error("No UTF-8 codec found");if(!(R("")instanceof Uint8Array))throw new Error(`Invariant violation: "${V} instanceof Uint8Array" is incorrectly false

This indicates that your JavaScript environment is broken. You cannot use
esbuild in this environment because esbuild relies on this invariant. This
is not a problem with esbuild. You need to fix your environment instead.
`);function I(x,E){return x[E++]|x[E++]<<8|x[E++]<<16|x[E++]<<24}function C(x,E,A){x[A++]=E,x[A++]=E>>8,x[A++]=E>>16,x[A++]=E>>24}var S=JSON.stringify,G="warning",v="silent";function w(x,E){const A=[];for(const W of x){if($e(W,E),W.indexOf(",")>=0)throw new Error(`Invalid ${E}: ${W}`);A.push(W)}return A.join(",")}var N=()=>null,P=x=>typeof x=="boolean"?null:"a boolean",U=x=>typeof x=="string"?null:"a string",B=x=>x instanceof RegExp?null:"a RegExp object",Z=x=>typeof x=="number"&&x===(x|0)?null:"an integer",Se=x=>typeof x=="number"&&x===(x|0)&&x>=0&&x<=65535?null:"a valid port number",de=x=>typeof x=="function"?null:"a function",we=x=>Array.isArray(x)?null:"an array",Re=x=>Array.isArray(x)&&x.every(E=>typeof E=="string")?null:"an array of strings",Ie=x=>typeof x=="object"&&x!==null&&!Array.isArray(x)?null:"an object",Ve=x=>typeof x=="object"&&x!==null?null:"an array or an object",wt=x=>x instanceof WebAssembly.Module?null:"a WebAssembly.Module",Pt=x=>typeof x=="object"&&!Array.isArray(x)?null:"an object or null",at=x=>typeof x=="string"||typeof x=="boolean"?null:"a string or a boolean",Ft=x=>typeof x=="string"||typeof x=="object"&&x!==null&&!Array.isArray(x)?null:"a string or an object",dt=x=>typeof x=="string"||Array.isArray(x)&&x.every(E=>typeof E=="string")?null:"a string or an array of strings",pt=x=>typeof x=="string"||x instanceof Uint8Array?null:"a string or a Uint8Array",Ge=x=>typeof x=="string"||x instanceof URL?null:"a string or a URL";function O(x,E,A,W){let ie=x[A];if(E[A+""]=!0,ie===void 0)return;let ae=W(ie);if(ae!==null)throw new Error(`${S(A)} must be ${ae}`);return ie}function qe(x,E,A){for(let W in x)if(!(W in E))throw new Error(`Invalid option ${A}: ${S(W)}`)}function In(x){let E=Object.create(null),A=O(x,E,"wasmURL",Ge),W=O(x,E,"wasmModule",wt),ie=O(x,E,"worker",P);return qe(x,E,"in initialize() call"),{wasmURL:A,wasmModule:W,worker:ie}}function Lt(x){let E;if(x!==void 0){E=Object.create(null);for(let A in x){let W=x[A];if(typeof W=="string"||W===!1)E[A]=W;else throw new Error(`Expected ${S(A)} in mangle cache to map to either a string or false`)}}return E}function nt(x,E,A,W,ie){let ae=O(E,A,"color",P),te=O(E,A,"logLevel",U),ye=O(E,A,"logLimit",Z);ae!==void 0?x.push(`--color=${ae}`):W&&x.push("--color=true"),x.push(`--log-level=${te||ie}`),x.push(`--log-limit=${ye||0}`)}function $e(x,E,A){if(typeof x!="string")throw new Error(`Expected value for ${E}${A!==void 0?" "+S(A):""} to be a string, got ${typeof x} instead`);return x}function Ct(x,E,A){let W=O(E,A,"legalComments",U),ie=O(E,A,"sourceRoot",U),ae=O(E,A,"sourcesContent",P),te=O(E,A,"target",dt),ye=O(E,A,"format",U),J=O(E,A,"globalName",U),Ue=O(E,A,"mangleProps",B),Ce=O(E,A,"reserveProps",B),be=O(E,A,"mangleQuoted",P),Le=O(E,A,"minify",P),Oe=O(E,A,"minifySyntax",P),je=O(E,A,"minifyWhitespace",P),Fe=O(E,A,"minifyIdentifiers",P),xe=O(E,A,"lineLimit",Z),Qe=O(E,A,"drop",Re),ve=O(E,A,"dropLabels",Re),Te=O(E,A,"charset",U),oe=O(E,A,"treeShaking",P),Y=O(E,A,"ignoreAnnotations",P),F=O(E,A,"jsx",U),H=O(E,A,"jsxFactory",U),Q=O(E,A,"jsxFragment",U),ue=O(E,A,"jsxImportSource",U),me=O(E,A,"jsxDev",P),X=O(E,A,"jsxSideEffects",P),ne=O(E,A,"define",Ie),he=O(E,A,"logOverride",Ie),b=O(E,A,"supported",Ie),z=O(E,A,"pure",Re),fe=O(E,A,"keepNames",P),le=O(E,A,"platform",U),_e=O(E,A,"tsconfigRaw",Ft),Xe=O(E,A,"absPaths",Re);if(W&&x.push(`--legal-comments=${W}`),ie!==void 0&&x.push(`--source-root=${ie}`),ae!==void 0&&x.push(`--sources-content=${ae}`),te&&x.push(`--target=${w(Array.isArray(te)?te:[te],"target")}`),ye&&x.push(`--format=${ye}`),J&&x.push(`--global-name=${J}`),le&&x.push(`--platform=${le}`),_e&&x.push(`--tsconfig-raw=${typeof _e=="string"?_e:JSON.stringify(_e)}`),Le&&x.push("--minify"),Oe&&x.push("--minify-syntax"),je&&x.push("--minify-whitespace"),Fe&&x.push("--minify-identifiers"),xe&&x.push(`--line-limit=${xe}`),Te&&x.push(`--charset=${Te}`),oe!==void 0&&x.push(`--tree-shaking=${oe}`),Y&&x.push("--ignore-annotations"),Qe)for(let pe of Qe)x.push(`--drop:${$e(pe,"drop")}`);if(ve&&x.push(`--drop-labels=${w(ve,"drop label")}`),Xe&&x.push(`--abs-paths=${w(Xe,"abs paths")}`),Ue&&x.push(`--mangle-props=${Vn(Ue)}`),Ce&&x.push(`--reserve-props=${Vn(Ce)}`),be!==void 0&&x.push(`--mangle-quoted=${be}`),F&&x.push(`--jsx=${F}`),H&&x.push(`--jsx-factory=${H}`),Q&&x.push(`--jsx-fragment=${Q}`),ue&&x.push(`--jsx-import-source=${ue}`),me&&x.push("--jsx-dev"),X&&x.push("--jsx-side-effects"),ne)for(let pe in ne){if(pe.indexOf("=")>=0)throw new Error(`Invalid define: ${pe}`);x.push(`--define:${pe}=${$e(ne[pe],"define",pe)}`)}if(he)for(let pe in he){if(pe.indexOf("=")>=0)throw new Error(`Invalid log override: ${pe}`);x.push(`--log-override:${pe}=${$e(he[pe],"log override",pe)}`)}if(b)for(let pe in b){if(pe.indexOf("=")>=0)throw new Error(`Invalid supported: ${pe}`);const Be=b[pe];if(typeof Be!="boolean")throw new Error(`Expected value for supported ${S(pe)} to be a boolean, got ${typeof Be} instead`);x.push(`--supported:${pe}=${Be}`)}if(z)for(let pe of z)x.push(`--pure:${$e(pe,"pure")}`);fe&&x.push("--keep-names")}function Sn(x,E,A,W,ie){var ae;let te=[],ye=[],J=Object.create(null),Ue=null,Ce=null;nt(te,E,J,A,W),Ct(te,E,J);let be=O(E,J,"sourcemap",at),Le=O(E,J,"bundle",P),Oe=O(E,J,"splitting",P),je=O(E,J,"preserveSymlinks",P),Fe=O(E,J,"metafile",P),xe=O(E,J,"outfile",U),Qe=O(E,J,"outdir",U),ve=O(E,J,"outbase",U),Te=O(E,J,"tsconfig",U),oe=O(E,J,"resolveExtensions",Re),Y=O(E,J,"nodePaths",Re),F=O(E,J,"mainFields",Re),H=O(E,J,"conditions",Re),Q=O(E,J,"external",Re),ue=O(E,J,"packages",U),me=O(E,J,"alias",Ie),X=O(E,J,"loader",Ie),ne=O(E,J,"outExtension",Ie),he=O(E,J,"publicPath",U),b=O(E,J,"entryNames",U),z=O(E,J,"chunkNames",U),fe=O(E,J,"assetNames",U),le=O(E,J,"inject",Re),_e=O(E,J,"banner",Ie),Xe=O(E,J,"footer",Ie),pe=O(E,J,"entryPoints",Ve),Be=O(E,J,"absWorkingDir",U),De=O(E,J,"stdin",Ie),Pe=(ae=O(E,J,"write",P))!=null?ae:ie,Rt=O(E,J,"allowOverwrite",P),rt=O(E,J,"mangleCache",Ie);if(J.plugins=!0,qe(E,J,`in ${x}() call`),be&&te.push(`--sourcemap${be===!0?"":`=${be}`}`),Le&&te.push("--bundle"),Rt&&te.push("--allow-overwrite"),Oe&&te.push("--splitting"),je&&te.push("--preserve-symlinks"),Fe&&te.push("--metafile"),xe&&te.push(`--outfile=${xe}`),Qe&&te.push(`--outdir=${Qe}`),ve&&te.push(`--outbase=${ve}`),Te&&te.push(`--tsconfig=${Te}`),ue&&te.push(`--packages=${ue}`),oe&&te.push(`--resolve-extensions=${w(oe,"resolve extension")}`),he&&te.push(`--public-path=${he}`),b&&te.push(`--entry-names=${b}`),z&&te.push(`--chunk-names=${z}`),fe&&te.push(`--asset-names=${fe}`),F&&te.push(`--main-fields=${w(F,"main field")}`),H&&te.push(`--conditions=${w(H,"condition")}`),Q)for(let Ee of Q)te.push(`--external:${$e(Ee,"external")}`);if(me)for(let Ee in me){if(Ee.indexOf("=")>=0)throw new Error(`Invalid package name in alias: ${Ee}`);te.push(`--alias:${Ee}=${$e(me[Ee],"alias",Ee)}`)}if(_e)for(let Ee in _e){if(Ee.indexOf("=")>=0)throw new Error(`Invalid banner file type: ${Ee}`);te.push(`--banner:${Ee}=${$e(_e[Ee],"banner",Ee)}`)}if(Xe)for(let Ee in Xe){if(Ee.indexOf("=")>=0)throw new Error(`Invalid footer file type: ${Ee}`);te.push(`--footer:${Ee}=${$e(Xe[Ee],"footer",Ee)}`)}if(le)for(let Ee of le)te.push(`--inject:${$e(Ee,"inject")}`);if(X)for(let Ee in X){if(Ee.indexOf("=")>=0)throw new Error(`Invalid loader extension: ${Ee}`);te.push(`--loader:${Ee}=${$e(X[Ee],"loader",Ee)}`)}if(ne)for(let Ee in ne){if(Ee.indexOf("=")>=0)throw new Error(`Invalid out extension: ${Ee}`);te.push(`--out-extension:${Ee}=${$e(ne[Ee],"out extension",Ee)}`)}if(pe)if(Array.isArray(pe))for(let Ee=0,Xt=pe.length;Ee<Xt;Ee++){let Nt=pe[Ee];if(typeof Nt=="object"&&Nt!==null){let Ot=Object.create(null),nn=O(Nt,Ot,"in",U),It=O(Nt,Ot,"out",U);if(qe(Nt,Ot,"in entry point at index "+Ee),nn===void 0)throw new Error('Missing property "in" for entry point at index '+Ee);if(It===void 0)throw new Error('Missing property "out" for entry point at index '+Ee);ye.push([It,nn])}else ye.push(["",$e(Nt,"entry point at index "+Ee)])}else for(let Ee in pe)ye.push([Ee,$e(pe[Ee],"entry point",Ee)]);if(De){let Ee=Object.create(null),Xt=O(De,Ee,"contents",pt),Nt=O(De,Ee,"resolveDir",U),Ot=O(De,Ee,"sourcefile",U),nn=O(De,Ee,"loader",U);qe(De,Ee,'in "stdin" object'),Ot&&te.push(`--sourcefile=${Ot}`),nn&&te.push(`--loader=${nn}`),Nt&&(Ce=Nt),typeof Xt=="string"?Ue=R(Xt):Xt instanceof Uint8Array&&(Ue=Xt)}let ft=[];if(Y)for(let Ee of Y)Ee+="",ft.push(Ee);return{entries:ye,flags:te,write:Pe,stdinContents:Ue,stdinResolveDir:Ce,absWorkingDir:Be,nodePaths:ft,mangleCache:Lt(rt)}}function kt(x,E,A,W){let ie=[],ae=Object.create(null);nt(ie,E,ae,A,W),Ct(ie,E,ae);let te=O(E,ae,"sourcemap",at),ye=O(E,ae,"sourcefile",U),J=O(E,ae,"loader",U),Ue=O(E,ae,"banner",U),Ce=O(E,ae,"footer",U),be=O(E,ae,"mangleCache",Ie);return qe(E,ae,`in ${x}() call`),te&&ie.push(`--sourcemap=${te===!0?"external":te}`),ye&&ie.push(`--sourcefile=${ye}`),J&&ie.push(`--loader=${J}`),Ue&&ie.push(`--banner=${Ue}`),Ce&&ie.push(`--footer=${Ce}`),{flags:ie,mangleCache:Lt(be)}}function vs(x){const E={},A={didClose:!1,reason:""};let W={},ie=0,ae=0,te=new Uint8Array(16*1024),ye=0,J=Te=>{let oe=ye+Te.length;if(oe>te.length){let F=new Uint8Array(oe*2);F.set(te),te=F}te.set(Te,ye),ye+=Te.length;let Y=0;for(;Y+4<=ye;){let F=I(te,Y);if(Y+4+F>ye)break;Y+=4,je(te.subarray(Y,Y+F)),Y+=F}Y>0&&(te.copyWithin(0,Y,ye),ye-=Y)},Ue=Te=>{A.didClose=!0,Te&&(A.reason=": "+(Te.message||Te));const oe="The service was stopped"+A.reason;for(let Y in W)W[Y](oe,null);W={}},Ce=(Te,oe,Y)=>{if(A.didClose)return Y("The service is no longer running"+A.reason,null);let F=ie++;W[F]=(H,Q)=>{try{Y(H,Q)}finally{Te&&Te.unref()}},Te&&Te.ref(),x.writeToStdin(g({id:F,isRequest:!0,value:oe}))},be=(Te,oe)=>{if(A.didClose)throw new Error("The service is no longer running"+A.reason);x.writeToStdin(g({id:Te,isRequest:!1,value:oe}))},Le=(Te,oe)=>m(null,null,function*(){try{if(oe.command==="ping"){be(Te,{});return}if(typeof oe.key=="number"){const Y=E[oe.key];if(!Y)return;const F=Y[oe.command];if(F){yield F(Te,oe);return}}throw new Error("Invalid command: "+oe.command)}catch(Y){const F=[An(Y,x,null,void 0,"")];try{be(Te,{errors:F})}catch{}}}),Oe=!0,je=Te=>{if(Oe){Oe=!1;let Y=String.fromCharCode(...Te);if(Y!=="0.27.3")throw new Error(`Cannot start service: Host version "0.27.3" does not match binary version ${S(Y)}`);return}let oe=p(Te);if(oe.isRequest)Le(oe.id,oe.value);else{let Y=W[oe.id];delete W[oe.id],oe.value.error?Y(oe.value.error,{}):Y(null,oe.value)}};return{readFromStdout:J,afterClose:Ue,service:{buildOrContext:({callName:Te,refs:oe,options:Y,isTTY:F,defaultWD:H,callback:Q})=>{let ue=0;const me=ae++,X={},ne={ref(){++ue===1&&oe&&oe.ref()},unref(){--ue===0&&(delete E[me],oe&&oe.unref())}};E[me]=X,ne.ref(),gi(Te,me,Ce,be,ne,x,X,Y,F,H,(he,b)=>{try{Q(he,b)}finally{ne.unref()}})},transform:({callName:Te,refs:oe,input:Y,options:F,isTTY:H,fs:Q,callback:ue})=>{const me=xs();let X=ne=>{try{if(typeof Y!="string"&&!(Y instanceof Uint8Array))throw new Error('The input to "transform" must be a string or a Uint8Array');let{flags:he,mangleCache:b}=kt(Te,F,H,v),z={command:"transform",flags:he,inputFS:ne!==null,input:ne!==null?R(ne):typeof Y=="string"?R(Y):Y};b&&(z.mangleCache=b),Ce(oe,z,(fe,le)=>{if(fe)return ue(new Error(fe),null);let _e=jt(le.errors,me),Xe=jt(le.warnings,me),pe=1,Be=()=>{if(--pe===0){let De={warnings:Xe,code:le.code,map:le.map,mangleCache:void 0,legalComments:void 0};"legalComments"in le&&(De.legalComments=le?.legalComments),le.mangleCache&&(De.mangleCache=le?.mangleCache),ue(null,De)}};if(_e.length>0)return ue(Et("Transform failed",_e,Xe),null);le.codeFS&&(pe++,Q.readFile(le.code,(De,Pe)=>{De!==null?ue(De,null):(le.code=Pe,Be())})),le.mapFS&&(pe++,Q.readFile(le.map,(De,Pe)=>{De!==null?ue(De,null):(le.map=Pe,Be())})),Be()})}catch(he){let b=[];try{nt(b,F,{},H,v)}catch{}const z=An(he,x,me,void 0,"");Ce(oe,{command:"error",flags:b,error:z},()=>{z.detail=me.load(z.detail),ue(Et("Transform failed",[z],[]),null)})}};if((typeof Y=="string"||Y instanceof Uint8Array)&&Y.length>1024*1024){let ne=X;X=()=>Q.writeFile(Y,ne)}X(null)},formatMessages:({callName:Te,refs:oe,messages:Y,options:F,callback:H})=>{if(!F)throw new Error(`Missing second argument in ${Te}() call`);let Q={},ue=O(F,Q,"kind",U),me=O(F,Q,"color",P),X=O(F,Q,"terminalWidth",Z);if(qe(F,Q,`in ${Te}() call`),ue===void 0)throw new Error(`Missing "kind" in ${Te}() call`);if(ue!=="error"&&ue!=="warning")throw new Error(`Expected "kind" to be "error" or "warning" in ${Te}() call`);let ne={command:"format-msgs",messages:zt(Y,"messages",null,"",X),isWarning:ue==="warning"};me!==void 0&&(ne.color=me),X!==void 0&&(ne.terminalWidth=X),Ce(oe,ne,(he,b)=>{if(he)return H(new Error(he),null);H(null,b.messages)})},analyzeMetafile:({callName:Te,refs:oe,metafile:Y,options:F,callback:H})=>{F===void 0&&(F={});let Q={},ue=O(F,Q,"color",P),me=O(F,Q,"verbose",P);qe(F,Q,`in ${Te}() call`);let X={command:"analyze-metafile",metafile:Y};ue!==void 0&&(X.color=ue),me!==void 0&&(X.verbose=me),Ce(oe,X,(ne,he)=>{if(ne)return H(new Error(ne),null);H(null,he.result)})}}}}function gi(x,E,A,W,ie,ae,te,ye,J,Ue,Ce){const be=xs(),Le=x==="context",Oe=(xe,Qe)=>{const ve=[];try{nt(ve,ye,{},J,G)}catch{}const Te=An(xe,ae,be,void 0,Qe);A(ie,{command:"error",flags:ve,error:Te},()=>{Te.detail=be.load(Te.detail),Ce(Et(Le?"Context failed":"Build failed",[Te],[]),null)})};let je;if(typeof ye=="object"){const xe=ye.plugins;if(xe!==void 0){if(!Array.isArray(xe))return Oe(new Error('"plugins" must be an array'),"");je=xe}}if(je&&je.length>0){if(ae.isSync)return Oe(new Error("Cannot use plugins in synchronous API calls"),"");Ts(E,A,W,ie,ae,te,ye,je,be).then(xe=>{if(!xe.ok)return Oe(xe.error,xe.pluginName);try{Fe(xe.requestPlugins,xe.runOnEndCallbacks,xe.scheduleOnDisposeCallbacks)}catch(Qe){Oe(Qe,"")}},xe=>Oe(xe,""));return}try{Fe(null,(xe,Qe)=>Qe([],[]),()=>{})}catch(xe){Oe(xe,"")}function Fe(xe,Qe,ve){const Te=ae.hasFS,{entries:oe,flags:Y,write:F,stdinContents:H,stdinResolveDir:Q,absWorkingDir:ue,nodePaths:me,mangleCache:X}=Sn(x,ye,J,G,Te);if(F&&!ae.hasFS)throw new Error('The "write" option is unavailable in this environment');const ne={command:"build",key:E,entries:oe,flags:Y,write:F,stdinContents:H,stdinResolveDir:Q,absWorkingDir:ue||Ue,nodePaths:me,context:Le};xe&&(ne.plugins=xe),X&&(ne.mangleCache=X);const he=(fe,le)=>{const _e={errors:jt(fe.errors,be),warnings:jt(fe.warnings,be),outputFiles:void 0,metafile:void 0,mangleCache:void 0},Xe=_e.errors.slice(),pe=_e.warnings.slice();fe.outputFiles&&(_e.outputFiles=fe.outputFiles.map(hr)),fe.metafile&&(_e.metafile=JSON.parse(fe.metafile)),fe.mangleCache&&(_e.mangleCache=fe.mangleCache),fe.writeToStdout!==void 0&&console.log(h(fe.writeToStdout).replace(/\n$/,"")),Qe(_e,(Be,De)=>{if(Xe.length>0||Be.length>0){const Pe=Et("Build failed",Xe.concat(Be),pe.concat(De));return le(Pe,null,Be,De)}le(null,_e,Be,De)})};let b,z;Le&&(te["on-end"]=(fe,le)=>new Promise(_e=>{he(le,(Xe,pe,Be,De)=>{const Pe={errors:Be,warnings:De};z&&z(Xe,pe),b=void 0,z=void 0,W(fe,Pe),_e()})})),A(ie,ne,(fe,le)=>{if(fe)return Ce(new Error(fe),null);if(!Le)return he(le,(pe,Be)=>(ve(),Ce(pe,Be)));if(le.errors.length>0)return Ce(Et("Context failed",le.errors,le.warnings),null);let _e=!1;const Xe={rebuild:()=>(b||(b=new Promise((pe,Be)=>{let De;z=(Rt,rt)=>{De||(De=()=>Rt?Be(Rt):pe(rt))};const Pe=()=>{A(ie,{command:"rebuild",key:E},(rt,ft)=>{rt?Be(new Error(rt)):De?De():Pe()})};Pe()})),b),watch:(pe={})=>new Promise((Be,De)=>{if(!ae.hasFS)throw new Error('Cannot use the "watch" API in this environment');const Pe={},Rt=O(pe,Pe,"delay",Z);qe(pe,Pe,"in watch() call");const rt={command:"watch",key:E};Rt&&(rt.delay=Rt),A(ie,rt,ft=>{ft?De(new Error(ft)):Be(void 0)})}),serve:(pe={})=>new Promise((Be,De)=>{if(!ae.hasFS)throw new Error('Cannot use the "serve" API in this environment');const Pe={},Rt=O(pe,Pe,"port",Se),rt=O(pe,Pe,"host",U),ft=O(pe,Pe,"servedir",U),Ee=O(pe,Pe,"keyfile",U),Xt=O(pe,Pe,"certfile",U),Nt=O(pe,Pe,"fallback",U),Ot=O(pe,Pe,"cors",Ie),nn=O(pe,Pe,"onRequest",de);qe(pe,Pe,"in serve() call");const It={command:"serve",key:E,onRequest:!!nn};if(Rt!==void 0&&(It.port=Rt),rt!==void 0&&(It.host=rt),ft!==void 0&&(It.servedir=ft),Ee!==void 0&&(It.keyfile=Ee),Xt!==void 0&&(It.certfile=Xt),Nt!==void 0&&(It.fallback=Nt),Ot){const zn={},Nn=O(Ot,zn,"origin",dt);qe(Ot,zn,'on "cors" object'),Array.isArray(Nn)?It.corsOrigin=Nn:Nn!==void 0&&(It.corsOrigin=[Nn])}A(ie,It,(zn,Nn)=>{if(zn)return De(new Error(zn));nn&&(te["serve-request"]=(wi,Cr)=>{nn(Cr.args),W(wi,{})}),Be(Nn)})}),cancel:()=>new Promise(pe=>{if(_e)return pe();A(ie,{command:"cancel",key:E},()=>{pe()})}),dispose:()=>new Promise(pe=>{if(_e)return pe();_e=!0,A(ie,{command:"dispose",key:E},()=>{pe(),ve(),ie.unref()})})};ie.ref(),Ce(null,Xe)})}}var Ts=(x,E,A,W,ie,ae,te,ye,J)=>m(null,null,function*(){let Ue=[],Ce=[],be={},Le={},Oe=[],je=0,Fe=0,xe=[],Qe=!1;ye=[...ye];for(let oe of ye){let Y={};if(typeof oe!="object")throw new Error(`Plugin at index ${Fe} must be an object`);const F=O(oe,Y,"name",U);if(typeof F!="string"||F==="")throw new Error(`Plugin at index ${Fe} is missing a name`);try{let H=O(oe,Y,"setup",de);if(typeof H!="function")throw new Error("Plugin is missing a setup function");qe(oe,Y,`on plugin ${S(F)}`);let Q={name:F,onStart:!1,onEnd:!1,onResolve:[],onLoad:[]};Fe++;let me=H({initialOptions:te,resolve:(X,ne={})=>{if(!Qe)throw new Error('Cannot call "resolve" before plugin setup has completed');if(typeof X!="string")throw new Error("The path to resolve must be a string");let he=Object.create(null),b=O(ne,he,"pluginName",U),z=O(ne,he,"importer",U),fe=O(ne,he,"namespace",U),le=O(ne,he,"resolveDir",U),_e=O(ne,he,"kind",U),Xe=O(ne,he,"pluginData",N),pe=O(ne,he,"with",Ie);return qe(ne,he,"in resolve() call"),new Promise((Be,De)=>{const Pe={command:"resolve",path:X,key:x,pluginName:F};if(b!=null&&(Pe.pluginName=b),z!=null&&(Pe.importer=z),fe!=null&&(Pe.namespace=fe),le!=null&&(Pe.resolveDir=le),_e!=null)Pe.kind=_e;else throw new Error('Must specify "kind" when calling "resolve"');Xe!=null&&(Pe.pluginData=J.store(Xe)),pe!=null&&(Pe.with=mi(pe,"with")),E(W,Pe,(Rt,rt)=>{Rt!==null?De(new Error(Rt)):Be({errors:jt(rt.errors,J),warnings:jt(rt.warnings,J),path:rt.path,external:rt.external,sideEffects:rt.sideEffects,namespace:rt.namespace,suffix:rt.suffix,pluginData:J.load(rt.pluginData)})})})},onStart(X){let ne='This error came from the "onStart" callback registered here:',he=cr(new Error(ne),ie,"onStart");Ue.push({name:F,callback:X,note:he}),Q.onStart=!0},onEnd(X){let ne='This error came from the "onEnd" callback registered here:',he=cr(new Error(ne),ie,"onEnd");Ce.push({name:F,callback:X,note:he}),Q.onEnd=!0},onResolve(X,ne){let he='This error came from the "onResolve" callback registered here:',b=cr(new Error(he),ie,"onResolve"),z={},fe=O(X,z,"filter",B),le=O(X,z,"namespace",U);if(qe(X,z,`in onResolve() call for plugin ${S(F)}`),fe==null)throw new Error("onResolve() call is missing a filter");let _e=je++;be[_e]={name:F,callback:ne,note:b},Q.onResolve.push({id:_e,filter:Vn(fe),namespace:le||""})},onLoad(X,ne){let he='This error came from the "onLoad" callback registered here:',b=cr(new Error(he),ie,"onLoad"),z={},fe=O(X,z,"filter",B),le=O(X,z,"namespace",U);if(qe(X,z,`in onLoad() call for plugin ${S(F)}`),fe==null)throw new Error("onLoad() call is missing a filter");let _e=je++;Le[_e]={name:F,callback:ne,note:b},Q.onLoad.push({id:_e,filter:Vn(fe),namespace:le||""})},onDispose(X){Oe.push(X)},esbuild:ie.esbuild});me&&(yield me),xe.push(Q)}catch(H){return{ok:!1,error:H,pluginName:F}}}ae["on-start"]=(oe,Y)=>m(null,null,function*(){J.clear();let F={errors:[],warnings:[]};yield Promise.all(Ue.map(H=>m(null,[H],function*({name:Q,callback:ue,note:me}){try{let X=yield ue();if(X!=null){if(typeof X!="object")throw new Error(`Expected onStart() callback in plugin ${S(Q)} to return an object`);let ne={},he=O(X,ne,"errors",we),b=O(X,ne,"warnings",we);qe(X,ne,`from onStart() callback in plugin ${S(Q)}`),he!=null&&F.errors.push(...zt(he,"errors",J,Q,void 0)),b!=null&&F.warnings.push(...zt(b,"warnings",J,Q,void 0))}}catch(X){F.errors.push(An(X,ie,J,me&&me(),Q))}}))),A(oe,F)}),ae["on-resolve"]=(oe,Y)=>m(null,null,function*(){let F={},H="",Q,ue;for(let me of Y.ids)try{({name:H,callback:Q,note:ue}=be[me]);let X=yield Q({path:Y.path,importer:Y.importer,namespace:Y.namespace,resolveDir:Y.resolveDir,kind:Y.kind,pluginData:J.load(Y.pluginData),with:Y.with});if(X!=null){if(typeof X!="object")throw new Error(`Expected onResolve() callback in plugin ${S(H)} to return an object`);let ne={},he=O(X,ne,"pluginName",U),b=O(X,ne,"path",U),z=O(X,ne,"namespace",U),fe=O(X,ne,"suffix",U),le=O(X,ne,"external",P),_e=O(X,ne,"sideEffects",P),Xe=O(X,ne,"pluginData",N),pe=O(X,ne,"errors",we),Be=O(X,ne,"warnings",we),De=O(X,ne,"watchFiles",Re),Pe=O(X,ne,"watchDirs",Re);qe(X,ne,`from onResolve() callback in plugin ${S(H)}`),F.id=me,he!=null&&(F.pluginName=he),b!=null&&(F.path=b),z!=null&&(F.namespace=z),fe!=null&&(F.suffix=fe),le!=null&&(F.external=le),_e!=null&&(F.sideEffects=_e),Xe!=null&&(F.pluginData=J.store(Xe)),pe!=null&&(F.errors=zt(pe,"errors",J,H,void 0)),Be!=null&&(F.warnings=zt(Be,"warnings",J,H,void 0)),De!=null&&(F.watchFiles=fr(De,"watchFiles")),Pe!=null&&(F.watchDirs=fr(Pe,"watchDirs"));break}}catch(X){F={id:me,errors:[An(X,ie,J,ue&&ue(),H)]};break}A(oe,F)}),ae["on-load"]=(oe,Y)=>m(null,null,function*(){let F={},H="",Q,ue;for(let me of Y.ids)try{({name:H,callback:Q,note:ue}=Le[me]);let X=yield Q({path:Y.path,namespace:Y.namespace,suffix:Y.suffix,pluginData:J.load(Y.pluginData),with:Y.with});if(X!=null){if(typeof X!="object")throw new Error(`Expected onLoad() callback in plugin ${S(H)} to return an object`);let ne={},he=O(X,ne,"pluginName",U),b=O(X,ne,"contents",pt),z=O(X,ne,"resolveDir",U),fe=O(X,ne,"pluginData",N),le=O(X,ne,"loader",U),_e=O(X,ne,"errors",we),Xe=O(X,ne,"warnings",we),pe=O(X,ne,"watchFiles",Re),Be=O(X,ne,"watchDirs",Re);qe(X,ne,`from onLoad() callback in plugin ${S(H)}`),F.id=me,he!=null&&(F.pluginName=he),b instanceof Uint8Array?F.contents=b:b!=null&&(F.contents=R(b)),z!=null&&(F.resolveDir=z),fe!=null&&(F.pluginData=J.store(fe)),le!=null&&(F.loader=le),_e!=null&&(F.errors=zt(_e,"errors",J,H,void 0)),Xe!=null&&(F.warnings=zt(Xe,"warnings",J,H,void 0)),pe!=null&&(F.watchFiles=fr(pe,"watchFiles")),Be!=null&&(F.watchDirs=fr(Be,"watchDirs"));break}}catch(X){F={id:me,errors:[An(X,ie,J,ue&&ue(),H)]};break}A(oe,F)});let ve=(oe,Y)=>Y([],[]);Ce.length>0&&(ve=(oe,Y)=>{m(null,null,function*(){const F=[],H=[];for(const{name:Q,callback:ue,note:me}of Ce){let X,ne;try{const he=yield ue(oe);if(he!=null){if(typeof he!="object")throw new Error(`Expected onEnd() callback in plugin ${S(Q)} to return an object`);let b={},z=O(he,b,"errors",we),fe=O(he,b,"warnings",we);qe(he,b,`from onEnd() callback in plugin ${S(Q)}`),z!=null&&(X=zt(z,"errors",J,Q,void 0)),fe!=null&&(ne=zt(fe,"warnings",J,Q,void 0))}}catch(he){X=[An(he,ie,J,me&&me(),Q)]}if(X){F.push(...X);try{oe.errors.push(...X)}catch{}}if(ne){H.push(...ne);try{oe.warnings.push(...ne)}catch{}}}Y(F,H)})});let Te=()=>{for(const oe of Oe)setTimeout(()=>oe(),0)};return Qe=!0,{ok:!0,requestPlugins:xe,runOnEndCallbacks:ve,scheduleOnDisposeCallbacks:Te}});function xs(){const x=new Map;let E=0;return{clear(){x.clear()},load(A){return x.get(A)},store(A){if(A===void 0)return-1;const W=E++;return x.set(W,A),W}}}function cr(x,E,A){let W,ie=!1;return()=>{if(ie)return W;ie=!0;try{let ae=(x.stack+"").split(`
`);ae.splice(1,1);let te=ur(E,ae,A);if(te)return W={text:x.message,location:te},W}catch{}}}function An(x,E,A,W,ie){let ae="Internal error",te=null;try{ae=(x&&x.message||x)+""}catch{}try{te=ur(E,(x.stack+"").split(`
`),"")}catch{}return{id:"",pluginName:ie,text:ae,location:te,notes:W?[W]:[],detail:A?A.store(x):-1}}function ur(x,E,A){let W="    at ";if(x.readFileSync&&!E[0].startsWith(W)&&E[1].startsWith(W))for(let ie=1;ie<E.length;ie++){let ae=E[ie];if(ae.startsWith(W))for(ae=ae.slice(W.length);;){let te=/^(?:new |async )?\S+ \((.*)\)$/.exec(ae);if(te){ae=te[1];continue}if(te=/^eval at \S+ \((.*)\)(?:, \S+:\d+:\d+)?$/.exec(ae),te){ae=te[1];continue}if(te=/^(\S+):(\d+):(\d+)$/.exec(ae),te){let ye;try{ye=x.readFileSync(te[1],"utf8")}catch{break}let J=ye.split(/\r\n|\r|\n|\u2028|\u2029/)[+te[2]-1]||"",Ue=+te[3]-1,Ce=J.slice(Ue,Ue+A.length)===A?A.length:0;return{file:te[1],namespace:"file",line:+te[2],column:R(J.slice(0,Ue)).length,length:R(J.slice(Ue,Ue+Ce)).length,lineText:J+`
`+E.slice(1).join(`
`),suggestion:""}}break}}return null}function Et(x,E,A){let W=5;x+=E.length<1?"":` with ${E.length} error${E.length<2?"":"s"}:`+E.slice(0,W+1).map((ae,te)=>{if(te===W)return`
...`;if(!ae.location)return`
error: ${ae.text}`;let{file:ye,line:J,column:Ue}=ae.location,Ce=ae.pluginName?`[plugin: ${ae.pluginName}] `:"";return`
${ye}:${J}:${Ue}: ERROR: ${Ce}${ae.text}`}).join("");let ie=new Error(x);for(const[ae,te]of[["errors",E],["warnings",A]])Object.defineProperty(ie,ae,{configurable:!0,enumerable:!0,get:()=>te,set:ye=>Object.defineProperty(ie,ae,{configurable:!0,enumerable:!0,value:ye})});return ie}function jt(x,E){for(const A of x)A.detail=E.load(A.detail);return x}function ws(x,E,A){if(x==null)return null;let W={},ie=O(x,W,"file",U),ae=O(x,W,"namespace",U),te=O(x,W,"line",Z),ye=O(x,W,"column",Z),J=O(x,W,"length",Z),Ue=O(x,W,"lineText",U),Ce=O(x,W,"suggestion",U);if(qe(x,W,E),Ue){const be=Ue.slice(0,(ye&&ye>0?ye:0)+(J&&J>0?J:0)+(A&&A>0?A:80));!/[\x7F-\uFFFF]/.test(be)&&!/\n/.test(Ue)&&(Ue=be)}return{file:ie||"",namespace:ae||"",line:te||0,column:ye||0,length:J||0,lineText:Ue||"",suggestion:Ce||""}}function zt(x,E,A,W,ie){let ae=[],te=0;for(const ye of x){let J={},Ue=O(ye,J,"id",U),Ce=O(ye,J,"pluginName",U),be=O(ye,J,"text",U),Le=O(ye,J,"location",Pt),Oe=O(ye,J,"notes",we),je=O(ye,J,"detail",N),Fe=`in element ${te} of "${E}"`;qe(ye,J,Fe);let xe=[];if(Oe)for(const Qe of Oe){let ve={},Te=O(Qe,ve,"text",U),oe=O(Qe,ve,"location",Pt);qe(Qe,ve,Fe),xe.push({text:Te||"",location:ws(oe,Fe,ie)})}ae.push({id:Ue||"",pluginName:Ce||W,text:be||"",location:ws(Le,Fe,ie),notes:xe,detail:A?A.store(je):-1}),te++}return ae}function fr(x,E){const A=[];for(const W of x){if(typeof W!="string")throw new Error(`${S(E)} must be an array of strings`);A.push(W)}return A}function mi(x,E){const A=Object.create(null);for(const W in x){const ie=x[W];if(typeof ie!="string")throw new Error(`key ${S(W)} in object ${S(E)} must be a string`);A[W]=ie}return A}function hr({path:x,contents:E,hash:A}){let W=null;return{path:x,contents:E,hash:A,get text(){const ie=this.contents;return(W===null||ie!==E)&&(E=ie,W=h(ie)),W}}}function Vn(x){let E=x.source;return x.flags&&(E=`(?${x.flags})${E}`),E}var Kn="0.27.3",Gn=x=>Yn().build(x),Mn=x=>Yn().context(x),dr=(x,E)=>Yn().transform(x,E),Es=(x,E)=>Yn().formatMessages(x,E),pr=(x,E)=>Yn().analyzeMetafile(x,E),Cn=()=>{throw new Error('The "buildSync" API only works in node')},yi=()=>{throw new Error('The "transformSync" API only works in node')},vi=()=>{throw new Error('The "formatMessagesSync" API only works in node')},Ti=()=>{throw new Error('The "analyzeMetafileSync" API only works in node')},bs=()=>(tn&&tn(),Promise.resolve()),Ze,tn,ke,Yn=()=>{if(ke)return ke;throw Ze?new Error('You need to wait for the promise returned from "initialize" to be resolved before calling this'):new Error('You need to call "initialize" before calling this')},Ht=x=>{x=In(x||{});let E=x.wasmURL,A=x.wasmModule,W=x.worker!==!1;if(!E&&!A)throw new Error('Must provide either the "wasmURL" option or the "wasmModule" option');if(Ze)throw new Error('Cannot call "initialize" more than once');return Ze=Wt(E||"",A,W),Ze.catch(()=>{Ze=void 0}),Ze},Wt=(x,E,A)=>m(null,null,function*(){let W,ie;const ae=new Promise(be=>ie=be);if(A){let be=new Blob([`onmessage=((postMessage) => {
      // Copyright 2018 The Go Authors. All rights reserved.
      // Use of this source code is governed by a BSD-style
      // license that can be found in the LICENSE file.
      var __async = (__this, __arguments, generator) => {
        return new Promise((resolve, reject) => {
          var fulfilled = (value) => {
            try {
              step(generator.next(value));
            } catch (e) {
              reject(e);
            }
          };
          var rejected = (value) => {
            try {
              step(generator.throw(value));
            } catch (e) {
              reject(e);
            }
          };
          var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
          step((generator = generator.apply(__this, __arguments)).next());
        });
      };
      let onmessage;
      let globalThis = {};
      for (let o = self; o; o = Object.getPrototypeOf(o))
        for (let k of Object.getOwnPropertyNames(o))
          if (!(k in globalThis))
            Object.defineProperty(globalThis, k, { get: () => self[k] });
      "use strict";
      (() => {
        const enosys = () => {
          const err = new Error("not implemented");
          err.code = "ENOSYS";
          return err;
        };
        if (!globalThis.fs) {
          let outputBuf = "";
          globalThis.fs = {
            constants: { O_WRONLY: -1, O_RDWR: -1, O_CREAT: -1, O_TRUNC: -1, O_APPEND: -1, O_EXCL: -1, O_DIRECTORY: -1 },
            // unused
            writeSync(fd, buf) {
              outputBuf += decoder.decode(buf);
              const nl = outputBuf.lastIndexOf("\\n");
              if (nl != -1) {
                console.log(outputBuf.substring(0, nl));
                outputBuf = outputBuf.substring(nl + 1);
              }
              return buf.length;
            },
            write(fd, buf, offset, length, position, callback) {
              if (offset !== 0 || length !== buf.length || position !== null) {
                callback(enosys());
                return;
              }
              const n = this.writeSync(fd, buf);
              callback(null, n);
            },
            chmod(path, mode, callback) {
              callback(enosys());
            },
            chown(path, uid, gid, callback) {
              callback(enosys());
            },
            close(fd, callback) {
              callback(enosys());
            },
            fchmod(fd, mode, callback) {
              callback(enosys());
            },
            fchown(fd, uid, gid, callback) {
              callback(enosys());
            },
            fstat(fd, callback) {
              callback(enosys());
            },
            fsync(fd, callback) {
              callback(null);
            },
            ftruncate(fd, length, callback) {
              callback(enosys());
            },
            lchown(path, uid, gid, callback) {
              callback(enosys());
            },
            link(path, link, callback) {
              callback(enosys());
            },
            lstat(path, callback) {
              callback(enosys());
            },
            mkdir(path, perm, callback) {
              callback(enosys());
            },
            open(path, flags, mode, callback) {
              callback(enosys());
            },
            read(fd, buffer, offset, length, position, callback) {
              callback(enosys());
            },
            readdir(path, callback) {
              callback(enosys());
            },
            readlink(path, callback) {
              callback(enosys());
            },
            rename(from, to, callback) {
              callback(enosys());
            },
            rmdir(path, callback) {
              callback(enosys());
            },
            stat(path, callback) {
              callback(enosys());
            },
            symlink(path, link, callback) {
              callback(enosys());
            },
            truncate(path, length, callback) {
              callback(enosys());
            },
            unlink(path, callback) {
              callback(enosys());
            },
            utimes(path, atime, mtime, callback) {
              callback(enosys());
            }
          };
        }
        if (!globalThis.process) {
          globalThis.process = {
            getuid() {
              return -1;
            },
            getgid() {
              return -1;
            },
            geteuid() {
              return -1;
            },
            getegid() {
              return -1;
            },
            getgroups() {
              throw enosys();
            },
            pid: -1,
            ppid: -1,
            umask() {
              throw enosys();
            },
            cwd() {
              throw enosys();
            },
            chdir() {
              throw enosys();
            }
          };
        }
        if (!globalThis.path) {
          globalThis.path = {
            resolve(...pathSegments) {
              return pathSegments.join("/");
            }
          };
        }
        if (!globalThis.crypto) {
          throw new Error("globalThis.crypto is not available, polyfill required (crypto.getRandomValues only)");
        }
        if (!globalThis.performance) {
          throw new Error("globalThis.performance is not available, polyfill required (performance.now only)");
        }
        if (!globalThis.TextEncoder) {
          throw new Error("globalThis.TextEncoder is not available, polyfill required");
        }
        if (!globalThis.TextDecoder) {
          throw new Error("globalThis.TextDecoder is not available, polyfill required");
        }
        const encoder = new TextEncoder("utf-8");
        const decoder = new TextDecoder("utf-8");
        globalThis.Go = class {
          constructor() {
            this.argv = ["js"];
            this.env = {};
            this.exit = (code) => {
              if (code !== 0) {
                console.warn("exit code:", code);
              }
            };
            this._exitPromise = new Promise((resolve) => {
              this._resolveExitPromise = resolve;
            });
            this._pendingEvent = null;
            this._scheduledTimeouts = /* @__PURE__ */ new Map();
            this._nextCallbackTimeoutID = 1;
            const setInt64 = (addr, v) => {
              this.mem.setUint32(addr + 0, v, true);
              this.mem.setUint32(addr + 4, Math.floor(v / 4294967296), true);
            };
            const setInt32 = (addr, v) => {
              this.mem.setUint32(addr + 0, v, true);
            };
            const getInt64 = (addr) => {
              const low = this.mem.getUint32(addr + 0, true);
              const high = this.mem.getInt32(addr + 4, true);
              return low + high * 4294967296;
            };
            const loadValue = (addr) => {
              const f = this.mem.getFloat64(addr, true);
              if (f === 0) {
                return void 0;
              }
              if (!isNaN(f)) {
                return f;
              }
              const id = this.mem.getUint32(addr, true);
              return this._values[id];
            };
            const storeValue = (addr, v) => {
              const nanHead = 2146959360;
              if (typeof v === "number" && v !== 0) {
                if (isNaN(v)) {
                  this.mem.setUint32(addr + 4, nanHead, true);
                  this.mem.setUint32(addr, 0, true);
                  return;
                }
                this.mem.setFloat64(addr, v, true);
                return;
              }
              if (v === void 0) {
                this.mem.setFloat64(addr, 0, true);
                return;
              }
              let id = this._ids.get(v);
              if (id === void 0) {
                id = this._idPool.pop();
                if (id === void 0) {
                  id = this._values.length;
                }
                this._values[id] = v;
                this._goRefCounts[id] = 0;
                this._ids.set(v, id);
              }
              this._goRefCounts[id]++;
              let typeFlag = 0;
              switch (typeof v) {
                case "object":
                  if (v !== null) {
                    typeFlag = 1;
                  }
                  break;
                case "string":
                  typeFlag = 2;
                  break;
                case "symbol":
                  typeFlag = 3;
                  break;
                case "function":
                  typeFlag = 4;
                  break;
              }
              this.mem.setUint32(addr + 4, nanHead | typeFlag, true);
              this.mem.setUint32(addr, id, true);
            };
            const loadSlice = (addr) => {
              const array = getInt64(addr + 0);
              const len = getInt64(addr + 8);
              return new Uint8Array(this._inst.exports.mem.buffer, array, len);
            };
            const loadSliceOfValues = (addr) => {
              const array = getInt64(addr + 0);
              const len = getInt64(addr + 8);
              const a = new Array(len);
              for (let i = 0; i < len; i++) {
                a[i] = loadValue(array + i * 8);
              }
              return a;
            };
            const loadString = (addr) => {
              const saddr = getInt64(addr + 0);
              const len = getInt64(addr + 8);
              return decoder.decode(new DataView(this._inst.exports.mem.buffer, saddr, len));
            };
            const testCallExport = (a, b) => {
              this._inst.exports.testExport0();
              return this._inst.exports.testExport(a, b);
            };
            const timeOrigin = Date.now() - performance.now();
            this.importObject = {
              _gotest: {
                add: (a, b) => a + b,
                callExport: testCallExport
              },
              gojs: {
                // Go's SP does not change as long as no Go code is running. Some operations (e.g. calls, getters and setters)
                // may synchronously trigger a Go event handler. This makes Go code get executed in the middle of the imported
                // function. A goroutine can switch to a new stack if the current stack is too small (see morestack function).
                // This changes the SP, thus we have to update the SP used by the imported function.
                // func wasmExit(code int32)
                "runtime.wasmExit": (sp) => {
                  sp >>>= 0;
                  const code = this.mem.getInt32(sp + 8, true);
                  this.exited = true;
                  delete this._inst;
                  delete this._values;
                  delete this._goRefCounts;
                  delete this._ids;
                  delete this._idPool;
                  this.exit(code);
                },
                // func wasmWrite(fd uintptr, p unsafe.Pointer, n int32)
                "runtime.wasmWrite": (sp) => {
                  sp >>>= 0;
                  const fd = getInt64(sp + 8);
                  const p = getInt64(sp + 16);
                  const n = this.mem.getInt32(sp + 24, true);
                  globalThis.fs.writeSync(fd, new Uint8Array(this._inst.exports.mem.buffer, p, n));
                },
                // func resetMemoryDataView()
                "runtime.resetMemoryDataView": (sp) => {
                  sp >>>= 0;
                  this.mem = new DataView(this._inst.exports.mem.buffer);
                },
                // func nanotime1() int64
                "runtime.nanotime1": (sp) => {
                  sp >>>= 0;
                  setInt64(sp + 8, (timeOrigin + performance.now()) * 1e6);
                },
                // func walltime() (sec int64, nsec int32)
                "runtime.walltime": (sp) => {
                  sp >>>= 0;
                  const msec = (/* @__PURE__ */ new Date()).getTime();
                  setInt64(sp + 8, msec / 1e3);
                  this.mem.setInt32(sp + 16, msec % 1e3 * 1e6, true);
                },
                // func scheduleTimeoutEvent(delay int64) int32
                "runtime.scheduleTimeoutEvent": (sp) => {
                  sp >>>= 0;
                  const id = this._nextCallbackTimeoutID;
                  this._nextCallbackTimeoutID++;
                  this._scheduledTimeouts.set(id, setTimeout(
                    () => {
                      this._resume();
                      while (this._scheduledTimeouts.has(id)) {
                        console.warn("scheduleTimeoutEvent: missed timeout event");
                        this._resume();
                      }
                    },
                    getInt64(sp + 8)
                  ));
                  this.mem.setInt32(sp + 16, id, true);
                },
                // func clearTimeoutEvent(id int32)
                "runtime.clearTimeoutEvent": (sp) => {
                  sp >>>= 0;
                  const id = this.mem.getInt32(sp + 8, true);
                  clearTimeout(this._scheduledTimeouts.get(id));
                  this._scheduledTimeouts.delete(id);
                },
                // func getRandomData(r []byte)
                "runtime.getRandomData": (sp) => {
                  sp >>>= 0;
                  crypto.getRandomValues(loadSlice(sp + 8));
                },
                // func finalizeRef(v ref)
                "syscall/js.finalizeRef": (sp) => {
                  sp >>>= 0;
                  const id = this.mem.getUint32(sp + 8, true);
                  this._goRefCounts[id]--;
                  if (this._goRefCounts[id] === 0) {
                    const v = this._values[id];
                    this._values[id] = null;
                    this._ids.delete(v);
                    this._idPool.push(id);
                  }
                },
                // func stringVal(value string) ref
                "syscall/js.stringVal": (sp) => {
                  sp >>>= 0;
                  storeValue(sp + 24, loadString(sp + 8));
                },
                // func valueGet(v ref, p string) ref
                "syscall/js.valueGet": (sp) => {
                  sp >>>= 0;
                  const result = Reflect.get(loadValue(sp + 8), loadString(sp + 16));
                  sp = this._inst.exports.getsp() >>> 0;
                  storeValue(sp + 32, result);
                },
                // func valueSet(v ref, p string, x ref)
                "syscall/js.valueSet": (sp) => {
                  sp >>>= 0;
                  Reflect.set(loadValue(sp + 8), loadString(sp + 16), loadValue(sp + 32));
                },
                // func valueDelete(v ref, p string)
                "syscall/js.valueDelete": (sp) => {
                  sp >>>= 0;
                  Reflect.deleteProperty(loadValue(sp + 8), loadString(sp + 16));
                },
                // func valueIndex(v ref, i int) ref
                "syscall/js.valueIndex": (sp) => {
                  sp >>>= 0;
                  storeValue(sp + 24, Reflect.get(loadValue(sp + 8), getInt64(sp + 16)));
                },
                // valueSetIndex(v ref, i int, x ref)
                "syscall/js.valueSetIndex": (sp) => {
                  sp >>>= 0;
                  Reflect.set(loadValue(sp + 8), getInt64(sp + 16), loadValue(sp + 24));
                },
                // func valueCall(v ref, m string, args []ref) (ref, bool)
                "syscall/js.valueCall": (sp) => {
                  sp >>>= 0;
                  try {
                    const v = loadValue(sp + 8);
                    const m = Reflect.get(v, loadString(sp + 16));
                    const args = loadSliceOfValues(sp + 32);
                    const result = Reflect.apply(m, v, args);
                    sp = this._inst.exports.getsp() >>> 0;
                    storeValue(sp + 56, result);
                    this.mem.setUint8(sp + 64, 1);
                  } catch (err) {
                    sp = this._inst.exports.getsp() >>> 0;
                    storeValue(sp + 56, err);
                    this.mem.setUint8(sp + 64, 0);
                  }
                },
                // func valueInvoke(v ref, args []ref) (ref, bool)
                "syscall/js.valueInvoke": (sp) => {
                  sp >>>= 0;
                  try {
                    const v = loadValue(sp + 8);
                    const args = loadSliceOfValues(sp + 16);
                    const result = Reflect.apply(v, void 0, args);
                    sp = this._inst.exports.getsp() >>> 0;
                    storeValue(sp + 40, result);
                    this.mem.setUint8(sp + 48, 1);
                  } catch (err) {
                    sp = this._inst.exports.getsp() >>> 0;
                    storeValue(sp + 40, err);
                    this.mem.setUint8(sp + 48, 0);
                  }
                },
                // func valueNew(v ref, args []ref) (ref, bool)
                "syscall/js.valueNew": (sp) => {
                  sp >>>= 0;
                  try {
                    const v = loadValue(sp + 8);
                    const args = loadSliceOfValues(sp + 16);
                    const result = Reflect.construct(v, args);
                    sp = this._inst.exports.getsp() >>> 0;
                    storeValue(sp + 40, result);
                    this.mem.setUint8(sp + 48, 1);
                  } catch (err) {
                    sp = this._inst.exports.getsp() >>> 0;
                    storeValue(sp + 40, err);
                    this.mem.setUint8(sp + 48, 0);
                  }
                },
                // func valueLength(v ref) int
                "syscall/js.valueLength": (sp) => {
                  sp >>>= 0;
                  setInt64(sp + 16, parseInt(loadValue(sp + 8).length));
                },
                // valuePrepareString(v ref) (ref, int)
                "syscall/js.valuePrepareString": (sp) => {
                  sp >>>= 0;
                  const str = encoder.encode(String(loadValue(sp + 8)));
                  storeValue(sp + 16, str);
                  setInt64(sp + 24, str.length);
                },
                // valueLoadString(v ref, b []byte)
                "syscall/js.valueLoadString": (sp) => {
                  sp >>>= 0;
                  const str = loadValue(sp + 8);
                  loadSlice(sp + 16).set(str);
                },
                // func valueInstanceOf(v ref, t ref) bool
                "syscall/js.valueInstanceOf": (sp) => {
                  sp >>>= 0;
                  this.mem.setUint8(sp + 24, loadValue(sp + 8) instanceof loadValue(sp + 16) ? 1 : 0);
                },
                // func copyBytesToGo(dst []byte, src ref) (int, bool)
                "syscall/js.copyBytesToGo": (sp) => {
                  sp >>>= 0;
                  const dst = loadSlice(sp + 8);
                  const src = loadValue(sp + 32);
                  if (!(src instanceof Uint8Array || src instanceof Uint8ClampedArray)) {
                    this.mem.setUint8(sp + 48, 0);
                    return;
                  }
                  const toCopy = src.subarray(0, dst.length);
                  dst.set(toCopy);
                  setInt64(sp + 40, toCopy.length);
                  this.mem.setUint8(sp + 48, 1);
                },
                // func copyBytesToJS(dst ref, src []byte) (int, bool)
                "syscall/js.copyBytesToJS": (sp) => {
                  sp >>>= 0;
                  const dst = loadValue(sp + 8);
                  const src = loadSlice(sp + 16);
                  if (!(dst instanceof Uint8Array || dst instanceof Uint8ClampedArray)) {
                    this.mem.setUint8(sp + 48, 0);
                    return;
                  }
                  const toCopy = src.subarray(0, dst.length);
                  dst.set(toCopy);
                  setInt64(sp + 40, toCopy.length);
                  this.mem.setUint8(sp + 48, 1);
                },
                "debug": (value) => {
                  console.log(value);
                }
              }
            };
          }
          run(instance) {
            return __async(this, null, function* () {
              if (!(instance instanceof WebAssembly.Instance)) {
                throw new Error("Go.run: WebAssembly.Instance expected");
              }
              this._inst = instance;
              this.mem = new DataView(this._inst.exports.mem.buffer);
              this._values = [
                // JS values that Go currently has references to, indexed by reference id
                NaN,
                0,
                null,
                true,
                false,
                globalThis,
                this
              ];
              this._goRefCounts = new Array(this._values.length).fill(Infinity);
              this._ids = /* @__PURE__ */ new Map([
                // mapping from JS values to reference ids
                [0, 1],
                [null, 2],
                [true, 3],
                [false, 4],
                [globalThis, 5],
                [this, 6]
              ]);
              this._idPool = [];
              this.exited = false;
              let offset = 4096;
              const strPtr = (str) => {
                const ptr = offset;
                const bytes = encoder.encode(str + "\\0");
                new Uint8Array(this.mem.buffer, offset, bytes.length).set(bytes);
                offset += bytes.length;
                if (offset % 8 !== 0) {
                  offset += 8 - offset % 8;
                }
                return ptr;
              };
              const argc = this.argv.length;
              const argvPtrs = [];
              this.argv.forEach((arg) => {
                argvPtrs.push(strPtr(arg));
              });
              argvPtrs.push(0);
              const keys = Object.keys(this.env).sort();
              keys.forEach((key) => {
                argvPtrs.push(strPtr(\`\${key}=\${this.env[key]}\`));
              });
              argvPtrs.push(0);
              const argv = offset;
              argvPtrs.forEach((ptr) => {
                this.mem.setUint32(offset, ptr, true);
                this.mem.setUint32(offset + 4, 0, true);
                offset += 8;
              });
              const wasmMinDataAddr = 4096 + 8192;
              if (offset >= wasmMinDataAddr) {
                throw new Error("total length of command line and environment variables exceeds limit");
              }
              this._inst.exports.run(argc, argv);
              if (this.exited) {
                this._resolveExitPromise();
              }
              yield this._exitPromise;
            });
          }
          _resume() {
            if (this.exited) {
              throw new Error("Go program has already exited");
            }
            this._inst.exports.resume();
            if (this.exited) {
              this._resolveExitPromise();
            }
          }
          _makeFuncWrapper(id) {
            const go = this;
            return function() {
              const event = { id, this: this, args: arguments };
              go._pendingEvent = event;
              go._resume();
              return event.result;
            };
          }
        };
      })();
      onmessage = ({ data: wasm }) => {
        let decoder = new TextDecoder();
        let fs = globalThis.fs;
        let stderr = "";
        fs.writeSync = (fd, buffer) => {
          if (fd === 1) {
            postMessage(buffer);
          } else if (fd === 2) {
            stderr += decoder.decode(buffer);
            let parts = stderr.split("\\n");
            if (parts.length > 1) console.log(parts.slice(0, -1).join("\\n"));
            stderr = parts[parts.length - 1];
          } else {
            throw new Error("Bad write");
          }
          return buffer.length;
        };
        let stdin = [];
        let resumeStdin;
        let stdinPos = 0;
        onmessage = ({ data }) => {
          if (data.length > 0) {
            stdin.push(data);
            if (resumeStdin) resumeStdin();
          }
          return go;
        };
        fs.read = (fd, buffer, offset, length, position, callback) => {
          if (fd !== 0 || offset !== 0 || length !== buffer.length || position !== null) {
            throw new Error("Bad read");
          }
          if (stdin.length === 0) {
            resumeStdin = () => fs.read(fd, buffer, offset, length, position, callback);
            return;
          }
          let first = stdin[0];
          let count = Math.max(0, Math.min(length, first.length - stdinPos));
          buffer.set(first.subarray(stdinPos, stdinPos + count), offset);
          stdinPos += count;
          if (stdinPos === first.length) {
            stdin.shift();
            stdinPos = 0;
          }
          callback(null, count);
        };
        let go = new globalThis.Go();
        go.argv = ["", \`--service=\${"0.27.3"}\`];
        tryToInstantiateModule(wasm, go).then(
          (instance) => {
            postMessage(null);
            go.run(instance);
          },
          (error) => {
            postMessage(error);
          }
        );
        return go;
      };
      function tryToInstantiateModule(wasm, go) {
        return __async(this, null, function* () {
          if (wasm instanceof WebAssembly.Module) {
            return WebAssembly.instantiate(wasm, go.importObject);
          }
          const res = yield fetch(wasm);
          if (!res.ok) throw new Error(\`Failed to download \${JSON.stringify(wasm)}\`);
          if ("instantiateStreaming" in WebAssembly && /^application\\/wasm($|;)/i.test(res.headers.get("Content-Type") || "")) {
            const result2 = yield WebAssembly.instantiateStreaming(res, go.importObject);
            return result2.instance;
          }
          const bytes = yield res.arrayBuffer();
          const result = yield WebAssembly.instantiate(bytes, go.importObject);
          return result.instance;
        });
      }
      return (m) => onmessage(m);
    })(postMessage)`],{type:"text/javascript"});W=new Worker(URL.createObjectURL(be))}else{let be=(Oe=>{var je=(ve,Te,oe)=>new Promise((Y,F)=>{var H=me=>{try{ue(oe.next(me))}catch(X){F(X)}},Q=me=>{try{ue(oe.throw(me))}catch(X){F(X)}},ue=me=>me.done?Y(me.value):Promise.resolve(me.value).then(H,Q);ue((oe=oe.apply(ve,Te)).next())});let Fe,xe={};for(let ve=self;ve;ve=Object.getPrototypeOf(ve))for(let Te of Object.getOwnPropertyNames(ve))Te in xe||Object.defineProperty(xe,Te,{get:()=>self[Te]});(()=>{const ve=()=>{const Y=new Error("not implemented");return Y.code="ENOSYS",Y};if(!xe.fs){let Y="";xe.fs={constants:{O_WRONLY:-1,O_RDWR:-1,O_CREAT:-1,O_TRUNC:-1,O_APPEND:-1,O_EXCL:-1,O_DIRECTORY:-1},writeSync(F,H){Y+=oe.decode(H);const Q=Y.lastIndexOf(`
`);return Q!=-1&&(console.log(Y.substring(0,Q)),Y=Y.substring(Q+1)),H.length},write(F,H,Q,ue,me,X){if(Q!==0||ue!==H.length||me!==null){X(ve());return}const ne=this.writeSync(F,H);X(null,ne)},chmod(F,H,Q){Q(ve())},chown(F,H,Q,ue){ue(ve())},close(F,H){H(ve())},fchmod(F,H,Q){Q(ve())},fchown(F,H,Q,ue){ue(ve())},fstat(F,H){H(ve())},fsync(F,H){H(null)},ftruncate(F,H,Q){Q(ve())},lchown(F,H,Q,ue){ue(ve())},link(F,H,Q){Q(ve())},lstat(F,H){H(ve())},mkdir(F,H,Q){Q(ve())},open(F,H,Q,ue){ue(ve())},read(F,H,Q,ue,me,X){X(ve())},readdir(F,H){H(ve())},readlink(F,H){H(ve())},rename(F,H,Q){Q(ve())},rmdir(F,H){H(ve())},stat(F,H){H(ve())},symlink(F,H,Q){Q(ve())},truncate(F,H,Q){Q(ve())},unlink(F,H){H(ve())},utimes(F,H,Q,ue){ue(ve())}}}if(xe.process||(xe.process={getuid(){return-1},getgid(){return-1},geteuid(){return-1},getegid(){return-1},getgroups(){throw ve()},pid:-1,ppid:-1,umask(){throw ve()},cwd(){throw ve()},chdir(){throw ve()}}),xe.path||(xe.path={resolve(...Y){return Y.join("/")}}),!xe.crypto)throw new Error("globalThis.crypto is not available, polyfill required (crypto.getRandomValues only)");if(!xe.performance)throw new Error("globalThis.performance is not available, polyfill required (performance.now only)");if(!xe.TextEncoder)throw new Error("globalThis.TextEncoder is not available, polyfill required");if(!xe.TextDecoder)throw new Error("globalThis.TextDecoder is not available, polyfill required");const Te=new TextEncoder("utf-8"),oe=new TextDecoder("utf-8");xe.Go=class{constructor(){this.argv=["js"],this.env={},this.exit=b=>{b!==0&&console.warn("exit code:",b)},this._exitPromise=new Promise(b=>{this._resolveExitPromise=b}),this._pendingEvent=null,this._scheduledTimeouts=new Map,this._nextCallbackTimeoutID=1;const Y=(b,z)=>{this.mem.setUint32(b+0,z,!0),this.mem.setUint32(b+4,Math.floor(z/4294967296),!0)},F=b=>{const z=this.mem.getUint32(b+0,!0),fe=this.mem.getInt32(b+4,!0);return z+fe*4294967296},H=b=>{const z=this.mem.getFloat64(b,!0);if(z===0)return;if(!isNaN(z))return z;const fe=this.mem.getUint32(b,!0);return this._values[fe]},Q=(b,z)=>{if(typeof z=="number"&&z!==0){if(isNaN(z)){this.mem.setUint32(b+4,2146959360,!0),this.mem.setUint32(b,0,!0);return}this.mem.setFloat64(b,z,!0);return}if(z===void 0){this.mem.setFloat64(b,0,!0);return}let le=this._ids.get(z);le===void 0&&(le=this._idPool.pop(),le===void 0&&(le=this._values.length),this._values[le]=z,this._goRefCounts[le]=0,this._ids.set(z,le)),this._goRefCounts[le]++;let _e=0;switch(typeof z){case"object":z!==null&&(_e=1);break;case"string":_e=2;break;case"symbol":_e=3;break;case"function":_e=4;break}this.mem.setUint32(b+4,2146959360|_e,!0),this.mem.setUint32(b,le,!0)},ue=b=>{const z=F(b+0),fe=F(b+8);return new Uint8Array(this._inst.exports.mem.buffer,z,fe)},me=b=>{const z=F(b+0),fe=F(b+8),le=new Array(fe);for(let _e=0;_e<fe;_e++)le[_e]=H(z+_e*8);return le},X=b=>{const z=F(b+0),fe=F(b+8);return oe.decode(new DataView(this._inst.exports.mem.buffer,z,fe))},ne=(b,z)=>(this._inst.exports.testExport0(),this._inst.exports.testExport(b,z)),he=Date.now()-performance.now();this.importObject={_gotest:{add:(b,z)=>b+z,callExport:ne},gojs:{"runtime.wasmExit":b=>{b>>>=0;const z=this.mem.getInt32(b+8,!0);this.exited=!0,delete this._inst,delete this._values,delete this._goRefCounts,delete this._ids,delete this._idPool,this.exit(z)},"runtime.wasmWrite":b=>{b>>>=0;const z=F(b+8),fe=F(b+16),le=this.mem.getInt32(b+24,!0);xe.fs.writeSync(z,new Uint8Array(this._inst.exports.mem.buffer,fe,le))},"runtime.resetMemoryDataView":b=>{this.mem=new DataView(this._inst.exports.mem.buffer)},"runtime.nanotime1":b=>{b>>>=0,Y(b+8,(he+performance.now())*1e6)},"runtime.walltime":b=>{b>>>=0;const z=new Date().getTime();Y(b+8,z/1e3),this.mem.setInt32(b+16,z%1e3*1e6,!0)},"runtime.scheduleTimeoutEvent":b=>{b>>>=0;const z=this._nextCallbackTimeoutID;this._nextCallbackTimeoutID++,this._scheduledTimeouts.set(z,setTimeout(()=>{for(this._resume();this._scheduledTimeouts.has(z);)console.warn("scheduleTimeoutEvent: missed timeout event"),this._resume()},F(b+8))),this.mem.setInt32(b+16,z,!0)},"runtime.clearTimeoutEvent":b=>{b>>>=0;const z=this.mem.getInt32(b+8,!0);clearTimeout(this._scheduledTimeouts.get(z)),this._scheduledTimeouts.delete(z)},"runtime.getRandomData":b=>{b>>>=0,crypto.getRandomValues(ue(b+8))},"syscall/js.finalizeRef":b=>{b>>>=0;const z=this.mem.getUint32(b+8,!0);if(this._goRefCounts[z]--,this._goRefCounts[z]===0){const fe=this._values[z];this._values[z]=null,this._ids.delete(fe),this._idPool.push(z)}},"syscall/js.stringVal":b=>{b>>>=0,Q(b+24,X(b+8))},"syscall/js.valueGet":b=>{b>>>=0;const z=Reflect.get(H(b+8),X(b+16));b=this._inst.exports.getsp()>>>0,Q(b+32,z)},"syscall/js.valueSet":b=>{b>>>=0,Reflect.set(H(b+8),X(b+16),H(b+32))},"syscall/js.valueDelete":b=>{b>>>=0,Reflect.deleteProperty(H(b+8),X(b+16))},"syscall/js.valueIndex":b=>{b>>>=0,Q(b+24,Reflect.get(H(b+8),F(b+16)))},"syscall/js.valueSetIndex":b=>{b>>>=0,Reflect.set(H(b+8),F(b+16),H(b+24))},"syscall/js.valueCall":b=>{b>>>=0;try{const z=H(b+8),fe=Reflect.get(z,X(b+16)),le=me(b+32),_e=Reflect.apply(fe,z,le);b=this._inst.exports.getsp()>>>0,Q(b+56,_e),this.mem.setUint8(b+64,1)}catch(z){b=this._inst.exports.getsp()>>>0,Q(b+56,z),this.mem.setUint8(b+64,0)}},"syscall/js.valueInvoke":b=>{b>>>=0;try{const z=H(b+8),fe=me(b+16),le=Reflect.apply(z,void 0,fe);b=this._inst.exports.getsp()>>>0,Q(b+40,le),this.mem.setUint8(b+48,1)}catch(z){b=this._inst.exports.getsp()>>>0,Q(b+40,z),this.mem.setUint8(b+48,0)}},"syscall/js.valueNew":b=>{b>>>=0;try{const z=H(b+8),fe=me(b+16),le=Reflect.construct(z,fe);b=this._inst.exports.getsp()>>>0,Q(b+40,le),this.mem.setUint8(b+48,1)}catch(z){b=this._inst.exports.getsp()>>>0,Q(b+40,z),this.mem.setUint8(b+48,0)}},"syscall/js.valueLength":b=>{b>>>=0,Y(b+16,parseInt(H(b+8).length))},"syscall/js.valuePrepareString":b=>{b>>>=0;const z=Te.encode(String(H(b+8)));Q(b+16,z),Y(b+24,z.length)},"syscall/js.valueLoadString":b=>{b>>>=0;const z=H(b+8);ue(b+16).set(z)},"syscall/js.valueInstanceOf":b=>{b>>>=0,this.mem.setUint8(b+24,H(b+8)instanceof H(b+16)?1:0)},"syscall/js.copyBytesToGo":b=>{b>>>=0;const z=ue(b+8),fe=H(b+32);if(!(fe instanceof Uint8Array||fe instanceof Uint8ClampedArray)){this.mem.setUint8(b+48,0);return}const le=fe.subarray(0,z.length);z.set(le),Y(b+40,le.length),this.mem.setUint8(b+48,1)},"syscall/js.copyBytesToJS":b=>{b>>>=0;const z=H(b+8),fe=ue(b+16);if(!(z instanceof Uint8Array||z instanceof Uint8ClampedArray)){this.mem.setUint8(b+48,0);return}const le=fe.subarray(0,z.length);z.set(le),Y(b+40,le.length),this.mem.setUint8(b+48,1)},debug:b=>{console.log(b)}}}}run(Y){return je(this,null,function*(){if(!(Y instanceof WebAssembly.Instance))throw new Error("Go.run: WebAssembly.Instance expected");this._inst=Y,this.mem=new DataView(this._inst.exports.mem.buffer),this._values=[NaN,0,null,!0,!1,xe,this],this._goRefCounts=new Array(this._values.length).fill(1/0),this._ids=new Map([[0,1],[null,2],[!0,3],[!1,4],[xe,5],[this,6]]),this._idPool=[],this.exited=!1;let F=4096;const H=he=>{const b=F,z=Te.encode(he+"\0");return new Uint8Array(this.mem.buffer,F,z.length).set(z),F+=z.length,F%8!==0&&(F+=8-F%8),b},Q=this.argv.length,ue=[];this.argv.forEach(he=>{ue.push(H(he))}),ue.push(0),Object.keys(this.env).sort().forEach(he=>{ue.push(H(`${he}=${this.env[he]}`))}),ue.push(0);const X=F;if(ue.forEach(he=>{this.mem.setUint32(F,he,!0),this.mem.setUint32(F+4,0,!0),F+=8}),F>=12288)throw new Error("total length of command line and environment variables exceeds limit");this._inst.exports.run(Q,X),this.exited&&this._resolveExitPromise(),yield this._exitPromise})}_resume(){if(this.exited)throw new Error("Go program has already exited");this._inst.exports.resume(),this.exited&&this._resolveExitPromise()}_makeFuncWrapper(Y){const F=this;return function(){const H={id:Y,this:this,args:arguments};return F._pendingEvent=H,F._resume(),H.result}}}})(),Fe=({data:ve})=>{let Te=new TextDecoder,oe=xe.fs,Y="";oe.writeSync=(me,X)=>{if(me===1)Oe(X);else if(me===2){Y+=Te.decode(X);let ne=Y.split(`
`);ne.length>1&&console.log(ne.slice(0,-1).join(`
`)),Y=ne[ne.length-1]}else throw new Error("Bad write");return X.length};let F=[],H,Q=0;Fe=({data:me})=>(me.length>0&&(F.push(me),H&&H()),ue),oe.read=(me,X,ne,he,b,z)=>{if(me!==0||ne!==0||he!==X.length||b!==null)throw new Error("Bad read");if(F.length===0){H=()=>oe.read(me,X,ne,he,b,z);return}let fe=F[0],le=Math.max(0,Math.min(he,fe.length-Q));X.set(fe.subarray(Q,Q+le),ne),Q+=le,Q===fe.length&&(F.shift(),Q=0),z(null,le)};let ue=new xe.Go;return ue.argv=["","--service=0.27.3"],Qe(ve,ue).then(me=>{Oe(null),ue.run(me)},me=>{Oe(me)}),ue};function Qe(ve,Te){return je(this,null,function*(){if(ve instanceof WebAssembly.Module)return WebAssembly.instantiate(ve,Te.importObject);const oe=yield fetch(ve);if(!oe.ok)throw new Error(`Failed to download ${JSON.stringify(ve)}`);if("instantiateStreaming"in WebAssembly&&/^application\/wasm($|;)/i.test(oe.headers.get("Content-Type")||""))return(yield WebAssembly.instantiateStreaming(oe,Te.importObject)).instance;const Y=yield oe.arrayBuffer();return(yield WebAssembly.instantiate(Y,Te.importObject)).instance})}return ve=>Fe(ve)})(Oe=>W.onmessage({data:Oe})),Le;W={onmessage:null,postMessage:Oe=>setTimeout(()=>{try{Le=be({data:Oe})}catch(je){ie(je)}}),terminate(){if(Le)for(let Oe of Le._scheduledTimeouts.values())clearTimeout(Oe)}}}let te,ye;const J=new Promise((be,Le)=>{te=be,ye=Le});W.onmessage=({data:be})=>{W.onmessage=({data:Le})=>Ue(Le),be?ye(be):te()},W.postMessage(E||new URL(x,location.href).toString());let{readFromStdout:Ue,service:Ce}=vs({writeToStdin(be){W.postMessage(be)},isSync:!1,hasFS:!1,esbuild:y});yield J,tn=()=>{W.terminate(),Ze=void 0,tn=void 0,ke=void 0},ke={build:be=>new Promise((Le,Oe)=>{ae.then(Oe),Ce.buildOrContext({callName:"build",refs:null,options:be,isTTY:!1,defaultWD:"/",callback:(je,Fe)=>je?Oe(je):Le(Fe)})}),context:be=>new Promise((Le,Oe)=>{ae.then(Oe),Ce.buildOrContext({callName:"context",refs:null,options:be,isTTY:!1,defaultWD:"/",callback:(je,Fe)=>je?Oe(je):Le(Fe)})}),transform:(be,Le)=>new Promise((Oe,je)=>{ae.then(je),Ce.transform({callName:"transform",refs:null,input:be,options:Le||{},isTTY:!1,fs:{readFile(Fe,xe){xe(new Error("Internal error"),null)},writeFile(Fe,xe){xe(null)}},callback:(Fe,xe)=>Fe?je(Fe):Oe(xe)})}),formatMessages:(be,Le)=>new Promise((Oe,je)=>{ae.then(je),Ce.formatMessages({callName:"formatMessages",refs:null,messages:be,options:Le,callback:(Fe,xe)=>Fe?je(Fe):Oe(xe)})}),analyzeMetafile:(be,Le)=>new Promise((Oe,je)=>{ae.then(je),Ce.analyzeMetafile({callName:"analyzeMetafile",refs:null,metafile:typeof be=="string"?be:JSON.stringify(be),options:Le,callback:(Fe,xe)=>Fe?je(Fe):Oe(xe)})})}}),xi=y})(typeof t=="object"?t:{set exports(n){(typeof self<"u"?self:this).esbuild=n}})}});function kr(e,t){let n=0,r=0,s=0;do{const o=e.next();s=la[o],n|=(s&31)<<r,r+=5}while(s&32);const i=n&1;return n>>>=1,i&&(n=-2147483648|-n),t+n}function jr(e,t,n){let r=t-n;r=r<0?-r<<1|1:r<<1;do{let s=r&31;r>>>=5,r>0&&(s|=32),e.write(aa[s])}while(r>0);return t}function El(e,t){return e.pos>=t?!1:e.peek()!==Ma}function Cd(e){const{length:t}=e,n=new su(e),r=[];let s=0,i=0,o=0,a=0,u=0;do{const f=n.indexOf(";"),m=[];let y=!0,g=0;for(s=0;n.pos<f;){let p;s=kr(n,s),s<g&&(y=!1),g=s,El(n,f)?(i=kr(n,i),o=kr(n,o),a=kr(n,a),El(n,f)?(u=kr(n,u),p=[s,i,o,a,u]):p=[s,i,o,a]):p=[s],m.push(p),n.pos++}y||Nd(m),r.push(m),n.pos=f+1}while(n.pos<=t);return r}function Nd(e){e.sort(Od)}function Od(e,t){return e[0]-t[0]}function Dd(e){const t=new ru;let n=0,r=0,s=0,i=0;for(let o=0;o<e.length;o++){const a=e[o];if(o>0&&t.write(nu),a.length===0)continue;let u=0;for(let f=0;f<a.length;f++){const m=a[f];f>0&&t.write(Ma),u=jr(t,m[0],u),m.length!==1&&(n=jr(t,m[1],n),r=jr(t,m[2],r),s=jr(t,m[3],s),m.length!==4&&(i=jr(t,m[4],i)))}}return t.flush()}var Ma,nu,qi,aa,la,Ki,Yi,ru,su,iu=ut({"node_modules/@jridgewell/sourcemap-codec/dist/sourcemap-codec.mjs"(){Ma=44,nu=59,qi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",aa=new Uint8Array(64),la=new Uint8Array(128);for(let e=0;e<qi.length;e++){const t=qi.charCodeAt(e);aa[e]=t,la[t]=e}Ki=1024*16,Yi=typeof TextDecoder<"u"?new TextDecoder:typeof Buffer<"u"?{decode(e){return Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString()}}:{decode(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}},ru=class{constructor(){this.pos=0,this.out="",this.buffer=new Uint8Array(Ki)}write(e){const{buffer:t}=this;t[this.pos++]=e,this.pos===Ki&&(this.out+=Yi.decode(t),this.pos=0)}flush(){const{buffer:e,out:t,pos:n}=this;return n>0?t+Yi.decode(e.subarray(0,n)):t}},su=class{constructor(e){this.pos=0,this.buffer=e}next(){return this.buffer.charCodeAt(this.pos++)}peek(){return this.buffer.charCodeAt(this.pos)}indexOf(e){const{buffer:t,pos:n}=this,r=t.indexOf(e,n);return r===-1?t.length:r}}}}),ou,ks,Ca,$n,si=ut({"lib/error.ts"(){ou=class extends Error{location;error;manifoldStack;constructor(e,t){if(super(void 0,t),this.cause=e,this.error=e.errors[0],this.error.location){let{file:n,line:r,column:s}=this.error.location;r--,this.manifoldStack=`${this.toString()}
    at ${n}:${r}:${s}`}}get name(){return"BundlerError"}get message(){return this.error.text}},ks=class extends Error{manifoldStack;cause;constructor(e,t,n){super(t??e.message,n),this.cause=e}get name(){return this.cause.name}},Ca=class extends Error{constructor(e,t){const n=t.map(r=>`\`${r.mimetype}\` (\`.${r.extension}\`)`).reduceRight((r,s,i,o)=>s+(i>0||o.length<=2?", or ":", ")+r);super(`Unsupported format \`${e}\`.  Must be one of ${n}`)}},$n=class extends Error{}}});function Pd(e){if(!e)return"";const t=e.lastIndexOf("/");return e.slice(0,t+1)}function Fd(e,t){const n=Pd(e),r=t?t+"/":"";return s=>(0,au.default)(r+(s||""),n)}function Ud(e,t){const n=bl(e,0);if(n===e.length)return e;t||(e=e.slice());for(let r=n;r<e.length;r=bl(e,r+1))e[r]=kd(e[r],t);return e}function bl(e,t){for(let n=t;n<e.length;n++)if(!Ld(e[n]))return n;return e.length}function Ld(e){for(let t=1;t<e.length;t++)if(e[t][Bn]<e[t-1][Bn])return!1;return!0}function kd(e,t){return t||(e=e.slice()),e.sort(jd)}function jd(e,t){return e[Bn]-t[Bn]}function Bd(e,t,n,r){for(;n<=r;){const s=n+(r-n>>1),i=e[s][Bn]-t;if(i===0)return fs=!0,s;i<0?n=s+1:r=s-1}return fs=!1,n-1}function $d(e,t,n){for(let r=n+1;r<e.length&&e[r][Bn]===t;n=r++);return n}function Vd(e,t,n){for(let r=n-1;r>=0&&e[r][Bn]===t;n=r--);return n}function Gd(){return{lastKey:-1,lastNeedle:-1,lastIndex:-1}}function zd(e,t,n,r){const{lastKey:s,lastNeedle:i,lastIndex:o}=n;let a=0,u=e.length-1;if(r===s){if(t===i)return fs=o!==-1&&e[o][Bn]===t,o;t>=i?a=o===-1?0:o:u=o}return n.lastKey=r,n.lastNeedle=t,n.lastIndex=Bd(e,t,a,u)}function Hd(e){return typeof e=="string"?JSON.parse(e):e}function Wd(e){var t;return(t=e)._decoded||(t._decoded=Cd(e._encoded))}function Xd(e,t){let{line:n,column:r,bias:s}=t;if(n--,n<0)throw new Error(hu);if(r<0)throw new Error(du);const i=Wd(e);if(n>=i.length)return Ms(null,null,null,null);const o=i[n],a=qd(o,e._decodedMemo,n,r,s||pu);if(a===-1)return Ms(null,null,null,null);const u=o[a];if(u.length===1)return Ms(null,null,null,null);const{names:f,resolvedSources:m}=e;return Ms(m[u[lu]],u[cu]+1,u[uu],u.length===5?f[u[fu]]:null)}function Ms(e,t,n,r){return{source:e,line:t,column:n,name:r}}function qd(e,t,n,r,s){let i=zd(e,r,t,n);return fs?i=(s===ca?$d:Vd)(e,r,i):s===ca&&i++,i===-1||i===e.length?-1:i}var au,Bn,lu,cu,uu,fu,fs,hu,du,ca,pu,gu,Kd=ut({"node_modules/@jridgewell/trace-mapping/dist/trace-mapping.mjs"(){iu(),au=ps(tu()),Bn=0,lu=1,cu=2,uu=3,fu=4,fs=!1,hu="`line` must be greater than 0 (lines start at line 1)",du="`column` must be greater than or equal to 0 (columns start at column 0)",ca=-1,pu=1,gu=class{constructor(e,t){const n=typeof e=="string";if(!n&&e._decodedMemo)return e;const r=Hd(e),{version:s,file:i,names:o,sourceRoot:a,sources:u,sourcesContent:f}=r;this.version=s,this.file=i,this.names=o||[],this.sourceRoot=a,this.sources=u,this.sourcesContent=f,this.ignoreList=r.ignoreList||r.x_google_ignoreList||void 0;const m=Fd(t,a);this.resolvedSources=u.map(m);const{mappings:y}=r;if(typeof y=="string")this._encoded=y,this._decoded=void 0;else if(Array.isArray(y))this._encoded=void 0,this._decoded=Ud(y,n);else throw r.sections?new Error("TraceMap passed sectioned source map, please use FlattenMap export instead"):new Error(`invalid source map: ${JSON.stringify(r)}`);this._decodedMemo=Gd(),this._bySources=void 0,this._bySourceMemos=void 0}}}}),Yd=Sr({"node_modules/convert-source-map/index.js"(e){Object.defineProperty(e,"commentRegex",{get:function(){return/^\s*?\/[\/\*][@#]\s+?sourceMappingURL=data:(((?:application|text)\/json)(?:;charset=([^;,]+?)?)?)?(?:;(base64))?,(.*?)$/mg}}),Object.defineProperty(e,"mapFileCommentRegex",{get:function(){return/(?:\/\/[@#][ \t]+?sourceMappingURL=([^\s'"`]+?)[ \t]*?$)|(?:\/\*[@#][ \t]+sourceMappingURL=([^*]+?)[ \t]*?(?:\*\/){1}[ \t]*?$)/mg}});var t;typeof Buffer<"u"?typeof Buffer.from=="function"?t=n:t=r:t=s;function n(g){return Buffer.from(g,"base64").toString()}function r(g){if(typeof value=="number")throw new TypeError("The value to decode must not be of type number.");return new Buffer(g,"base64").toString()}function s(g){return decodeURIComponent(escape(atob(g)))}function i(g){return g.split(",").pop()}function o(g,p){var M=e.mapFileCommentRegex.exec(g),R=M[1]||M[2];try{var g=p(R);return g!=null&&typeof g.catch=="function"?g.catch(h):g}catch(V){h(V)}function h(V){throw new Error("An error occurred while trying to read the map file at "+R+`
`+V.stack)}}function a(g,p){p=p||{},p.hasComment&&(g=i(g)),p.encoding==="base64"?g=t(g):p.encoding==="uri"&&(g=decodeURIComponent(g)),(p.isJSON||p.encoding)&&(g=JSON.parse(g)),this.sourcemap=g}a.prototype.toJSON=function(g){return JSON.stringify(this.sourcemap,null,g)},typeof Buffer<"u"?typeof Buffer.from=="function"?a.prototype.toBase64=u:a.prototype.toBase64=f:a.prototype.toBase64=m;function u(){var g=this.toJSON();return Buffer.from(g,"utf8").toString("base64")}function f(){var g=this.toJSON();if(typeof g=="number")throw new TypeError("The json to encode must not be of type number.");return new Buffer(g,"utf8").toString("base64")}function m(){var g=this.toJSON();return btoa(unescape(encodeURIComponent(g)))}a.prototype.toURI=function(){var g=this.toJSON();return encodeURIComponent(g)},a.prototype.toComment=function(g){var p,M,R;return g!=null&&g.encoding==="uri"?(p="",M=this.toURI()):(p=";base64",M=this.toBase64()),R="sourceMappingURL=data:application/json;charset=utf-8"+p+","+M,g!=null&&g.multiline?"/*# "+R+" */":"//# "+R},a.prototype.toObject=function(){return JSON.parse(this.toJSON())},a.prototype.addProperty=function(g,p){if(this.sourcemap.hasOwnProperty(g))throw new Error('property "'+g+'" already exists on the sourcemap, use set property instead');return this.setProperty(g,p)},a.prototype.setProperty=function(g,p){return this.sourcemap[g]=p,this},a.prototype.getProperty=function(g){return this.sourcemap[g]},e.fromObject=function(g){return new a(g)},e.fromJSON=function(g){return new a(g,{isJSON:!0})},e.fromURI=function(g){return new a(g,{encoding:"uri"})},e.fromBase64=function(g){return new a(g,{encoding:"base64"})},e.fromComment=function(g){var p,M;return g=g.replace(/^\/\*/g,"//").replace(/\*\/$/g,""),p=e.commentRegex.exec(g),M=p&&p[4]||"uri",new a(g,{encoding:M,hasComment:!0})};function y(g){return new a(g,{isJSON:!0})}e.fromMapFileComment=function(g,p){if(typeof p=="string")throw new Error("String directory paths are no longer supported with `fromMapFileComment`\nPlease review the Upgrading documentation at https://github.com/thlorenz/convert-source-map#upgrading");var M=o(g,p);return M!=null&&typeof M.then=="function"?M.then(y):y(M)},e.fromSource=function(g){var p=g.match(e.commentRegex);return p?e.fromComment(p.pop()):null},e.fromMapFileSource=function(g,p){if(typeof p=="string")throw new Error("String directory paths are no longer supported with `fromMapFileSource`\nPlease review the Upgrading documentation at https://github.com/thlorenz/convert-source-map#upgrading");var M=g.match(e.mapFileCommentRegex);return M?e.fromMapFileComment(M.pop(),p):null},e.removeComments=function(g){return g.replace(e.commentRegex,"")},e.removeMapFileComments=function(g){return g.replace(e.mapFileCommentRegex,"")},e.generateMapFileComment=function(g,p){var M="sourceMappingURL="+g;return p&&p.multiline?"/*# "+M+" */":"//# "+M}}}),_l,mu,ms,Rl,Il,Sl,yu,Na,Oa,ii=ut({"lib/util.ts"(){Kd(),_l=ps(Yd()),mu=()=>typeof self<"u"&&typeof self.document>"u",ms=()=>typeof process<"u"&&!!process?.versions?.node,Rl=e=>e.split(`
`).filter(t=>t.match(/<anonymous>/)).map(t=>{const n=t.matchAll(/:([0-9]+):([0-9]+)\)$/g).next().value,[r,s]=[parseInt(n[1]),parseInt(n[2])],i=t.match(/^\s+at\s([^\s]+)/)[1];return{line:r,column:s,methodName:i==="eval"?null:i}}),Il=e=>e.split(`
`).filter(t=>t.match(/AsyncFunction/)).map(t=>{const n=t.matchAll(/AsyncFunction:([0-9]+):([0-9]+)/g).next().value,[r,s]=[parseInt(n[1]),parseInt(n[2])],i=t.match(/^[^@]+/)[0];return{line:r,column:s,methodName:i==="anonymous"?null:i}}),Sl=e=>e.match(/^\s+at\s/gm)?Rl(e):e.match(/^([^@]+)@/gm)?Il(e):[],yu=(e,t,n=0)=>{const r=_l.default.fromSource(e);if(!r||!t.stack)return t.stack;const s=Sl(t.stack);if(!s.length)return t.stack;const i=new gu(r.toObject()),o=s.map(a=>{if(a.line+n<1)return a;const{line:u,column:f,source:m}=Xd(i,{line:a.line+n,column:a.column}),{methodName:y}=a;return{line:u,column:f+1,file:m,methodName:y}});return[t.toString(),...o.map(a=>{const u=`${a.file}:${a.line}:${a.column}`;return a.methodName?`    at ${a.methodName} (${u})`:`    at ${u}`})].reduce((a,u)=>`${a}
${u}`)},Na=(e,t)=>{let n=t.find(i=>i.extension===e);if(n||(n=t.find(i=>`.${i.extension}`===e),n))return n;const r=e.match(/(\.[^\.]+)$/);if(!r)return null;const[s]=r;return n=t.find(i=>i.extension===s),n||(n=t.find(i=>`.${i.extension}`===s),n)},Oa=(e,t)=>t.find(n=>n.mimetype===e)}}),an,Ji,Al,oi,vu=ut({"lib/manifold-gltf.ts"(){ar(),an="EXT_mesh_manifold",Ji="MERGE",Al=class Tu extends et{static EXTENSION_NAME=an;init(){Tu.EXTENSION_NAME=an,this.propertyType="ManifoldPrimitive",this.parentTypes=[k.MESH]}getDefaults(){return Object.assign(super.getDefaults(),{manifoldPrimitive:null,mergeIndices:null,mergeValues:null})}getMergeIndices(){return this.getRef("mergeIndices")}getMergeValues(){return this.getRef("mergeValues")}setMerge(t,n){if(t.getCount()!==n.getCount())throw new Error("merge vectors must be the same length.");return this.setRef("mergeIndices",t),this.setRef("mergeValues",n)}getRunIndex(){return this.get("runIndex")}setRunIndex(t){return this.set("runIndex",t)}setIndices(t){return this.setRef("indices",t)}getIndices(){return this.getRef("indices")}},oi=class extends Ke{extensionName=an;prewriteTypes=[k.ACCESSOR];static EXTENSION_NAME=an;createManifoldPrimitive(){return new Al(this.document.getGraph())}read(e){const{json:t}=e.jsonDoc;return(t.meshes||[]).forEach((r,s)=>{if(!r.extensions||!r.extensions[an])return;const i=e.meshes[s],o=this.createManifoldPrimitive();i.setExtension(an,o);const a=r.extensions[an];if(a.manifoldPrimitive){let u=0;const f=Array();f.push(u);for(const m of i.listPrimitives()){const y=m.getIndices();if(!y){console.log("Skipping non-indexed primitive ",m.getName());continue}u+=y.getCount(),f.push(u)}o.setRunIndex(f),o.setIndices(e.accessors[a.manifoldPrimitive.indices])}a.mergeIndices!=null&&a.mergeValues!=null&&o.setMerge(e.accessors[a.mergeIndices],e.accessors[a.mergeValues])}),this}prewrite(e){return this.document.getRoot().listMeshes().forEach(t=>{const n=t.getExtension(an);if(!n)return;const r=n.getIndices();e.addAccessorToUsageGroup(r,Yt.BufferViewUsage.ELEMENT_ARRAY_BUFFER);const s=n.getMergeIndices(),i=n.getMergeValues();!s||!i||(e.addAccessorToUsageGroup(s,Ji),e.addAccessorToUsageGroup(i,Ji))}),this}write(e){const{json:t}=e.jsonDoc;return this.document.getRoot().listMeshes().forEach(n=>{const r=n.getExtension(an);if(!r)return;const s=e.meshIndexMap.get(n),i=t.meshes[s],o=r.getRunIndex(),a=o.length-1;if(a!==i.primitives.length)throw new Error("The number of primitives must be exactly one less than the length of runIndex.");const u=e.accessorIndexMap.get(r.getMergeIndices()),f=e.accessorIndexMap.get(r.getMergeValues()),m=t.accessors[u],y=t.accessors[f],g=i.primitives[0],p={indices:e.accessorIndexMap.get(r.getIndices()),mode:g.mode,attributes:{POSITION:g.attributes.POSITION}},M=t.accessors[p.indices];if(M){m&&y&&(M.sparse={count:m.count,indices:{bufferView:m.bufferView,byteOffset:m.byteOffset,componentType:m.componentType},values:{bufferView:y.bufferView,byteOffset:y.byteOffset}});for(let R=0;R<a;++R){const h=t.accessors[i.primitives[R].indices];h.bufferView=M.bufferView,h.byteOffset=M.byteOffset+4*o[R],h.count=o[R+1]-o[R]}i.extensions=i.extensions||{},i.extensions[an]={manifoldPrimitive:p,mergeIndices:u,mergeValues:f}}}),this}}}});function Jd(){return{vkFormat:Nu,typeSize:1,pixelWidth:0,pixelHeight:0,pixelDepth:0,layerCount:0,faceCount:1,levelCount:0,supercompressionScheme:xu,levels:[],dataFormatDescriptor:[{vendorId:Eu,descriptorType:wu,versionNumber:bu,colorModel:_u,colorPrimaries:Mu,transferFunction:Au,flags:Su,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],keyValue:{},globalData:null}}function Ml(e){return new TextDecoder().decode(e)}function Zi(e){const t=new Uint8Array(e.buffer,e.byteOffset,At.length);if(t[0]!==At[0]||t[1]!==At[1]||t[2]!==At[2]||t[3]!==At[3]||t[4]!==At[4]||t[5]!==At[5]||t[6]!==At[6]||t[7]!==At[7]||t[8]!==At[8]||t[9]!==At[9]||t[10]!==At[10]||t[11]!==At[11])throw new Error("Missing KTX 2.0 identifier.");const n=Jd(),r=17*Uint32Array.BYTES_PER_ELEMENT,s=new br(e,At.length,r,!0);n.vkFormat=s._nextUint32(),n.typeSize=s._nextUint32(),n.pixelWidth=s._nextUint32(),n.pixelHeight=s._nextUint32(),n.pixelDepth=s._nextUint32(),n.layerCount=s._nextUint32(),n.faceCount=s._nextUint32(),n.levelCount=s._nextUint32(),n.supercompressionScheme=s._nextUint32();const i=s._nextUint32(),o=s._nextUint32(),a=s._nextUint32(),u=s._nextUint32(),f=s._nextUint64(),m=s._nextUint64(),y=Math.max(n.levelCount,1)*3*8,g=new br(e,At.length+r,y,!0);for(let nt=0,$e=Math.max(n.levelCount,1);nt<$e;nt++)n.levels.push({levelData:new Uint8Array(e.buffer,e.byteOffset+g._nextUint64(),g._nextUint64()),uncompressedByteLength:g._nextUint64()});const p=new br(e,i,o,!0);p._skip(4);const M=p._nextUint16(),R=p._nextUint16(),h=p._nextUint16(),V=p._nextUint16(),I=p._nextUint8(),C=p._nextUint8(),S=p._nextUint8(),G=p._nextUint8(),v=[p._nextUint8(),p._nextUint8(),p._nextUint8(),p._nextUint8()],w=[p._nextUint8(),p._nextUint8(),p._nextUint8(),p._nextUint8(),p._nextUint8(),p._nextUint8(),p._nextUint8(),p._nextUint8()],P={vendorId:M,descriptorType:R,versionNumber:h,colorModel:I,colorPrimaries:C,transferFunction:S,flags:G,texelBlockDimension:v,bytesPlane:w,samples:[]},Z=(V/4-6)/4;for(let nt=0;nt<Z;nt++){const $e={bitOffset:p._nextUint16(),bitLength:p._nextUint8(),channelType:p._nextUint8(),samplePosition:[p._nextUint8(),p._nextUint8(),p._nextUint8(),p._nextUint8()],sampleLower:Number.NEGATIVE_INFINITY,sampleUpper:Number.POSITIVE_INFINITY};$e.channelType&Cu?($e.sampleLower=p._nextInt32(),$e.sampleUpper=p._nextInt32()):($e.sampleLower=p._nextUint32(),$e.sampleUpper=p._nextUint32()),P.samples[nt]=$e}n.dataFormatDescriptor.length=0,n.dataFormatDescriptor.push(P);const Se=new br(e,a,u,!0);for(;Se._offset<u;){const nt=Se._nextUint32(),$e=Se._scan(nt),Ct=Ml($e);if(n.keyValue[Ct]=Se._nextUint8Array(nt-$e.byteLength-1),Ct.match(/^ktx/i)){const kt=Ml(n.keyValue[Ct]);n.keyValue[Ct]=kt.substring(0,kt.lastIndexOf("\0"))}const Sn=nt%4?4-nt%4:0;Se._skip(Sn)}if(m<=0)return n;const de=new br(e,f,m,!0),we=de._nextUint16(),Re=de._nextUint16(),Ie=de._nextUint32(),Ve=de._nextUint32(),wt=de._nextUint32(),Pt=de._nextUint32(),at=[];for(let nt=0,$e=Math.max(n.levelCount,1);nt<$e;nt++)at.push({imageFlags:de._nextUint32(),rgbSliceByteOffset:de._nextUint32(),rgbSliceByteLength:de._nextUint32(),alphaSliceByteOffset:de._nextUint32(),alphaSliceByteLength:de._nextUint32()});const Ft=f+de._offset,dt=Ft+Ie,pt=dt+Ve,Ge=pt+wt,O=new Uint8Array(e.buffer,e.byteOffset+Ft,Ie),qe=new Uint8Array(e.buffer,e.byteOffset+dt,Ve),In=new Uint8Array(e.buffer,e.byteOffset+pt,wt),Lt=new Uint8Array(e.buffer,e.byteOffset+Ge,Pt);return n.globalData={endpointCount:we,selectorCount:Re,imageDescs:at,endpointsData:O,selectorsData:qe,tablesData:In,extendedData:Lt},n}var xu,wu,Eu,bu,_u,Ru,Iu,Su,Au,Mu,Cu,Nu,br,At,Zd=ut({"node_modules/ktx-parse/dist/ktx-parse.modern.js"(){xu=0,wu=0,Eu=0,bu=2,_u=0,Ru=163,Iu=166,Su=0,Au=2,Mu=1,Cu=64,Nu=0,br=class{constructor(e,t,n,r){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(e.buffer,e.byteOffset+t,n),this._littleEndian=r,this._offset=0}_nextUint8(){const e=this._dataView.getUint8(this._offset);return this._offset+=1,e}_nextUint16(){const e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,e}_nextUint32(){const e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint64(){const e=this._dataView.getUint32(this._offset,this._littleEndian),t=this._dataView.getUint32(this._offset+4,this._littleEndian),n=e+2**32*t;return this._offset+=8,n}_nextInt32(){const e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint8Array(e){const t=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+this._offset,e);return this._offset+=e,t}_skip(e){return this._offset+=e,this}_scan(e,t=0){const n=this._offset;let r=0;for(;this._dataView.getUint8(this._offset)!==t&&r<e;)r++,this._offset++;return r<e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+n,r)}},At=[171,75,84,88,32,50,48,187,13,10,26,10]}});function jn(){return jn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jn.apply(null,arguments)}function Qd(e){return!e.extensions||!e.extensions[xt]?!1:!!e.extensions[xt].fallback}function ep(e,t,n,r){const{filter:s,bits:i}=r,o={array:e.getArray(),byteStride:e.getElementSize()*e.getComponentSize(),componentType:e.getComponentType(),normalized:e.getNormalized()};if(n!==_r.ATTRIBUTES)return o;if(s!==ct.NONE){let a=e.getNormalized()?tp(e):new Float32Array(o.array);switch(s){case ct.EXPONENTIAL:o.byteStride=e.getElementSize()*4,o.componentType=Pu,o.normalized=!1,o.array=t.encodeFilterExp(a,e.getCount(),o.byteStride,i);break;case ct.OCTAHEDRAL:o.byteStride=i>8?8:4,o.componentType=i>8?ua:Du,o.normalized=!0,a=e.getElementSize()===3?rp(a):a,o.array=t.encodeFilterOct(a,e.getCount(),o.byteStride,i);break;case ct.QUATERNION:o.byteStride=8,o.componentType=ua,o.normalized=!0,o.array=t.encodeFilterQuat(a,e.getCount(),o.byteStride,i);break;default:throw new Error("Invalid filter.")}o.min=e.getMin([]),o.max=e.getMax([]),e.getNormalized()&&(o.min=o.min.map(u=>qs(u,e.getComponentType())),o.max=o.max.map(u=>qs(u,e.getComponentType()))),o.normalized&&(o.min=o.min.map(u=>fa(u,o.componentType)),o.max=o.max.map(u=>fa(u,o.componentType)))}else o.byteStride%4&&(o.array=np(o.array,e.getElementSize()),o.byteStride=o.array.byteLength/e.getCount());return o}function tp(e){const t=e.getComponentType(),n=e.getArray(),r=new Float32Array(n.length);for(let s=0;s<n.length;s++)r[s]=qs(n[s],t);return r}function np(e,t){const r=Ne.padNumber(e.BYTES_PER_ELEMENT*t)/e.BYTES_PER_ELEMENT,s=e.length/t,i=new e.constructor(s*r);for(let o=0;o*t<e.length;o++)for(let a=0;a<t;a++)i[o*r+a]=e[o*t+a];return i}function rp(e){const t=new Float32Array(e.length*4/3);for(let n=0,r=e.length/3;n<r;n++)t[n*4]=e[n*3],t[n*4+1]=e[n*3+1],t[n*4+2]=e[n*3+2];return t}function sp(e,t){return t===Yt.BufferViewUsage.ELEMENT_ARRAY_BUFFER?e.listParents().some(r=>r instanceof _n&&r.getMode()===_n.Mode.TRIANGLES)?_r.TRIANGLES:_r.INDICES:_r.ATTRIBUTES}function ip(e,t){const n=t.getGraph().listParentEdges(e).filter(r=>!(r.getParent()instanceof ta));for(const r of n){const s=r.getName(),i=r.getAttributes().key||"",o=r.getParent().propertyType===k.PRIMITIVE_TARGET;if(s==="indices")return{filter:ct.NONE};if(s==="attributes"){if(i==="POSITION")return{filter:ct.NONE};if(i==="TEXCOORD_0")return{filter:ct.NONE};if(i.startsWith("JOINTS_"))return{filter:ct.NONE};if(i.startsWith("WEIGHTS_"))return{filter:ct.NONE};if(i==="NORMAL"||i==="TANGENT")return o?{filter:ct.NONE}:{filter:ct.OCTAHEDRAL,bits:8}}if(s==="output"){const a=Ou(e);return a==="rotation"?{filter:ct.QUATERNION,bits:16}:a==="translation"?{filter:ct.EXPONENTIAL,bits:12}:a==="scale"?{filter:ct.EXPONENTIAL,bits:12}:{filter:ct.NONE}}if(s==="input")return{filter:ct.NONE};if(s==="inverseBindMatrices")return{filter:ct.NONE}}return{filter:ct.NONE}}function Ou(e){for(const t of e.listParents())if(t instanceof qr){for(const n of t.listParents())if(n instanceof Qr)return n.getTargetPath()}return null}function Cl(e,t){if(e.byteLength<4+t)return null;const n=e.getUint32(t);return e.byteLength<n+t||n<8?null:{type:Ne.decodeText(new Uint8Array(e.buffer,e.byteOffset+t+4,4)),start:t+8,end:t+n}}function op(e,t){const n=new mt.DecoderBuffer;try{if(n.Init(t,t.length),e.GetEncodedGeometryType(n)!==mt.TRIANGULAR_MESH)throw new Error(`[${it}] Unknown geometry type.`);const s=new mt.Mesh;if(!e.DecodeBufferToMesh(n,s).ok()||s.ptr===0)throw new Error(`[${it}] Decoding failure.`);return s}finally{mt.destroy(n)}}function ap(e,t){const r=t.num_faces()*3;let s,i;if(t.num_points()<=65534){const o=r*Uint16Array.BYTES_PER_ELEMENT;s=mt._malloc(o),e.GetTrianglesUInt16Array(t,o,s),i=new Uint16Array(mt.HEAPU16.buffer,s,r).slice()}else{const o=r*Uint32Array.BYTES_PER_ELEMENT;s=mt._malloc(o),e.GetTrianglesUInt32Array(t,o,s),i=new Uint32Array(mt.HEAPU32.buffer,s,r).slice()}return mt._free(s),i}function lp(e,t,n,r){const s=Uu[r.componentType],i=Fu[r.componentType],o=n.num_components(),u=t.num_points()*o,f=u*i.BYTES_PER_ELEMENT,m=mt._malloc(f);e.GetAttributeDataArrayForAllPoints(t,n,s,f,m);const y=new i(mt.HEAPF32.buffer,m,u).slice();return mt._free(m),y}function cp(e){mt=e,Fu={[ge.ComponentType.FLOAT]:Float32Array,[ge.ComponentType.UNSIGNED_INT]:Uint32Array,[ge.ComponentType.UNSIGNED_SHORT]:Uint16Array,[ge.ComponentType.UNSIGNED_BYTE]:Uint8Array,[ge.ComponentType.SHORT]:Int16Array,[ge.ComponentType.BYTE]:Int8Array},Uu={[ge.ComponentType.FLOAT]:mt.DT_FLOAT32,[ge.ComponentType.UNSIGNED_INT]:mt.DT_UINT32,[ge.ComponentType.UNSIGNED_SHORT]:mt.DT_UINT16,[ge.ComponentType.UNSIGNED_BYTE]:mt.DT_UINT8,[ge.ComponentType.SHORT]:mt.DT_INT16,[ge.ComponentType.BYTE]:mt.DT_INT8}}function up(e){qt=e}function fp(e,t=da){const n=jn({},da,t);n.quantizationBits=jn({},ha,t.quantizationBits);const r=new qt.MeshBuilder,s=new qt.Mesh,i=new qt.ExpertEncoder(s),o={},a=new qt.DracoInt8Array,u=e.listTargets().length>0;let f=!1;for(const R of e.listSemantics()){const h=e.getAttribute(R);if(h.getSparse()){f=!0;continue}const V=hp(R),I=dp(r,h.getComponentType(),s,qt[V],h.getCount(),h.getElementSize(),h.getArray());if(I===-1)throw new Error(`Error compressing "${R}" attribute.`);if(o[R]=I,n.quantizationVolume==="mesh"||R!=="POSITION")i.SetAttributeQuantization(I,n.quantizationBits[V]);else if(typeof n.quantizationVolume=="object"){const{quantizationVolume:C}=n,S=Math.max(C.max[0]-C.min[0],C.max[1]-C.min[1],C.max[2]-C.min[2]);i.SetAttributeExplicitQuantization(I,n.quantizationBits[V],h.getElementSize(),C.min,S)}else throw new Error("Invalid quantization volume state.")}const m=e.getIndices();if(!m)throw new Ks("Primitive must have indices.");r.AddFacesToMesh(s,m.getCount()/3,m.getArray()),i.SetSpeedOptions(n.encodeSpeed,n.decodeSpeed),i.SetTrackEncodedProperties(!0),n.method===Zr.SEQUENTIAL||u||f?i.SetEncodingMethod(qt.MESH_SEQUENTIAL_ENCODING):i.SetEncodingMethod(qt.MESH_EDGEBREAKER_ENCODING);const y=i.EncodeToDracoBuffer(!(u||f),a);if(y<=0)throw new Ks("Error applying Draco compression.");const g=new Uint8Array(y);for(let R=0;R<y;++R)g[R]=a.GetValue(R);const p=i.GetNumberOfEncodedPoints(),M=i.GetNumberOfEncodedFaces()*3;return qt.destroy(a),qt.destroy(s),qt.destroy(r),qt.destroy(i),{numVertices:p,numIndices:M,data:g,attributeIDs:o}}function hp(e){return e==="POSITION"?Zt.POSITION:e==="NORMAL"?Zt.NORMAL:e.startsWith("COLOR_")?Zt.COLOR:e.startsWith("TEXCOORD_")?Zt.TEX_COORD:Zt.GENERIC}function dp(e,t,n,r,s,i,o){switch(t){case ge.ComponentType.UNSIGNED_BYTE:return e.AddUInt8Attribute(n,r,s,i,o);case ge.ComponentType.BYTE:return e.AddInt8Attribute(n,r,s,i,o);case ge.ComponentType.UNSIGNED_SHORT:return e.AddUInt16Attribute(n,r,s,i,o);case ge.ComponentType.SHORT:return e.AddInt16Attribute(n,r,s,i,o);case ge.ComponentType.UNSIGNED_INT:return e.AddUInt32Attribute(n,r,s,i,o);case ge.ComponentType.FLOAT:return e.AddFloatAttribute(n,r,s,i,o);default:throw new Error(`Unexpected component type, "${t}".`)}}function pp(e){const t=e.getLogger(),n=new Set,r=new Set;let s=0,i=0;for(const y of e.getRoot().listMeshes())for(const g of y.listPrimitives())g.getIndices()?g.getMode()!==_n.Mode.TRIANGLES?(r.add(g),i++):n.add(g):(r.add(g),s++);s>0&&t.warn(`[${it}] Skipping Draco compression of ${s} non-indexed primitives.`),i>0&&t.warn(`[${it}] Skipping Draco compression of ${i} non-TRIANGLES primitives.`);const o=e.getRoot().listAccessors(),a=new Map;for(let y=0;y<o.length;y++)a.set(o[y],y);const u=new Map,f=new Set,m=new Map;for(const y of Array.from(n)){let g=Nl(y,a);if(f.has(g)){m.set(y,g);continue}if(u.has(y.getIndices())){const p=y.getIndices(),M=p.clone();a.set(M,e.getRoot().listAccessors().length-1),y.swap(p,M)}for(const p of y.listAttributes())if(u.has(p)){const M=p.clone();a.set(M,e.getRoot().listAccessors().length-1),y.swap(p,M)}g=Nl(y,a),f.add(g),m.set(y,g),u.set(y.getIndices(),g);for(const p of y.listAttributes())u.set(p,g)}for(const y of Array.from(u.keys())){const g=new Set(y.listParents().map(p=>p.propertyType));if(g.size!==2||!g.has(k.PRIMITIVE)||!g.has(k.ROOT))throw new Error(`[${it}] Compressed accessors must only be used as indices or vertex attributes.`)}for(const y of Array.from(n)){const g=m.get(y),p=y.getIndices();if(u.get(p)!==g||y.listAttributes().some(M=>u.get(M)!==g))throw new Error(`[${it}] Draco primitives must share all, or no, accessors.`)}for(const y of Array.from(r)){const g=y.getIndices();if(u.has(g)||y.listAttributes().some(p=>u.has(p)))throw new Error(`[${it}] Accessor cannot be shared by compressed and uncompressed primitives.`)}return m}function Nl(e,t){const n=[],r=e.getIndices();n.push(t.get(r));for(const s of e.listAttributes())n.push(t.get(s));return n.sort().join("|")}function Qi(e){return JSON.parse(JSON.stringify(e))}var cn,xt,Tr,xr,it,Vt,un,fn,hn,dn,pn,gn,mn,yn,vn,Tn,xn,Fn,wn,bt,eo,En,wr,bn,Gt,Cs,to,no,Br,_r,ct,Du,ua,Pu,fa,qs,ro,Ns,Ol,so,Dl,io,mt,Fu,Uu,qt,Zr,Zt,ha,da,Ks,Os,$r,oo,Pl,Fl,Ul,ao,lo,co,uo,Ll,fo,ho,kl,jl,Bl,$l,po,go,mo,yo,vo,To,xo,wo,Vl,Gl,Eo,bo,_o,Ro,Io,So,Ao,Mo,zl,Hl,Wl,Xl,Co,No,ql,Kl,Yl,Jl,Oo,Do,Zl,Po,Fo,Uo,js,Lo,ko,Ds,jo,Ql,Bo,$o,Vo,Go,zo,ec,Ho,Wo,Xo,tc,qo,Ko,pa,Lu=ut({"node_modules/@gltf-transform/extensions/dist/index.modern.js"(){ar(),Zd(),cn="EXT_mesh_gpu_instancing",xt="EXT_meshopt_compression",Tr="EXT_texture_webp",xr="EXT_texture_avif",it="KHR_draco_mesh_compression",Vt="KHR_lights_punctual",un="KHR_materials_anisotropy",fn="KHR_materials_clearcoat",hn="KHR_materials_diffuse_transmission",dn="KHR_materials_dispersion",pn="KHR_materials_emissive_strength",gn="KHR_materials_ior",mn="KHR_materials_iridescence",yn="KHR_materials_pbrSpecularGlossiness",vn="KHR_materials_sheen",Tn="KHR_materials_specular",xn="KHR_materials_transmission",Fn="KHR_materials_unlit",wn="KHR_materials_volume",bt="KHR_materials_variants",eo="KHR_mesh_quantization",En="KHR_node_visibility",wr="KHR_texture_basisu",bn="KHR_texture_transform",Gt="KHR_xmp_json_ld",Cs="INSTANCE_ATTRIBUTE",to=class extends et{init(){this.extensionName=cn,this.propertyType="InstancedMesh",this.parentTypes=[k.NODE]}getDefaults(){return Object.assign(super.getDefaults(),{attributes:new Jt})}getAttribute(e){return this.getRefMap("attributes",e)}setAttribute(e,t){return this.setRefMap("attributes",e,t,{usage:Cs})}listAttributes(){return this.listRefMapValues("attributes")}listSemantics(){return this.listRefMapKeys("attributes")}},to.EXTENSION_NAME=cn,no=class extends Ke{constructor(...e){super(...e),this.extensionName=cn,this.provideTypes=[k.NODE],this.prewriteTypes=[k.ACCESSOR]}createInstancedMesh(){return new to(this.document.getGraph())}read(e){return(e.jsonDoc.json.nodes||[]).forEach((r,s)=>{if(!r.extensions||!r.extensions[cn])return;const i=r.extensions[cn],o=this.createInstancedMesh();for(const a in i.attributes)o.setAttribute(a,e.accessors[i.attributes[a]]);e.nodes[s].setExtension(cn,o)}),this}prewrite(e){e.accessorUsageGroupedByParent.add(Cs);for(const t of this.properties)for(const n of t.listAttributes())e.addAccessorToUsageGroup(n,Cs);return this}write(e){const t=e.jsonDoc;return this.document.getRoot().listNodes().forEach(n=>{const r=n.getExtension(cn);if(r){const s=e.nodeIndexMap.get(n),i=t.json.nodes[s],o={attributes:{}};r.listSemantics().forEach(a=>{const u=r.getAttribute(a);o.attributes[a]=e.accessorIndexMap.get(u)}),i.extensions=i.extensions||{},i.extensions[cn]=o}}),this}},no.EXTENSION_NAME=cn,(function(e){e.QUANTIZE="quantize",e.FILTER="filter"})(Br||(Br={})),(function(e){e.ATTRIBUTES="ATTRIBUTES",e.TRIANGLES="TRIANGLES",e.INDICES="INDICES"})(_r||(_r={})),(function(e){e.NONE="NONE",e.OCTAHEDRAL="OCTAHEDRAL",e.QUATERNION="QUATERNION",e.EXPONENTIAL="EXPONENTIAL"})(ct||(ct={})),{BYTE:Du,SHORT:ua,FLOAT:Pu}=ge.ComponentType,{encodeNormalizedInt:fa,decodeNormalizedInt:qs}=st,ro={method:Br.QUANTIZE},Ns=class extends Ke{constructor(...e){super(...e),this.extensionName=xt,this.prereadTypes=[k.BUFFER,k.PRIMITIVE],this.prewriteTypes=[k.BUFFER,k.ACCESSOR],this.readDependencies=["meshopt.decoder"],this.writeDependencies=["meshopt.encoder"],this._decoder=null,this._decoderFallbackBufferMap=new Map,this._encoder=null,this._encoderOptions=ro,this._encoderFallbackBuffer=null,this._encoderBufferViews={},this._encoderBufferViewData={},this._encoderBufferViewAccessors={}}install(e,t){return e==="meshopt.decoder"&&(this._decoder=t),e==="meshopt.encoder"&&(this._encoder=t),this}setEncoderOptions(e){return this._encoderOptions=jn({},ro,e),this}preread(e,t){if(!this._decoder){if(!this.isRequired())return this;throw new Error(`[${xt}] Please install extension dependency, "meshopt.decoder".`)}if(!this._decoder.supported){if(!this.isRequired())return this;throw new Error(`[${xt}]: Missing WASM support.`)}return t===k.BUFFER?this._prereadBuffers(e):t===k.PRIMITIVE&&this._prereadPrimitives(e),this}_prereadBuffers(e){const t=e.jsonDoc;(t.json.bufferViews||[]).forEach((r,s)=>{if(!r.extensions||!r.extensions[xt])return;const i=r.extensions[xt],o=i.byteOffset||0,a=i.byteLength||0,u=i.count,f=i.byteStride,m=new Uint8Array(u*f),y=t.json.buffers[i.buffer],g=y.uri?t.resources[y.uri]:t.resources[er],p=Ne.toView(g,o,a);this._decoder.decodeGltfBuffer(m,u,f,p,i.mode,i.filter),e.bufferViews[s]=m})}_prereadPrimitives(e){const t=e.jsonDoc;(t.json.bufferViews||[]).forEach(r=>{if(!r.extensions||!r.extensions[xt])return;const s=r.extensions[xt],i=e.buffers[s.buffer],o=e.buffers[r.buffer],a=t.json.buffers[r.buffer];Qd(a)&&this._decoderFallbackBufferMap.set(o,i)})}read(e){if(!this.isRequired())return this;for(const[t,n]of this._decoderFallbackBufferMap){for(const r of t.listParents())r instanceof ge&&r.swap(t,n);t.dispose()}return this}prewrite(e,t){return t===k.ACCESSOR?this._prewriteAccessors(e):t===k.BUFFER&&this._prewriteBuffers(e),this}_prewriteAccessors(e){const t=e.jsonDoc.json,n=this._encoder,r=this._encoderOptions,s=this.document.getGraph(),i=this.document.createBuffer(),o=this.document.getRoot().listBuffers().indexOf(i);let a=1;const u=new Map,f=m=>{for(const y of s.listParents(m)){if(y.propertyType===k.ROOT)continue;let g=u.get(m);return g===void 0&&u.set(m,g=a++),g}return-1};this._encoderFallbackBuffer=i,this._encoderBufferViews={},this._encoderBufferViewData={},this._encoderBufferViewAccessors={};for(const m of this.document.getRoot().listAccessors()){if(Ou(m)==="weights"||m.getSparse())continue;const y=e.getAccessorUsage(m),g=e.accessorUsageGroupedByParent.has(y)?f(m):null,p=sp(m,y),M=r.method===Br.FILTER?ip(m,this.document):{filter:ct.NONE},R=ep(m,n,p,M),{array:h,byteStride:V}=R,I=m.getBuffer();if(!I)throw new Error(`${xt}: Missing buffer for accessor.`);const C=this.document.getRoot().listBuffers().indexOf(I),S=[y,g,p,M.filter,V,C].join(":");let G=this._encoderBufferViews[S],v=this._encoderBufferViewData[S],w=this._encoderBufferViewAccessors[S];(!G||!v)&&(w=this._encoderBufferViewAccessors[S]=[],v=this._encoderBufferViewData[S]=[],G=this._encoderBufferViews[S]={buffer:o,target:Yt.USAGE_TO_TARGET[y],byteOffset:0,byteLength:0,byteStride:y===Yt.BufferViewUsage.ARRAY_BUFFER?V:void 0,extensions:{[xt]:{buffer:C,byteOffset:0,byteLength:0,mode:p,filter:M.filter!==ct.NONE?M.filter:void 0,byteStride:V,count:0}}});const N=e.createAccessorDef(m);N.componentType=R.componentType,N.normalized=R.normalized,N.byteOffset=G.byteLength,N.min&&R.min&&(N.min=R.min),N.max&&R.max&&(N.max=R.max),e.accessorIndexMap.set(m,t.accessors.length),t.accessors.push(N),w.push(N),v.push(new Uint8Array(h.buffer,h.byteOffset,h.byteLength)),G.byteLength+=h.byteLength,G.extensions.EXT_meshopt_compression.count+=m.getCount()}}_prewriteBuffers(e){const t=this._encoder;for(const n in this._encoderBufferViews){const r=this._encoderBufferViews[n],s=this._encoderBufferViewData[n],i=this.document.getRoot().listBuffers()[r.extensions[xt].buffer],o=e.otherBufferViews.get(i)||[],{count:a,byteStride:u,mode:f}=r.extensions[xt],m=Ne.concat(s),y=t.encodeGltfBuffer(m,a,u,f),g=Ne.pad(y);r.extensions[xt].byteLength=y.byteLength,s.length=0,s.push(g),o.push(g),e.otherBufferViews.set(i,o)}}write(e){let t=0;for(const i in this._encoderBufferViews){const o=this._encoderBufferViews[i],a=this._encoderBufferViewData[i][0],u=e.otherBufferViewsIndexMap.get(a),f=this._encoderBufferViewAccessors[i];for(const p of f)p.bufferView=u;const m=e.jsonDoc.json.bufferViews[u],y=m.byteOffset||0;Object.assign(m,o),m.byteOffset=t;const g=m.extensions[xt];g.byteOffset=y,t+=Ne.padNumber(o.byteLength)}const n=this._encoderFallbackBuffer,r=e.bufferIndexMap.get(n),s=e.jsonDoc.json.buffers[r];return s.byteLength=t,s.extensions={[xt]:{fallback:!0}},n.dispose(),this}},Ns.EXTENSION_NAME=xt,Ns.EncoderMethod=Br,Ol=class{match(e){return e.length>=12&&Ne.decodeText(e.slice(4,12))==="ftypavif"}getSize(e){if(!this.match(e))return null;const t=new DataView(e.buffer,e.byteOffset,e.byteLength);let n=Cl(t,0);if(!n)return null;let r=n.end;for(;n=Cl(t,r);)if(n.type==="meta")r=n.start+4;else if(n.type==="iprp"||n.type==="ipco")r=n.start;else{if(n.type==="ispe")return[t.getUint32(n.start+4),t.getUint32(n.start+8)];if(n.type==="mdat")break;r=n.end}return null}getChannels(e){return 4}},so=class extends Ke{constructor(...e){super(...e),this.extensionName=xr,this.prereadTypes=[k.TEXTURE]}static register(){ln.registerFormat("image/avif",new Ol)}preread(e){return(e.jsonDoc.json.textures||[]).forEach(n=>{n.extensions&&n.extensions[xr]&&(n.source=n.extensions[xr].source)}),this}read(e){return this}write(e){const t=e.jsonDoc;return this.document.getRoot().listTextures().forEach(n=>{if(n.getMimeType()==="image/avif"){const r=e.imageIndexMap.get(n);(t.json.textures||[]).forEach(i=>{i.source===r&&(i.extensions=i.extensions||{},i.extensions[xr]={source:i.source},delete i.source)})}}),this}},so.EXTENSION_NAME=xr,Dl=class{match(e){return e.length>=12&&e[8]===87&&e[9]===69&&e[10]===66&&e[11]===80}getSize(e){const t=Ne.decodeText(e.slice(0,4)),n=Ne.decodeText(e.slice(8,12));if(t!=="RIFF"||n!=="WEBP")return null;const r=new DataView(e.buffer,e.byteOffset);let s=12;for(;s<r.byteLength;){const i=Ne.decodeText(new Uint8Array([r.getUint8(s),r.getUint8(s+1),r.getUint8(s+2),r.getUint8(s+3)])),o=r.getUint32(s+4,!0);if(i==="VP8 "){const a=r.getInt16(s+14,!0)&16383,u=r.getInt16(s+16,!0)&16383;return[a,u]}else if(i==="VP8L"){const a=r.getUint8(s+9),u=r.getUint8(s+10),f=r.getUint8(s+11),m=r.getUint8(s+12),y=1+((u&63)<<8|a),g=1+((m&15)<<10|f<<2|(u&192)>>6);return[y,g]}s+=8+o+o%2}return null}getChannels(e){return 4}},io=class extends Ke{constructor(...e){super(...e),this.extensionName=Tr,this.prereadTypes=[k.TEXTURE]}static register(){ln.registerFormat("image/webp",new Dl)}preread(e){return(e.jsonDoc.json.textures||[]).forEach(n=>{n.extensions&&n.extensions[Tr]&&(n.source=n.extensions[Tr].source)}),this}read(e){return this}write(e){const t=e.jsonDoc;return this.document.getRoot().listTextures().forEach(n=>{if(n.getMimeType()==="image/webp"){const r=e.imageIndexMap.get(n);(t.json.textures||[]).forEach(i=>{i.source===r&&(i.extensions=i.extensions||{},i.extensions[Tr]={source:i.source},delete i.source)})}}),this}},io.EXTENSION_NAME=Tr,(function(e){e[e.EDGEBREAKER=1]="EDGEBREAKER",e[e.SEQUENTIAL=0]="SEQUENTIAL"})(Zr||(Zr={})),(function(e){e.POSITION="POSITION",e.NORMAL="NORMAL",e.COLOR="COLOR",e.TEX_COORD="TEX_COORD",e.GENERIC="GENERIC"})(Zt||(Zt={})),ha={[Zt.POSITION]:14,[Zt.NORMAL]:10,[Zt.COLOR]:8,[Zt.TEX_COORD]:12,[Zt.GENERIC]:12},da={decodeSpeed:5,encodeSpeed:5,method:Zr.EDGEBREAKER,quantizationBits:ha,quantizationVolume:"mesh"},Ks=class extends Error{},Os=class extends Ke{constructor(...e){super(...e),this.extensionName=it,this.prereadTypes=[k.PRIMITIVE],this.prewriteTypes=[k.ACCESSOR],this.readDependencies=["draco3d.decoder"],this.writeDependencies=["draco3d.encoder"],this._decoderModule=null,this._encoderModule=null,this._encoderOptions={}}install(e,t){return e==="draco3d.decoder"&&(this._decoderModule=t,cp(this._decoderModule)),e==="draco3d.encoder"&&(this._encoderModule=t,up(this._encoderModule)),this}setEncoderOptions(e){return this._encoderOptions=e,this}preread(e){if(!this._decoderModule)throw new Error(`[${it}] Please install extension dependency, "draco3d.decoder".`);const t=this.document.getLogger(),n=e.jsonDoc,r=new Map;try{const s=n.json.meshes||[];for(const i of s)for(const o of i.primitives){if(!o.extensions||!o.extensions[it])continue;const a=o.extensions[it];let[u,f]=r.get(a.bufferView)||[];if(!f||!u){const m=n.json.bufferViews[a.bufferView],y=n.json.buffers[m.buffer],g=y.uri?n.resources[y.uri]:n.resources[er],p=m.byteOffset||0,M=m.byteLength,R=Ne.toView(g,p,M);u=new this._decoderModule.Decoder,f=op(u,R),r.set(a.bufferView,[u,f]),t.debug(`[${it}] Decompressed ${R.byteLength} bytes.`)}for(const m in a.attributes){const y=e.jsonDoc.json.accessors[o.attributes[m]],g=u.GetAttributeByUniqueId(f,a.attributes[m]),p=lp(u,f,g,y);e.accessors[o.attributes[m]].setArray(p)}o.indices!==void 0&&e.accessors[o.indices].setArray(ap(u,f))}}finally{for(const[s,i]of Array.from(r.values()))this._decoderModule.destroy(s),this._decoderModule.destroy(i)}return this}read(e){return this}prewrite(e,t){if(!this._encoderModule)throw new Error(`[${it}] Please install extension dependency, "draco3d.encoder".`);const n=this.document.getLogger();n.debug(`[${it}] Compression options: ${JSON.stringify(this._encoderOptions)}`);const r=pp(this.document),s=new Map;let i="mesh";this._encoderOptions.quantizationVolume==="scene"&&(this.document.getRoot().listScenes().length!==1?n.warn(`[${it}]: quantizationVolume=scene requires exactly 1 scene.`):i=qh(this.document.getRoot().listScenes().pop()));for(const o of Array.from(r.keys())){const a=r.get(o);if(!a)throw new Error("Unexpected primitive.");if(s.has(a)){s.set(a,s.get(a));continue}const u=o.getIndices(),f=e.jsonDoc.json.accessors;let m;try{m=fp(o,jn({},this._encoderOptions,{quantizationVolume:i}))}catch(p){if(p instanceof Ks){n.warn(`[${it}]: ${p.message} Skipping primitive compression.`);continue}throw p}s.set(a,m);const y=e.createAccessorDef(u);y.count=m.numIndices,e.accessorIndexMap.set(u,f.length),f.push(y),m.numVertices>65534&&ge.getComponentSize(y.componentType)<=2?y.componentType=ge.ComponentType.UNSIGNED_INT:m.numVertices>254&&ge.getComponentSize(y.componentType)<=1&&(y.componentType=ge.ComponentType.UNSIGNED_SHORT);for(const p of o.listSemantics()){const M=o.getAttribute(p);if(m.attributeIDs[p]===void 0)continue;const R=e.createAccessorDef(M);R.count=m.numVertices,e.accessorIndexMap.set(M,f.length),f.push(R)}const g=o.getAttribute("POSITION").getBuffer()||this.document.getRoot().listBuffers()[0];e.otherBufferViews.has(g)||e.otherBufferViews.set(g,[]),e.otherBufferViews.get(g).push(m.data)}return n.debug(`[${it}] Compressed ${r.size} primitives.`),e.extensionData[it]={primitiveHashMap:r,primitiveEncodingMap:s},this}write(e){const t=e.extensionData[it];for(const n of this.document.getRoot().listMeshes()){const r=e.jsonDoc.json.meshes[e.meshIndexMap.get(n)];for(let s=0;s<n.listPrimitives().length;s++){const i=n.listPrimitives()[s],o=r.primitives[s],a=t.primitiveHashMap.get(i);if(!a)continue;const u=t.primitiveEncodingMap.get(a);u&&(o.extensions=o.extensions||{},o.extensions[it]={bufferView:e.otherBufferViewsIndexMap.get(u.data),attributes:u.attributeIDs})}}if(!t.primitiveHashMap.size){const n=e.jsonDoc.json;n.extensionsUsed=(n.extensionsUsed||[]).filter(r=>r!==it),n.extensionsRequired=(n.extensionsRequired||[]).filter(r=>r!==it)}return this}},Os.EXTENSION_NAME=it,Os.EncoderMethod=Zr,$r=class ku extends et{init(){this.extensionName=Vt,this.propertyType="Light",this.parentTypes=[k.NODE]}getDefaults(){return Object.assign(super.getDefaults(),{color:[1,1,1],intensity:1,type:ku.Type.POINT,range:null,innerConeAngle:0,outerConeAngle:Math.PI/4})}getColor(){return this.get("color")}setColor(t){return this.set("color",t)}getIntensity(){return this.get("intensity")}setIntensity(t){return this.set("intensity",t)}getType(){return this.get("type")}setType(t){return this.set("type",t)}getRange(){return this.get("range")}setRange(t){return this.set("range",t)}getInnerConeAngle(){return this.get("innerConeAngle")}setInnerConeAngle(t){return this.set("innerConeAngle",t)}getOuterConeAngle(){return this.get("outerConeAngle")}setOuterConeAngle(t){return this.set("outerConeAngle",t)}},$r.EXTENSION_NAME=Vt,$r.Type={POINT:"point",SPOT:"spot",DIRECTIONAL:"directional"},oo=class extends Ke{constructor(...e){super(...e),this.extensionName=Vt}createLight(e=""){return new $r(this.document.getGraph(),e)}read(e){const t=e.jsonDoc;if(!t.json.extensions||!t.json.extensions[Vt])return this;const s=(t.json.extensions[Vt].lights||[]).map(i=>{var o,a;const u=this.createLight().setName(i.name||"").setType(i.type);return i.color!==void 0&&u.setColor(i.color),i.intensity!==void 0&&u.setIntensity(i.intensity),i.range!==void 0&&u.setRange(i.range),((o=i.spot)==null?void 0:o.innerConeAngle)!==void 0&&u.setInnerConeAngle(i.spot.innerConeAngle),((a=i.spot)==null?void 0:a.outerConeAngle)!==void 0&&u.setOuterConeAngle(i.spot.outerConeAngle),u});return t.json.nodes.forEach((i,o)=>{if(!i.extensions||!i.extensions[Vt])return;const a=i.extensions[Vt];e.nodes[o].setExtension(Vt,s[a.light])}),this}write(e){const t=e.jsonDoc;if(this.properties.size===0)return this;const n=[],r=new Map;for(const s of this.properties){const i=s,o={type:i.getType()};st.eq(i.getColor(),[1,1,1])||(o.color=i.getColor()),i.getIntensity()!==1&&(o.intensity=i.getIntensity()),i.getRange()!=null&&(o.range=i.getRange()),i.getName()&&(o.name=i.getName()),i.getType()===$r.Type.SPOT&&(o.spot={innerConeAngle:i.getInnerConeAngle(),outerConeAngle:i.getOuterConeAngle()}),n.push(o),r.set(i,n.length-1)}return this.document.getRoot().listNodes().forEach(s=>{const i=s.getExtension(Vt);if(i){const o=e.nodeIndexMap.get(s),a=t.json.nodes[o];a.extensions=a.extensions||{},a.extensions[Vt]={light:r.get(i)}}}),t.json.extensions=t.json.extensions||{},t.json.extensions[Vt]={lights:n},this}},oo.EXTENSION_NAME=Vt,{R:Pl,G:Fl,B:Ul}=Kt,ao=class extends et{init(){this.extensionName=un,this.propertyType="Anisotropy",this.parentTypes=[k.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{anisotropyStrength:0,anisotropyRotation:0,anisotropyTexture:null,anisotropyTextureInfo:new tt(this.graph,"anisotropyTextureInfo")})}getAnisotropyStrength(){return this.get("anisotropyStrength")}setAnisotropyStrength(e){return this.set("anisotropyStrength",e)}getAnisotropyRotation(){return this.get("anisotropyRotation")}setAnisotropyRotation(e){return this.set("anisotropyRotation",e)}getAnisotropyTexture(){return this.getRef("anisotropyTexture")}getAnisotropyTextureInfo(){return this.getRef("anisotropyTexture")?this.getRef("anisotropyTextureInfo"):null}setAnisotropyTexture(e){return this.setRef("anisotropyTexture",e,{channels:Pl|Fl|Ul})}},ao.EXTENSION_NAME=un,lo=class extends Ke{constructor(...e){super(...e),this.extensionName=un,this.prereadTypes=[k.MESH],this.prewriteTypes=[k.MESH]}createAnisotropy(){return new ao(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){const t=e.jsonDoc,n=t.json.materials||[],r=t.json.textures||[];return n.forEach((s,i)=>{if(s.extensions&&s.extensions[un]){const o=this.createAnisotropy();e.materials[i].setExtension(un,o);const a=s.extensions[un];if(a.anisotropyStrength!==void 0&&o.setAnisotropyStrength(a.anisotropyStrength),a.anisotropyRotation!==void 0&&o.setAnisotropyRotation(a.anisotropyRotation),a.anisotropyTexture!==void 0){const u=a.anisotropyTexture,f=e.textures[r[u.index].source];o.setAnisotropyTexture(f),e.setTextureInfo(o.getAnisotropyTextureInfo(),u)}}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const r=n.getExtension(un);if(r){const s=e.materialIndexMap.get(n),i=t.json.materials[s];i.extensions=i.extensions||{};const o=i.extensions[un]={};if(r.getAnisotropyStrength()>0&&(o.anisotropyStrength=r.getAnisotropyStrength()),r.getAnisotropyRotation()!==0&&(o.anisotropyRotation=r.getAnisotropyRotation()),r.getAnisotropyTexture()){const a=r.getAnisotropyTexture(),u=r.getAnisotropyTextureInfo();o.anisotropyTexture=e.createTextureInfoDef(a,u)}}}),this}},lo.EXTENSION_NAME=un,{R:co,G:uo,B:Ll}=Kt,fo=class extends et{init(){this.extensionName=fn,this.propertyType="Clearcoat",this.parentTypes=[k.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{clearcoatFactor:0,clearcoatTexture:null,clearcoatTextureInfo:new tt(this.graph,"clearcoatTextureInfo"),clearcoatRoughnessFactor:0,clearcoatRoughnessTexture:null,clearcoatRoughnessTextureInfo:new tt(this.graph,"clearcoatRoughnessTextureInfo"),clearcoatNormalScale:1,clearcoatNormalTexture:null,clearcoatNormalTextureInfo:new tt(this.graph,"clearcoatNormalTextureInfo")})}getClearcoatFactor(){return this.get("clearcoatFactor")}setClearcoatFactor(e){return this.set("clearcoatFactor",e)}getClearcoatTexture(){return this.getRef("clearcoatTexture")}getClearcoatTextureInfo(){return this.getRef("clearcoatTexture")?this.getRef("clearcoatTextureInfo"):null}setClearcoatTexture(e){return this.setRef("clearcoatTexture",e,{channels:co})}getClearcoatRoughnessFactor(){return this.get("clearcoatRoughnessFactor")}setClearcoatRoughnessFactor(e){return this.set("clearcoatRoughnessFactor",e)}getClearcoatRoughnessTexture(){return this.getRef("clearcoatRoughnessTexture")}getClearcoatRoughnessTextureInfo(){return this.getRef("clearcoatRoughnessTexture")?this.getRef("clearcoatRoughnessTextureInfo"):null}setClearcoatRoughnessTexture(e){return this.setRef("clearcoatRoughnessTexture",e,{channels:uo})}getClearcoatNormalScale(){return this.get("clearcoatNormalScale")}setClearcoatNormalScale(e){return this.set("clearcoatNormalScale",e)}getClearcoatNormalTexture(){return this.getRef("clearcoatNormalTexture")}getClearcoatNormalTextureInfo(){return this.getRef("clearcoatNormalTexture")?this.getRef("clearcoatNormalTextureInfo"):null}setClearcoatNormalTexture(e){return this.setRef("clearcoatNormalTexture",e,{channels:co|uo|Ll})}},fo.EXTENSION_NAME=fn,ho=class extends Ke{constructor(...e){super(...e),this.extensionName=fn,this.prereadTypes=[k.MESH],this.prewriteTypes=[k.MESH]}createClearcoat(){return new fo(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){const t=e.jsonDoc,n=t.json.materials||[],r=t.json.textures||[];return n.forEach((s,i)=>{if(s.extensions&&s.extensions[fn]){const o=this.createClearcoat();e.materials[i].setExtension(fn,o);const a=s.extensions[fn];if(a.clearcoatFactor!==void 0&&o.setClearcoatFactor(a.clearcoatFactor),a.clearcoatRoughnessFactor!==void 0&&o.setClearcoatRoughnessFactor(a.clearcoatRoughnessFactor),a.clearcoatTexture!==void 0){const u=a.clearcoatTexture,f=e.textures[r[u.index].source];o.setClearcoatTexture(f),e.setTextureInfo(o.getClearcoatTextureInfo(),u)}if(a.clearcoatRoughnessTexture!==void 0){const u=a.clearcoatRoughnessTexture,f=e.textures[r[u.index].source];o.setClearcoatRoughnessTexture(f),e.setTextureInfo(o.getClearcoatRoughnessTextureInfo(),u)}if(a.clearcoatNormalTexture!==void 0){const u=a.clearcoatNormalTexture,f=e.textures[r[u.index].source];o.setClearcoatNormalTexture(f),e.setTextureInfo(o.getClearcoatNormalTextureInfo(),u),u.scale!==void 0&&o.setClearcoatNormalScale(u.scale)}}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const r=n.getExtension(fn);if(r){const s=e.materialIndexMap.get(n),i=t.json.materials[s];i.extensions=i.extensions||{};const o=i.extensions[fn]={clearcoatFactor:r.getClearcoatFactor(),clearcoatRoughnessFactor:r.getClearcoatRoughnessFactor()};if(r.getClearcoatTexture()){const a=r.getClearcoatTexture(),u=r.getClearcoatTextureInfo();o.clearcoatTexture=e.createTextureInfoDef(a,u)}if(r.getClearcoatRoughnessTexture()){const a=r.getClearcoatRoughnessTexture(),u=r.getClearcoatRoughnessTextureInfo();o.clearcoatRoughnessTexture=e.createTextureInfoDef(a,u)}if(r.getClearcoatNormalTexture()){const a=r.getClearcoatNormalTexture(),u=r.getClearcoatNormalTextureInfo();o.clearcoatNormalTexture=e.createTextureInfoDef(a,u),r.getClearcoatNormalScale()!==1&&(o.clearcoatNormalTexture.scale=r.getClearcoatNormalScale())}}}),this}},ho.EXTENSION_NAME=fn,{R:kl,G:jl,B:Bl,A:$l}=Kt,po=class extends et{init(){this.extensionName=hn,this.propertyType="DiffuseTransmission",this.parentTypes=[k.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{diffuseTransmissionFactor:0,diffuseTransmissionTexture:null,diffuseTransmissionTextureInfo:new tt(this.graph,"diffuseTransmissionTextureInfo"),diffuseTransmissionColorFactor:[1,1,1],diffuseTransmissionColorTexture:null,diffuseTransmissionColorTextureInfo:new tt(this.graph,"diffuseTransmissionColorTextureInfo")})}getDiffuseTransmissionFactor(){return this.get("diffuseTransmissionFactor")}setDiffuseTransmissionFactor(e){return this.set("diffuseTransmissionFactor",e)}getDiffuseTransmissionTexture(){return this.getRef("diffuseTransmissionTexture")}getDiffuseTransmissionTextureInfo(){return this.getRef("diffuseTransmissionTexture")?this.getRef("diffuseTransmissionTextureInfo"):null}setDiffuseTransmissionTexture(e){return this.setRef("diffuseTransmissionTexture",e,{channels:$l})}getDiffuseTransmissionColorFactor(){return this.get("diffuseTransmissionColorFactor")}setDiffuseTransmissionColorFactor(e){return this.set("diffuseTransmissionColorFactor",e)}getDiffuseTransmissionColorTexture(){return this.getRef("diffuseTransmissionColorTexture")}getDiffuseTransmissionColorTextureInfo(){return this.getRef("diffuseTransmissionColorTexture")?this.getRef("diffuseTransmissionColorTextureInfo"):null}setDiffuseTransmissionColorTexture(e){return this.setRef("diffuseTransmissionColorTexture",e,{channels:kl|jl|Bl})}},po.EXTENSION_NAME=hn,go=class extends Ke{constructor(...e){super(...e),this.extensionName=hn}createDiffuseTransmission(){return new po(this.document.getGraph())}read(e){const t=e.jsonDoc,n=t.json.materials||[],r=t.json.textures||[];return n.forEach((s,i)=>{if(s.extensions&&s.extensions[hn]){const o=this.createDiffuseTransmission();e.materials[i].setExtension(hn,o);const a=s.extensions[hn];if(a.diffuseTransmissionFactor!==void 0&&o.setDiffuseTransmissionFactor(a.diffuseTransmissionFactor),a.diffuseTransmissionColorFactor!==void 0&&o.setDiffuseTransmissionColorFactor(a.diffuseTransmissionColorFactor),a.diffuseTransmissionTexture!==void 0){const u=a.diffuseTransmissionTexture,f=e.textures[r[u.index].source];o.setDiffuseTransmissionTexture(f),e.setTextureInfo(o.getDiffuseTransmissionTextureInfo(),u)}if(a.diffuseTransmissionColorTexture!==void 0){const u=a.diffuseTransmissionColorTexture,f=e.textures[r[u.index].source];o.setDiffuseTransmissionColorTexture(f),e.setTextureInfo(o.getDiffuseTransmissionColorTextureInfo(),u)}}}),this}write(e){const t=e.jsonDoc;for(const n of this.document.getRoot().listMaterials()){const r=n.getExtension(hn);if(!r)continue;const s=e.materialIndexMap.get(n),i=t.json.materials[s];i.extensions=i.extensions||{};const o=i.extensions[hn]={diffuseTransmissionFactor:r.getDiffuseTransmissionFactor(),diffuseTransmissionColorFactor:r.getDiffuseTransmissionColorFactor()};if(r.getDiffuseTransmissionTexture()){const a=r.getDiffuseTransmissionTexture(),u=r.getDiffuseTransmissionTextureInfo();o.diffuseTransmissionTexture=e.createTextureInfoDef(a,u)}if(r.getDiffuseTransmissionColorTexture()){const a=r.getDiffuseTransmissionColorTexture(),u=r.getDiffuseTransmissionColorTextureInfo();o.diffuseTransmissionColorTexture=e.createTextureInfoDef(a,u)}}return this}},go.EXTENSION_NAME=hn,mo=class extends et{init(){this.extensionName=dn,this.propertyType="Dispersion",this.parentTypes=[k.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{dispersion:0})}getDispersion(){return this.get("dispersion")}setDispersion(e){return this.set("dispersion",e)}},mo.EXTENSION_NAME=dn,yo=class extends Ke{constructor(...e){super(...e),this.extensionName=dn,this.prereadTypes=[k.MESH],this.prewriteTypes=[k.MESH]}createDispersion(){return new mo(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){return(e.jsonDoc.json.materials||[]).forEach((r,s)=>{if(r.extensions&&r.extensions[dn]){const i=this.createDispersion();e.materials[s].setExtension(dn,i);const o=r.extensions[dn];o.dispersion!==void 0&&i.setDispersion(o.dispersion)}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const r=n.getExtension(dn);if(r){const s=e.materialIndexMap.get(n),i=t.json.materials[s];i.extensions=i.extensions||{},i.extensions[dn]={dispersion:r.getDispersion()}}}),this}},yo.EXTENSION_NAME=dn,vo=class extends et{init(){this.extensionName=pn,this.propertyType="EmissiveStrength",this.parentTypes=[k.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{emissiveStrength:1})}getEmissiveStrength(){return this.get("emissiveStrength")}setEmissiveStrength(e){return this.set("emissiveStrength",e)}},vo.EXTENSION_NAME=pn,To=class extends Ke{constructor(...e){super(...e),this.extensionName=pn,this.prereadTypes=[k.MESH],this.prewriteTypes=[k.MESH]}createEmissiveStrength(){return new vo(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){return(e.jsonDoc.json.materials||[]).forEach((r,s)=>{if(r.extensions&&r.extensions[pn]){const i=this.createEmissiveStrength();e.materials[s].setExtension(pn,i);const o=r.extensions[pn];o.emissiveStrength!==void 0&&i.setEmissiveStrength(o.emissiveStrength)}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const r=n.getExtension(pn);if(r){const s=e.materialIndexMap.get(n),i=t.json.materials[s];i.extensions=i.extensions||{},i.extensions[pn]={emissiveStrength:r.getEmissiveStrength()}}}),this}},To.EXTENSION_NAME=pn,xo=class extends et{init(){this.extensionName=gn,this.propertyType="IOR",this.parentTypes=[k.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{ior:1.5})}getIOR(){return this.get("ior")}setIOR(e){return this.set("ior",e)}},xo.EXTENSION_NAME=gn,wo=class extends Ke{constructor(...e){super(...e),this.extensionName=gn,this.prereadTypes=[k.MESH],this.prewriteTypes=[k.MESH]}createIOR(){return new xo(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){return(e.jsonDoc.json.materials||[]).forEach((r,s)=>{if(r.extensions&&r.extensions[gn]){const i=this.createIOR();e.materials[s].setExtension(gn,i);const o=r.extensions[gn];o.ior!==void 0&&i.setIOR(o.ior)}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const r=n.getExtension(gn);if(r){const s=e.materialIndexMap.get(n),i=t.json.materials[s];i.extensions=i.extensions||{},i.extensions[gn]={ior:r.getIOR()}}}),this}},wo.EXTENSION_NAME=gn,{R:Vl,G:Gl}=Kt,Eo=class extends et{init(){this.extensionName=mn,this.propertyType="Iridescence",this.parentTypes=[k.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{iridescenceFactor:0,iridescenceTexture:null,iridescenceTextureInfo:new tt(this.graph,"iridescenceTextureInfo"),iridescenceIOR:1.3,iridescenceThicknessMinimum:100,iridescenceThicknessMaximum:400,iridescenceThicknessTexture:null,iridescenceThicknessTextureInfo:new tt(this.graph,"iridescenceThicknessTextureInfo")})}getIridescenceFactor(){return this.get("iridescenceFactor")}setIridescenceFactor(e){return this.set("iridescenceFactor",e)}getIridescenceTexture(){return this.getRef("iridescenceTexture")}getIridescenceTextureInfo(){return this.getRef("iridescenceTexture")?this.getRef("iridescenceTextureInfo"):null}setIridescenceTexture(e){return this.setRef("iridescenceTexture",e,{channels:Vl})}getIridescenceIOR(){return this.get("iridescenceIOR")}setIridescenceIOR(e){return this.set("iridescenceIOR",e)}getIridescenceThicknessMinimum(){return this.get("iridescenceThicknessMinimum")}setIridescenceThicknessMinimum(e){return this.set("iridescenceThicknessMinimum",e)}getIridescenceThicknessMaximum(){return this.get("iridescenceThicknessMaximum")}setIridescenceThicknessMaximum(e){return this.set("iridescenceThicknessMaximum",e)}getIridescenceThicknessTexture(){return this.getRef("iridescenceThicknessTexture")}getIridescenceThicknessTextureInfo(){return this.getRef("iridescenceThicknessTexture")?this.getRef("iridescenceThicknessTextureInfo"):null}setIridescenceThicknessTexture(e){return this.setRef("iridescenceThicknessTexture",e,{channels:Gl})}},Eo.EXTENSION_NAME=mn,bo=class extends Ke{constructor(...e){super(...e),this.extensionName=mn,this.prereadTypes=[k.MESH],this.prewriteTypes=[k.MESH]}createIridescence(){return new Eo(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){const t=e.jsonDoc,n=t.json.materials||[],r=t.json.textures||[];return n.forEach((s,i)=>{if(s.extensions&&s.extensions[mn]){const o=this.createIridescence();e.materials[i].setExtension(mn,o);const a=s.extensions[mn];if(a.iridescenceFactor!==void 0&&o.setIridescenceFactor(a.iridescenceFactor),a.iridescenceIor!==void 0&&o.setIridescenceIOR(a.iridescenceIor),a.iridescenceThicknessMinimum!==void 0&&o.setIridescenceThicknessMinimum(a.iridescenceThicknessMinimum),a.iridescenceThicknessMaximum!==void 0&&o.setIridescenceThicknessMaximum(a.iridescenceThicknessMaximum),a.iridescenceTexture!==void 0){const u=a.iridescenceTexture,f=e.textures[r[u.index].source];o.setIridescenceTexture(f),e.setTextureInfo(o.getIridescenceTextureInfo(),u)}if(a.iridescenceThicknessTexture!==void 0){const u=a.iridescenceThicknessTexture,f=e.textures[r[u.index].source];o.setIridescenceThicknessTexture(f),e.setTextureInfo(o.getIridescenceThicknessTextureInfo(),u)}}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const r=n.getExtension(mn);if(r){const s=e.materialIndexMap.get(n),i=t.json.materials[s];i.extensions=i.extensions||{};const o=i.extensions[mn]={};if(r.getIridescenceFactor()>0&&(o.iridescenceFactor=r.getIridescenceFactor()),r.getIridescenceIOR()!==1.3&&(o.iridescenceIor=r.getIridescenceIOR()),r.getIridescenceThicknessMinimum()!==100&&(o.iridescenceThicknessMinimum=r.getIridescenceThicknessMinimum()),r.getIridescenceThicknessMaximum()!==400&&(o.iridescenceThicknessMaximum=r.getIridescenceThicknessMaximum()),r.getIridescenceTexture()){const a=r.getIridescenceTexture(),u=r.getIridescenceTextureInfo();o.iridescenceTexture=e.createTextureInfoDef(a,u)}if(r.getIridescenceThicknessTexture()){const a=r.getIridescenceThicknessTexture(),u=r.getIridescenceThicknessTextureInfo();o.iridescenceThicknessTexture=e.createTextureInfoDef(a,u)}}}),this}},bo.EXTENSION_NAME=mn,{R:_o,G:Ro,B:Io,A:So}=Kt,Ao=class extends et{init(){this.extensionName=yn,this.propertyType="PBRSpecularGlossiness",this.parentTypes=[k.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{diffuseFactor:[1,1,1,1],diffuseTexture:null,diffuseTextureInfo:new tt(this.graph,"diffuseTextureInfo"),specularFactor:[1,1,1],glossinessFactor:1,specularGlossinessTexture:null,specularGlossinessTextureInfo:new tt(this.graph,"specularGlossinessTextureInfo")})}getDiffuseFactor(){return this.get("diffuseFactor")}setDiffuseFactor(e){return this.set("diffuseFactor",e)}getDiffuseTexture(){return this.getRef("diffuseTexture")}getDiffuseTextureInfo(){return this.getRef("diffuseTexture")?this.getRef("diffuseTextureInfo"):null}setDiffuseTexture(e){return this.setRef("diffuseTexture",e,{channels:_o|Ro|Io|So,isColor:!0})}getSpecularFactor(){return this.get("specularFactor")}setSpecularFactor(e){return this.set("specularFactor",e)}getGlossinessFactor(){return this.get("glossinessFactor")}setGlossinessFactor(e){return this.set("glossinessFactor",e)}getSpecularGlossinessTexture(){return this.getRef("specularGlossinessTexture")}getSpecularGlossinessTextureInfo(){return this.getRef("specularGlossinessTexture")?this.getRef("specularGlossinessTextureInfo"):null}setSpecularGlossinessTexture(e){return this.setRef("specularGlossinessTexture",e,{channels:_o|Ro|Io|So})}},Ao.EXTENSION_NAME=yn,Mo=class extends Ke{constructor(...e){super(...e),this.extensionName=yn,this.prereadTypes=[k.MESH],this.prewriteTypes=[k.MESH]}createPBRSpecularGlossiness(){return new Ao(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){const t=e.jsonDoc,n=t.json.materials||[],r=t.json.textures||[];return n.forEach((s,i)=>{if(s.extensions&&s.extensions[yn]){const o=this.createPBRSpecularGlossiness();e.materials[i].setExtension(yn,o);const a=s.extensions[yn];if(a.diffuseFactor!==void 0&&o.setDiffuseFactor(a.diffuseFactor),a.specularFactor!==void 0&&o.setSpecularFactor(a.specularFactor),a.glossinessFactor!==void 0&&o.setGlossinessFactor(a.glossinessFactor),a.diffuseTexture!==void 0){const u=a.diffuseTexture,f=e.textures[r[u.index].source];o.setDiffuseTexture(f),e.setTextureInfo(o.getDiffuseTextureInfo(),u)}if(a.specularGlossinessTexture!==void 0){const u=a.specularGlossinessTexture,f=e.textures[r[u.index].source];o.setSpecularGlossinessTexture(f),e.setTextureInfo(o.getSpecularGlossinessTextureInfo(),u)}}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const r=n.getExtension(yn);if(r){const s=e.materialIndexMap.get(n),i=t.json.materials[s];i.extensions=i.extensions||{};const o=i.extensions[yn]={diffuseFactor:r.getDiffuseFactor(),specularFactor:r.getSpecularFactor(),glossinessFactor:r.getGlossinessFactor()};if(r.getDiffuseTexture()){const a=r.getDiffuseTexture(),u=r.getDiffuseTextureInfo();o.diffuseTexture=e.createTextureInfoDef(a,u)}if(r.getSpecularGlossinessTexture()){const a=r.getSpecularGlossinessTexture(),u=r.getSpecularGlossinessTextureInfo();o.specularGlossinessTexture=e.createTextureInfoDef(a,u)}}}),this}},Mo.EXTENSION_NAME=yn,{R:zl,G:Hl,B:Wl,A:Xl}=Kt,Co=class extends et{init(){this.extensionName=vn,this.propertyType="Sheen",this.parentTypes=[k.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{sheenColorFactor:[0,0,0],sheenColorTexture:null,sheenColorTextureInfo:new tt(this.graph,"sheenColorTextureInfo"),sheenRoughnessFactor:0,sheenRoughnessTexture:null,sheenRoughnessTextureInfo:new tt(this.graph,"sheenRoughnessTextureInfo")})}getSheenColorFactor(){return this.get("sheenColorFactor")}setSheenColorFactor(e){return this.set("sheenColorFactor",e)}getSheenColorTexture(){return this.getRef("sheenColorTexture")}getSheenColorTextureInfo(){return this.getRef("sheenColorTexture")?this.getRef("sheenColorTextureInfo"):null}setSheenColorTexture(e){return this.setRef("sheenColorTexture",e,{channels:zl|Hl|Wl,isColor:!0})}getSheenRoughnessFactor(){return this.get("sheenRoughnessFactor")}setSheenRoughnessFactor(e){return this.set("sheenRoughnessFactor",e)}getSheenRoughnessTexture(){return this.getRef("sheenRoughnessTexture")}getSheenRoughnessTextureInfo(){return this.getRef("sheenRoughnessTexture")?this.getRef("sheenRoughnessTextureInfo"):null}setSheenRoughnessTexture(e){return this.setRef("sheenRoughnessTexture",e,{channels:Xl})}},Co.EXTENSION_NAME=vn,No=class extends Ke{constructor(...e){super(...e),this.extensionName=vn,this.prereadTypes=[k.MESH],this.prewriteTypes=[k.MESH]}createSheen(){return new Co(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){const t=e.jsonDoc,n=t.json.materials||[],r=t.json.textures||[];return n.forEach((s,i)=>{if(s.extensions&&s.extensions[vn]){const o=this.createSheen();e.materials[i].setExtension(vn,o);const a=s.extensions[vn];if(a.sheenColorFactor!==void 0&&o.setSheenColorFactor(a.sheenColorFactor),a.sheenRoughnessFactor!==void 0&&o.setSheenRoughnessFactor(a.sheenRoughnessFactor),a.sheenColorTexture!==void 0){const u=a.sheenColorTexture,f=e.textures[r[u.index].source];o.setSheenColorTexture(f),e.setTextureInfo(o.getSheenColorTextureInfo(),u)}if(a.sheenRoughnessTexture!==void 0){const u=a.sheenRoughnessTexture,f=e.textures[r[u.index].source];o.setSheenRoughnessTexture(f),e.setTextureInfo(o.getSheenRoughnessTextureInfo(),u)}}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const r=n.getExtension(vn);if(r){const s=e.materialIndexMap.get(n),i=t.json.materials[s];i.extensions=i.extensions||{};const o=i.extensions[vn]={sheenColorFactor:r.getSheenColorFactor(),sheenRoughnessFactor:r.getSheenRoughnessFactor()};if(r.getSheenColorTexture()){const a=r.getSheenColorTexture(),u=r.getSheenColorTextureInfo();o.sheenColorTexture=e.createTextureInfoDef(a,u)}if(r.getSheenRoughnessTexture()){const a=r.getSheenRoughnessTexture(),u=r.getSheenRoughnessTextureInfo();o.sheenRoughnessTexture=e.createTextureInfoDef(a,u)}}}),this}},No.EXTENSION_NAME=vn,{R:ql,G:Kl,B:Yl,A:Jl}=Kt,Oo=class extends et{init(){this.extensionName=Tn,this.propertyType="Specular",this.parentTypes=[k.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{specularFactor:1,specularTexture:null,specularTextureInfo:new tt(this.graph,"specularTextureInfo"),specularColorFactor:[1,1,1],specularColorTexture:null,specularColorTextureInfo:new tt(this.graph,"specularColorTextureInfo")})}getSpecularFactor(){return this.get("specularFactor")}setSpecularFactor(e){return this.set("specularFactor",e)}getSpecularColorFactor(){return this.get("specularColorFactor")}setSpecularColorFactor(e){return this.set("specularColorFactor",e)}getSpecularTexture(){return this.getRef("specularTexture")}getSpecularTextureInfo(){return this.getRef("specularTexture")?this.getRef("specularTextureInfo"):null}setSpecularTexture(e){return this.setRef("specularTexture",e,{channels:Jl})}getSpecularColorTexture(){return this.getRef("specularColorTexture")}getSpecularColorTextureInfo(){return this.getRef("specularColorTexture")?this.getRef("specularColorTextureInfo"):null}setSpecularColorTexture(e){return this.setRef("specularColorTexture",e,{channels:ql|Kl|Yl,isColor:!0})}},Oo.EXTENSION_NAME=Tn,Do=class extends Ke{constructor(...e){super(...e),this.extensionName=Tn,this.prereadTypes=[k.MESH],this.prewriteTypes=[k.MESH]}createSpecular(){return new Oo(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){const t=e.jsonDoc,n=t.json.materials||[],r=t.json.textures||[];return n.forEach((s,i)=>{if(s.extensions&&s.extensions[Tn]){const o=this.createSpecular();e.materials[i].setExtension(Tn,o);const a=s.extensions[Tn];if(a.specularFactor!==void 0&&o.setSpecularFactor(a.specularFactor),a.specularColorFactor!==void 0&&o.setSpecularColorFactor(a.specularColorFactor),a.specularTexture!==void 0){const u=a.specularTexture,f=e.textures[r[u.index].source];o.setSpecularTexture(f),e.setTextureInfo(o.getSpecularTextureInfo(),u)}if(a.specularColorTexture!==void 0){const u=a.specularColorTexture,f=e.textures[r[u.index].source];o.setSpecularColorTexture(f),e.setTextureInfo(o.getSpecularColorTextureInfo(),u)}}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const r=n.getExtension(Tn);if(r){const s=e.materialIndexMap.get(n),i=t.json.materials[s];i.extensions=i.extensions||{};const o=i.extensions[Tn]={};if(r.getSpecularFactor()!==1&&(o.specularFactor=r.getSpecularFactor()),st.eq(r.getSpecularColorFactor(),[1,1,1])||(o.specularColorFactor=r.getSpecularColorFactor()),r.getSpecularTexture()){const a=r.getSpecularTexture(),u=r.getSpecularTextureInfo();o.specularTexture=e.createTextureInfoDef(a,u)}if(r.getSpecularColorTexture()){const a=r.getSpecularColorTexture(),u=r.getSpecularColorTextureInfo();o.specularColorTexture=e.createTextureInfoDef(a,u)}}}),this}},Do.EXTENSION_NAME=Tn,{R:Zl}=Kt,Po=class extends et{init(){this.extensionName=xn,this.propertyType="Transmission",this.parentTypes=[k.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{transmissionFactor:0,transmissionTexture:null,transmissionTextureInfo:new tt(this.graph,"transmissionTextureInfo")})}getTransmissionFactor(){return this.get("transmissionFactor")}setTransmissionFactor(e){return this.set("transmissionFactor",e)}getTransmissionTexture(){return this.getRef("transmissionTexture")}getTransmissionTextureInfo(){return this.getRef("transmissionTexture")?this.getRef("transmissionTextureInfo"):null}setTransmissionTexture(e){return this.setRef("transmissionTexture",e,{channels:Zl})}},Po.EXTENSION_NAME=xn,Fo=class extends Ke{constructor(...e){super(...e),this.extensionName=xn,this.prereadTypes=[k.MESH],this.prewriteTypes=[k.MESH]}createTransmission(){return new Po(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){const t=e.jsonDoc,n=t.json.materials||[],r=t.json.textures||[];return n.forEach((s,i)=>{if(s.extensions&&s.extensions[xn]){const o=this.createTransmission();e.materials[i].setExtension(xn,o);const a=s.extensions[xn];if(a.transmissionFactor!==void 0&&o.setTransmissionFactor(a.transmissionFactor),a.transmissionTexture!==void 0){const u=a.transmissionTexture,f=e.textures[r[u.index].source];o.setTransmissionTexture(f),e.setTextureInfo(o.getTransmissionTextureInfo(),u)}}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const r=n.getExtension(xn);if(r){const s=e.materialIndexMap.get(n),i=t.json.materials[s];i.extensions=i.extensions||{};const o=i.extensions[xn]={transmissionFactor:r.getTransmissionFactor()};if(r.getTransmissionTexture()){const a=r.getTransmissionTexture(),u=r.getTransmissionTextureInfo();o.transmissionTexture=e.createTextureInfoDef(a,u)}}}),this}},Fo.EXTENSION_NAME=xn,Uo=class extends et{init(){this.extensionName=Fn,this.propertyType="Unlit",this.parentTypes=[k.MATERIAL]}},Uo.EXTENSION_NAME=Fn,js=class extends Ke{constructor(...e){super(...e),this.extensionName=Fn,this.prereadTypes=[k.MESH],this.prewriteTypes=[k.MESH]}createUnlit(){return new Uo(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){return(e.jsonDoc.json.materials||[]).forEach((n,r)=>{n.extensions&&n.extensions[Fn]&&e.materials[r].setExtension(Fn,this.createUnlit())}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{if(n.getExtension(Fn)){const r=e.materialIndexMap.get(n),s=t.json.materials[r];s.extensions=s.extensions||{},s.extensions[Fn]={}}}),this}},js.EXTENSION_NAME=Fn,Lo=class extends et{init(){this.extensionName=bt,this.propertyType="Mapping",this.parentTypes=["MappingList"]}getDefaults(){return Object.assign(super.getDefaults(),{material:null,variants:new Je})}getMaterial(){return this.getRef("material")}setMaterial(e){return this.setRef("material",e)}addVariant(e){return this.addRef("variants",e)}removeVariant(e){return this.removeRef("variants",e)}listVariants(){return this.listRefs("variants")}},Lo.EXTENSION_NAME=bt,ko=class extends et{init(){this.extensionName=bt,this.propertyType="MappingList",this.parentTypes=[k.PRIMITIVE]}getDefaults(){return Object.assign(super.getDefaults(),{mappings:new Je})}addMapping(e){return this.addRef("mappings",e)}removeMapping(e){return this.removeRef("mappings",e)}listMappings(){return this.listRefs("mappings")}},ko.EXTENSION_NAME=bt,Ds=class extends et{init(){this.extensionName=bt,this.propertyType="Variant",this.parentTypes=["MappingList"]}},Ds.EXTENSION_NAME=bt,jo=class extends Ke{constructor(...e){super(...e),this.extensionName=bt}createMappingList(){return new ko(this.document.getGraph())}createVariant(e=""){return new Ds(this.document.getGraph(),e)}createMapping(){return new Lo(this.document.getGraph())}listVariants(){return Array.from(this.properties).filter(e=>e instanceof Ds)}read(e){const t=e.jsonDoc;if(!t.json.extensions||!t.json.extensions[bt])return this;const s=(t.json.extensions[bt].variants||[]).map(o=>this.createVariant().setName(o.name||""));return(t.json.meshes||[]).forEach((o,a)=>{const u=e.meshes[a];(o.primitives||[]).forEach((m,y)=>{if(!m.extensions||!m.extensions[bt])return;const g=this.createMappingList(),p=m.extensions[bt];for(const M of p.mappings){const R=this.createMapping();M.material!==void 0&&R.setMaterial(e.materials[M.material]);for(const h of M.variants||[])R.addVariant(s[h]);g.addMapping(R)}u.listPrimitives()[y].setExtension(bt,g)})}),this}write(e){const t=e.jsonDoc,n=this.listVariants();if(!n.length)return this;const r=[],s=new Map;for(const i of n)s.set(i,r.length),r.push(e.createPropertyDef(i));for(const i of this.document.getRoot().listMeshes()){const o=e.meshIndexMap.get(i);i.listPrimitives().forEach((a,u)=>{const f=a.getExtension(bt);if(!f)return;const m=e.jsonDoc.json.meshes[o].primitives[u],y=f.listMappings().map(g=>{const p=e.createPropertyDef(g),M=g.getMaterial();return M&&(p.material=e.materialIndexMap.get(M)),p.variants=g.listVariants().map(R=>s.get(R)),p});m.extensions=m.extensions||{},m.extensions[bt]={mappings:y}})}return t.json.extensions=t.json.extensions||{},t.json.extensions[bt]={variants:r},this}},jo.EXTENSION_NAME=bt,{G:Ql}=Kt,Bo=class extends et{init(){this.extensionName=wn,this.propertyType="Volume",this.parentTypes=[k.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{thicknessFactor:0,thicknessTexture:null,thicknessTextureInfo:new tt(this.graph,"thicknessTexture"),attenuationDistance:1/0,attenuationColor:[1,1,1]})}getThicknessFactor(){return this.get("thicknessFactor")}setThicknessFactor(e){return this.set("thicknessFactor",e)}getThicknessTexture(){return this.getRef("thicknessTexture")}getThicknessTextureInfo(){return this.getRef("thicknessTexture")?this.getRef("thicknessTextureInfo"):null}setThicknessTexture(e){return this.setRef("thicknessTexture",e,{channels:Ql})}getAttenuationDistance(){return this.get("attenuationDistance")}setAttenuationDistance(e){return this.set("attenuationDistance",e)}getAttenuationColor(){return this.get("attenuationColor")}setAttenuationColor(e){return this.set("attenuationColor",e)}},Bo.EXTENSION_NAME=wn,$o=class extends Ke{constructor(...e){super(...e),this.extensionName=wn,this.prereadTypes=[k.MESH],this.prewriteTypes=[k.MESH]}createVolume(){return new Bo(this.document.getGraph())}read(e){return this}write(e){return this}preread(e){const t=e.jsonDoc,n=t.json.materials||[],r=t.json.textures||[];return n.forEach((s,i)=>{if(s.extensions&&s.extensions[wn]){const o=this.createVolume();e.materials[i].setExtension(wn,o);const a=s.extensions[wn];if(a.thicknessFactor!==void 0&&o.setThicknessFactor(a.thicknessFactor),a.attenuationDistance!==void 0&&o.setAttenuationDistance(a.attenuationDistance),a.attenuationColor!==void 0&&o.setAttenuationColor(a.attenuationColor),a.thicknessTexture!==void 0){const u=a.thicknessTexture,f=e.textures[r[u.index].source];o.setThicknessTexture(f),e.setTextureInfo(o.getThicknessTextureInfo(),u)}}}),this}prewrite(e){const t=e.jsonDoc;return this.document.getRoot().listMaterials().forEach(n=>{const r=n.getExtension(wn);if(r){const s=e.materialIndexMap.get(n),i=t.json.materials[s];i.extensions=i.extensions||{};const o=i.extensions[wn]={};if(r.getThicknessFactor()>0&&(o.thicknessFactor=r.getThicknessFactor()),Number.isFinite(r.getAttenuationDistance())&&(o.attenuationDistance=r.getAttenuationDistance()),st.eq(r.getAttenuationColor(),[1,1,1])||(o.attenuationColor=r.getAttenuationColor()),r.getThicknessTexture()){const a=r.getThicknessTexture(),u=r.getThicknessTextureInfo();o.thicknessTexture=e.createTextureInfoDef(a,u)}}}),this}},$o.EXTENSION_NAME=wn,Vo=class extends Ke{constructor(...e){super(...e),this.extensionName=eo}read(e){return this}write(e){return this}},Vo.EXTENSION_NAME=eo,Go=class extends et{init(){this.extensionName=En,this.propertyType="Visibility",this.parentTypes=[k.NODE]}getDefaults(){return Object.assign(super.getDefaults(),{visible:!0})}getVisible(){return this.get("visible")}setVisible(e){return this.set("visible",e)}},Go.EXTENSION_NAME=En,zo=class extends Ke{constructor(...e){super(...e),this.extensionName=En}createVisibility(){return new Go(this.document.getGraph())}read(e){return(e.jsonDoc.json.nodes||[]).forEach((r,s)=>{if(r.extensions&&r.extensions[En]){const i=this.createVisibility();e.nodes[s].setExtension(En,i);const o=r.extensions[En];o.visible!==void 0&&i.setVisible(o.visible)}}),this}write(e){const t=e.jsonDoc;for(const n of this.document.getRoot().listNodes()){const r=n.getExtension(En);if(!r)continue;const s=e.nodeIndexMap.get(n),i=t.json.nodes[s];i.extensions=i.extensions||{},i.extensions[En]={visible:r.getVisible()}}return this}},zo.EXTENSION_NAME=En,ec=class{match(e){return e[0]===171&&e[1]===75&&e[2]===84&&e[3]===88&&e[4]===32&&e[5]===50&&e[6]===48&&e[7]===187&&e[8]===13&&e[9]===10&&e[10]===26&&e[11]===10}getSize(e){const t=Zi(e);return[t.pixelWidth,t.pixelHeight]}getChannels(e){const n=Zi(e).dataFormatDescriptor[0];if(n.colorModel===Ru)return n.samples.length===2&&(n.samples[1].channelType&15)===15?4:3;if(n.colorModel===Iu)return(n.samples[0].channelType&15)===3?4:3;throw new Error(`Unexpected KTX2 colorModel, "${n.colorModel}".`)}getVRAMByteLength(e){const t=Zi(e),n=this.getChannels(e)>3;let r=0;for(let s=0;s<t.levels.length;s++){const i=t.levels[s];if(i.uncompressedByteLength)r+=i.uncompressedByteLength;else{const o=Math.max(1,Math.floor(t.pixelWidth/Math.pow(2,s))),a=Math.max(1,Math.floor(t.pixelHeight/Math.pow(2,s))),u=n?16:8;r+=o/4*(a/4)*u}}return r}},Ho=class extends Ke{constructor(...e){super(...e),this.extensionName=wr,this.prereadTypes=[k.TEXTURE]}static register(){ln.registerFormat("image/ktx2",new ec)}preread(e){return e.jsonDoc.json.textures&&e.jsonDoc.json.textures.forEach(t=>{if(t.extensions&&t.extensions[wr]){const n=t.extensions[wr];t.source=n.source}}),this}read(e){return this}write(e){const t=e.jsonDoc;return this.document.getRoot().listTextures().forEach(n=>{if(n.getMimeType()==="image/ktx2"){const r=e.imageIndexMap.get(n);t.json.textures.forEach(s=>{s.source===r&&(s.extensions=s.extensions||{},s.extensions[wr]={source:s.source},delete s.source)})}}),this}},Ho.EXTENSION_NAME=wr,Wo=class extends et{init(){this.extensionName=bn,this.propertyType="Transform",this.parentTypes=[k.TEXTURE_INFO]}getDefaults(){return Object.assign(super.getDefaults(),{offset:[0,0],rotation:0,scale:[1,1],texCoord:null})}getOffset(){return this.get("offset")}setOffset(e){return this.set("offset",e)}getRotation(){return this.get("rotation")}setRotation(e){return this.set("rotation",e)}getScale(){return this.get("scale")}setScale(e){return this.set("scale",e)}getTexCoord(){return this.get("texCoord")}setTexCoord(e){return this.set("texCoord",e)}},Wo.EXTENSION_NAME=bn,Xo=class extends Ke{constructor(...e){super(...e),this.extensionName=bn}createTransform(){return new Wo(this.document.getGraph())}read(e){for(const[t,n]of Array.from(e.textureInfos.entries())){if(!n.extensions||!n.extensions[bn])continue;const r=this.createTransform(),s=n.extensions[bn];s.offset!==void 0&&r.setOffset(s.offset),s.rotation!==void 0&&r.setRotation(s.rotation),s.scale!==void 0&&r.setScale(s.scale),s.texCoord!==void 0&&r.setTexCoord(s.texCoord),t.setExtension(bn,r)}return this}write(e){const t=Array.from(e.textureInfoDefMap.entries());for(const[n,r]of t){const s=n.getExtension(bn);if(!s)continue;r.extensions=r.extensions||{};const i={},o=st.eq;o(s.getOffset(),[0,0])||(i.offset=s.getOffset()),s.getRotation()!==0&&(i.rotation=s.getRotation()),o(s.getScale(),[1,1])||(i.scale=s.getScale()),s.getTexCoord()!=null&&(i.texCoord=s.getTexCoord()),r.extensions[bn]=i}return this}},Xo.EXTENSION_NAME=bn,tc=[k.ROOT,k.SCENE,k.NODE,k.MESH,k.MATERIAL,k.TEXTURE,k.ANIMATION],qo=class extends et{init(){this.extensionName=Gt,this.propertyType="Packet",this.parentTypes=tc}getDefaults(){return Object.assign(super.getDefaults(),{context:{},properties:{}})}getContext(){return this.get("context")}setContext(e){return this.set("context",jn({},e))}listProperties(){return Object.keys(this.get("properties"))}getProperty(e){const t=this.get("properties");return e in t?t[e]:null}setProperty(e,t){this._assertContext(e);const n=jn({},this.get("properties"));return t?n[e]=t:delete n[e],this.set("properties",n)}toJSONLD(){const e=Qi(this.get("context")),t=Qi(this.get("properties"));return jn({"@context":e},t)}fromJSONLD(e){e=Qi(e);const t=e["@context"];return t&&this.set("context",t),delete e["@context"],this.set("properties",e)}_assertContext(e){if(!(e.split(":")[0]in this.get("context")))throw new Error(`${Gt}: Missing context for term, "${e}".`)}},qo.EXTENSION_NAME=Gt,Ko=class extends Ke{constructor(...e){super(...e),this.extensionName=Gt}createPacket(){return new qo(this.document.getGraph())}listPackets(){return Array.from(this.properties)}read(e){var t;const n=(t=e.jsonDoc.json.extensions)==null?void 0:t[Gt];if(!n||!n.packets)return this;const r=e.jsonDoc.json,s=this.document.getRoot(),i=n.packets.map(u=>this.createPacket().fromJSONLD(u)),o=[[r.asset],r.scenes,r.nodes,r.meshes,r.materials,r.images,r.animations],a=[[s],s.listScenes(),s.listNodes(),s.listMeshes(),s.listMaterials(),s.listTextures(),s.listAnimations()];for(let u=0;u<o.length;u++){const f=o[u]||[];for(let m=0;m<f.length;m++){const y=f[m];if(y.extensions&&y.extensions[Gt]){const g=y.extensions[Gt];a[u][m].setExtension(Gt,i[g.packet])}}}return this}write(e){const{json:t}=e.jsonDoc,n=[];for(const r of this.properties){n.push(r.toJSONLD());for(const s of r.listParents()){let i;switch(s.propertyType){case k.ROOT:i=t.asset;break;case k.SCENE:i=t.scenes[e.sceneIndexMap.get(s)];break;case k.NODE:i=t.nodes[e.nodeIndexMap.get(s)];break;case k.MESH:i=t.meshes[e.meshIndexMap.get(s)];break;case k.MATERIAL:i=t.materials[e.materialIndexMap.get(s)];break;case k.TEXTURE:i=t.images[e.imageIndexMap.get(s)];break;case k.ANIMATION:i=t.animations[e.animationIndexMap.get(s)];break;default:i=null,this.document.getLogger().warn(`[${Gt}]: Unsupported parent property, "${s.propertyType}"`);break}i&&(i.extensions=i.extensions||{},i.extensions[Gt]={packet:n.length-1})}}return n.length>0&&(t.extensions=t.extensions||{},t.extensions[Gt]={packets:n}),this}},Ko.EXTENSION_NAME=Gt,pa=[Os,oo,lo,ho,go,yo,To,wo,bo,Mo,Do,No,Fo,js,jo,$o,Vo,zo,Ho,Xo,Ko],[...pa]}}),Da={};Sa(Da,{attributeDefs:()=>Qt,disposeMesh:()=>Tp,exportFormats:()=>Vu,fromArrayBuffer:()=>bp,importFormats:()=>$u,loadTexture:()=>xp,readMesh:()=>ju,setupIO:()=>gp,toArrayBuffer:()=>Ep,writeMesh:()=>ai});function gp(e){return e.registerExtensions([oi])}function ju(e,t=[]){const n=e.listPrimitives();if(n.length===0)return null;if(t.length===0){const I=new Set;for(const S of n){const G=S.listSemantics();for(const v of G)I.add(v)}let C;for(C in Qt)I.has(C)&&(t.push(C),I.delete(C));for(const S of I.keys())t.push(S)}if(t.length<1||t[0]!=="POSITION")throw new Error('First attribute must be "POSITION".');let r=0;const s=t.map((r=0,I=>{const C=r;return r+=Qt[I].components,C})),i=e.getExtension("EXT_mesh_manifold");let o=Array(),a=Array();const u=[0],f=Array(),m=Array(),y=Array();if(i!=null){const I=n[0].getAttribute("POSITION").getCount(),C=t.map(w=>Qt[w].type==null);o=new Array(r*I);for(const w of n){const N=w.getIndices();if(!N){console.log("Skipping non-indexed primitive ",w.getName());continue}const P=w.listSemantics();t.forEach((U,B)=>{if(!C[B]){for(const Z of P)if(Z===U){C[B]=!0;const Se=w.getAttribute(Z);Bu(o,Se,r,s[B])}}}),a=[...a,...N.getArray()],u.push(a.length),y.push({material:w.getMaterial(),attributes:P.filter(U=>t.some(B=>B==U))})}const S=i.getMergeIndices()?.getArray()??[],G=i.getMergeValues()?.getArray()??[],v=new Map;for(const[w,N]of S.entries())v.set(a[N],G[w]);for(const[w,N]of v.entries())f.push(w),m.push(N)}else for(const I of n){const C=I.getIndices();if(!C){console.log("Skipping non-indexed primitive ",I.getName());continue}const S=o.length/r;o=[...o,...wp(I,r,t)],a=[...a,...C.getArray().map(v=>v+S)],u.push(a.length);const G=I.listSemantics();y.push({material:I.getMaterial(),attributes:G.filter(v=>t.some(w=>w==v))})}const g=new Float32Array(o),p=new Uint32Array(a),M=new Uint32Array(u),R=new Uint32Array(f),h=new Uint32Array(m);return{mesh:{numProp:r,triVerts:p,vertProperties:g,runIndex:M,mergeFromVert:R,mergeToVert:h},runProperties:y}}function ai(e,t,n,r=!0){e.getRoot().listBuffers().length===0&&e.createBuffer();const s=e.createMesh();return mp(e,s,t,n),r?yp(e,s,t):vp(e,s,t),s}function mp(e,t,n,r){const s=Array(),i=new Map,o=e.getRoot().listBuffers()[0];for(let m=0;m<n.runIndex.length-1;m++){const y=n.runOriginalID[m],g=e.createPrimitive(),p=r.get(y);if(p){const{material:M,attributes:R}=p;if(R.length<1||R[0]!=="POSITION")throw new Error('First attribute must be "POSITION".');g.setMaterial(M),i.set(g,R),p.attributes.forEach((h,V)=>{if(V>=s.length)s.push(h);else{const I=Qt[h].components,C=Qt[s[V]].components;if(I!=C)throw new Error("Attribute sizes do not correspond: "+h+" and "+s[V]);Qt[s[V]].type==null&&(s[V]=h)}})}else i.set(g,["POSITION"]);t.addPrimitive(g)}const a=n.numVert,u=n.numProp;let f=0;s.forEach((m,y)=>{const g=Qt[m];if(g==null)throw new Error(m+" is not a recognized attribute.");if(g.type==null){++f;return}const p=g.components;if(f+p>u)throw new Error("Too many attribute channels.");const M=new Float32Array(p*a);for(let h=0;h<a;++h)for(let V=0;V<p;++V){let I=n.vertProperties[u*h+f+V];m=="COLOR_0"&&(I=Math.max(0,Math.min(1,I))),M[p*h+V]=I}const R=e.createAccessor(m).setBuffer(o).setType(g.type).setArray(M);for(const h of t.listPrimitives()){const V=i.get(h);V.length>y&&Qt[V[y]].type!=null&&h.setAttribute(m,R)}f+=p})}function yp(e,t,n){const s=e.createExtension(oi).createManifoldPrimitive();t.setExtension("EXT_mesh_manifold",s);const i=e.getRoot().listBuffers()[0],{runIndex:o}=n;t.listPrimitives().forEach((y,g)=>{const p=e.createAccessor("primitive indices of ID "+o[g]).setBuffer(i).setType(ge.Type.SCALAR).setArray(new Uint32Array(1));y.setIndices(p)});const a=e.createAccessor("manifold indices").setBuffer(i).setType(ge.Type.SCALAR).setArray(n.triVerts);s.setIndices(a),s.setRunIndex(o);const u=[...Array(n.numVert).keys()],f=Array(),m=Array();if(n.mergeFromVert&&n.mergeToVert){for(const[y,g]of n.mergeFromVert.entries())u[g]=n.mergeToVert[y];for(const[y,g]of n.triVerts.entries()){const p=u[g];g!==p&&(f.push(y),m.push(p))}}if(f.length>0){const y=e.createAccessor("merge from").setBuffer(i).setType(ge.Type.SCALAR).setArray(new Uint32Array(f)),g=e.createAccessor("merge to").setBuffer(i).setType(ge.Type.SCALAR).setArray(new Uint32Array(m));s.setMerge(y,g)}}function vp(e,t,n){const r=e.getRoot().listBuffers()[0],{runIndex:s}=n;t.listPrimitives().forEach((i,o)=>{const a=e.createAccessor("primitive indices of ID "+s[o]).setBuffer(r).setType(ge.Type.SCALAR).setArray(n.triVerts.slice(s[o],s[o+1]));i.setIndices(a)})}function Tp(e){if(!e)return;const t=e.listPrimitives();for(const r of t){r.getIndices()?.dispose();for(const s of r.listAttributes())s.dispose()}const n=e.getExtension("EXT_mesh_manifold");n&&(n.getIndices()?.dispose(),n.getMergeIndices()?.dispose(),n.getMergeValues()?.dispose()),e.dispose()}async function xp(e,t){const r=await(await fetch(t)).blob();e.setMimeType(r.type),e.setImage(new Uint8Array(await r.arrayBuffer()))}function Bu(e,t,n,r){const s=t.getArray(),i=t.getElementSize(),o=t.getCount();for(let a=0;a<o;++a)for(let u=0;u<i;++u)e[n*a+r+u]=s[a*i+u]}function wp(e,t,n){const r=[];let s=0;for(const i of n){const o=Qt[i].components;if(Qt[i].type==null){s+=o;continue}const a=e.getAttribute(i);a&&Bu(r,a,t,s),s+=o}return r}async function Ep(e){return(await Pa().writeBinary(e)).buffer}async function bp(e){return await Pa().readBinary(new Uint8Array(e))}var Yo,$u,Vu,Qt,Vr,Pa,li=ut({"lib/gltf-io.ts"(){ar(),Lu(),vu(),Yo={extension:"glb",mimetype:"model/gltf-binary"},$u=[Yo],Vu=[Yo],Qt={POSITION:{type:ge.Type.VEC3,components:3},NORMAL:{type:ge.Type.VEC3,components:3},TANGENT:{type:ge.Type.VEC4,components:4},TEXCOORD_0:{type:ge.Type.VEC2,components:2},TEXCOORD_1:{type:ge.Type.VEC2,components:2},COLOR_0:{type:ge.Type.VEC3,components:3},JOINTS_0:{type:ge.Type.VEC4,components:4},WEIGHTS_0:{type:ge.Type.VEC4,components:4},SKIP_1:{type:null,components:1},SKIP_2:{type:null,components:2},SKIP_3:{type:null,components:3},SKIP_4:{type:null,components:4}},Vr=null,Pa=()=>(Vr||(Vr=new Lc,Vr.registerExtensions([oi,...pa])),Vr)}}),Ps,nc,rc,sc,ic,Gu,ns,Gr,zu,Hu=ut({"lib/garbage-collector.ts"(){Ps=Array(),nc=["cube","cylinder","sphere","tetrahedron","extrude","revolve","compose","union","difference","intersection","levelSet","smooth","ofMesh","hull"],rc=["add","subtract","intersect","decompose","warp","transform","translate","rotate","scale","mirror","calculateCurvature","calculateNormals","smoothByNormals","smoothOut","refine","refineToLength","refineToTolerance","setProperties","setTolerance","simplify","asOriginal","trimByPlane","split","splitByPlane","slice","project","hull"],sc=["square","circle","union","difference","intersection","compose","ofPolygons","hull"],ic=["add","subtract","intersect","rectClip","decompose","transform","translate","rotate","scale","mirror","simplify","offset","hull"],Gu=()=>{for(const e of Ps)if(e instanceof Array)for(const t of e)t.delete();else e.delete();Ps.length=0},ns=e=>(...t)=>{const n=e(...t);return Ps.push(n),n},Gr=(e,t)=>{for(const n of t){const r=e[n];e[n]=ns(r)}},zu=e=>(Gr(e.Manifold,nc),Gr(e.Manifold.prototype,rc),Gr(e.CrossSection,sc),Gr(e.CrossSection.prototype,ic),e)}});function _p(e){ci=e,Rn()?.setMinCircularAngle(e)}function Rp(e){ui=e,Rn()?.setMinCircularEdgeLength(e)}function Ip(e){return Rn()?.setCircularSegments(e)}function Wu(){Rn()?.resetToCircularDefaults(),ci=10,ui=1}function Sp(){return ci}function Ap(){return ui}function Mp(e){return Rn()?.getCircularSegments(e)}var ci,ui,Xu,Fa=ut({"lib/level-of-detail.ts"(){Ar(),ci=10,ui=1,Xu=()=>{Wu()}}}),Cp=Sr({"node_modules/iota-array/iota.js"(e,t){function n(r){for(var s=new Array(r),i=0;i<r;++i)s[i]=i;return s}t.exports=n}}),Np=Sr({"node_modules/is-buffer/index.js"(e,t){t.exports=function(s){return s!=null&&(n(s)||r(s)||!!s._isBuffer)};function n(s){return!!s.constructor&&typeof s.constructor.isBuffer=="function"&&s.constructor.isBuffer(s)}function r(s){return typeof s.readFloatLE=="function"&&typeof s.slice=="function"&&n(s.slice(0,0))}}}),Op=Sr({"node_modules/ndarray/ndarray.js"(e,t){var n=Cp(),r=Np(),s=typeof Float64Array<"u";function i(y,g){return y[0]-g[0]}function o(){var y=this.stride,g=new Array(y.length),p;for(p=0;p<g.length;++p)g[p]=[Math.abs(y[p]),p];g.sort(i);var M=new Array(g.length);for(p=0;p<M.length;++p)M[p]=g[p][1];return M}function a(y,g){var p=["View",g,"d",y].join("");g<0&&(p="View_Nil"+y);var M=y==="generic";if(g===-1){var R="function "+p+"(a){this.data=a;};var proto="+p+".prototype;proto.dtype='"+y+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+p+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+p+"(a){return new "+p+"(a);}",U=new Function(R);return U()}else if(g===0){var R="function "+p+"(a,d) {this.data = a;this.offset = d};var proto="+p+".prototype;proto.dtype='"+y+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+p+"_copy() {return new "+p+"(this.data,this.offset)};proto.pick=function "+p+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+p+"_get(){return "+(M?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+p+"_set(v){return "+(M?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+p+"(a,b,c,d){return new "+p+"(a,d)}",U=new Function("TrivialArray",R);return U(f[y][0])}var R=["'use strict'"],h=n(g),V=h.map(function(B){return"i"+B}),I="this.offset+"+h.map(function(B){return"this.stride["+B+"]*i"+B}).join("+"),C=h.map(function(B){return"b"+B}).join(","),S=h.map(function(B){return"c"+B}).join(",");R.push("function "+p+"(a,"+C+","+S+",d){this.data=a","this.shape=["+C+"]","this.stride=["+S+"]","this.offset=d|0}","var proto="+p+".prototype","proto.dtype='"+y+"'","proto.dimension="+g),R.push("Object.defineProperty(proto,'size',{get:function "+p+"_size(){return "+h.map(function(B){return"this.shape["+B+"]"}).join("*"),"}})"),g===1?R.push("proto.order=[0]"):(R.push("Object.defineProperty(proto,'order',{get:"),g<4?(R.push("function "+p+"_order(){"),g===2?R.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):g===3&&R.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):R.push("ORDER})")),R.push("proto.set=function "+p+"_set("+V.join(",")+",v){"),M?R.push("return this.data.set("+I+",v)}"):R.push("return this.data["+I+"]=v}"),R.push("proto.get=function "+p+"_get("+V.join(",")+"){"),M?R.push("return this.data.get("+I+")}"):R.push("return this.data["+I+"]}"),R.push("proto.index=function "+p+"_index(",V.join(),"){return "+I+"}"),R.push("proto.hi=function "+p+"_hi("+V.join(",")+"){return new "+p+"(this.data,"+h.map(function(B){return["(typeof i",B,"!=='number'||i",B,"<0)?this.shape[",B,"]:i",B,"|0"].join("")}).join(",")+","+h.map(function(B){return"this.stride["+B+"]"}).join(",")+",this.offset)}");var G=h.map(function(B){return"a"+B+"=this.shape["+B+"]"}),v=h.map(function(B){return"c"+B+"=this.stride["+B+"]"});R.push("proto.lo=function "+p+"_lo("+V.join(",")+"){var b=this.offset,d=0,"+G.join(",")+","+v.join(","));for(var w=0;w<g;++w)R.push("if(typeof i"+w+"==='number'&&i"+w+">=0){d=i"+w+"|0;b+=c"+w+"*d;a"+w+"-=d}");R.push("return new "+p+"(this.data,"+h.map(function(B){return"a"+B}).join(",")+","+h.map(function(B){return"c"+B}).join(",")+",b)}"),R.push("proto.step=function "+p+"_step("+V.join(",")+"){var "+h.map(function(B){return"a"+B+"=this.shape["+B+"]"}).join(",")+","+h.map(function(B){return"b"+B+"=this.stride["+B+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var w=0;w<g;++w)R.push("if(typeof i"+w+"==='number'){d=i"+w+"|0;if(d<0){c+=b"+w+"*(a"+w+"-1);a"+w+"=ceil(-a"+w+"/d)}else{a"+w+"=ceil(a"+w+"/d)}b"+w+"*=d}");R.push("return new "+p+"(this.data,"+h.map(function(B){return"a"+B}).join(",")+","+h.map(function(B){return"b"+B}).join(",")+",c)}");for(var N=new Array(g),P=new Array(g),w=0;w<g;++w)N[w]="a[i"+w+"]",P[w]="b[i"+w+"]";R.push("proto.transpose=function "+p+"_transpose("+V+"){"+V.map(function(B,Z){return B+"=("+B+"===undefined?"+Z+":"+B+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+p+"(this.data,"+N.join(",")+","+P.join(",")+",this.offset)}"),R.push("proto.pick=function "+p+"_pick("+V+"){var a=[],b=[],c=this.offset");for(var w=0;w<g;++w)R.push("if(typeof i"+w+"==='number'&&i"+w+">=0){c=(c+this.stride["+w+"]*i"+w+")|0}else{a.push(this.shape["+w+"]);b.push(this.stride["+w+"])}");R.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),R.push("return function construct_"+p+"(data,shape,stride,offset){return new "+p+"(data,"+h.map(function(B){return"shape["+B+"]"}).join(",")+","+h.map(function(B){return"stride["+B+"]"}).join(",")+",offset)}");var U=new Function("CTOR_LIST","ORDER",R.join(`
`));return U(f[y],o)}function u(y){if(r(y))return"buffer";if(s)switch(Object.prototype.toString.call(y)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(y)?"array":"generic"}var f={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};function m(y,g,p,M){if(y===void 0){var S=f.array[0];return S([])}else typeof y=="number"&&(y=[y]);g===void 0&&(g=[y.length]);var R=g.length;if(p===void 0){p=new Array(R);for(var h=R-1,V=1;h>=0;--h)p[h]=V,V*=g[h]}if(M===void 0){M=0;for(var h=0;h<R;++h)p[h]<0&&(M-=(g[h]-1)*p[h])}for(var I=u(y),C=f[I];C.length<=R+1;)C.push(a(I,C.length-1));var S=C[R+1];return S(y,g,p,M)}t.exports=m}});function ga(){return ga=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ga.apply(null,arguments)}function Dp(e,t){return Object.defineProperty(t,"name",{value:e}),t}function Pp(){var e=new hs(3);return hs!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function ma(e,t,n,r){const s=new Set;for(const i of n){if(qu.has(i.propertyType))throw new Error(`Type "${i.propertyType}" cannot be transferred.`);Lp(i,s)}return Fp(e,t,Array.from(s),r)}function Fp(e,t,n,r){r||(r=Up(e,t));const s=new Map;for(const i of n)!s.has(i)&&i.propertyType!==Ys&&s.set(i,r(i));for(const[i,o]of s.entries())o.copy(i,r);return s}function Up(e,t){const n=new Map([[t.getRoot(),e.getRoot()]]);return r=>{if(r.propertyType===Ys)return r;let s=n.get(r);if(!s){const i=r.constructor;s=new i(e.getGraph()),n.set(r,s)}return s}}function Lp(e,t){const n=e.getGraph(),r=[e];let s;for(;s=r.pop();){t.add(s);for(const i of n.listChildren(s))t.has(i)||r.push(i)}return t}function kp(){var e=new hs(4);return hs!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function jp(e,t,n,r=1e-4){const s=t.length/e.length,i=new Array(s).fill(0),o=new Array(s).fill(0),a=new Array(s).fill(0),u=new Array(s).fill(0),f=e.length-1;let m=1;for(let y=1;y<f;++y){const g=e[m-1],p=e[y],M=e[y+1],R=(p-g)/(M-g);let h=!1;if(p!==M&&(y!==1||p!==e[0]))if(zr(t,m-1,u),zr(t,y,o),zr(t,y+1,a),n==="slerp"){const V=Vp(i,u,a,R),I=ac(u,o)+ac(o,a);h=!Fs(o,V,r)||I+Number.EPSILON>=Math.PI}else if(n==="lerp"){const V=$p(i,u,a,R);h=!Fs(o,V,r)}else n==="step"&&(h=!Fs(o,u)||!Fs(o,a));h&&(y!==m&&(e[m]=e[y],oc(t,m,zr(t,y,i))),m++)}return f>0&&(e[m]=e[f],oc(t,m,zr(t,f,i)),m++),m}function zr(e,t,n){for(let r=0,s=n.length;r<s;r++)n[r]=e[t*s+r];return n}function oc(e,t,n){for(let r=0,s=n.length;r<s;r++)e[t*s+r]=n[r]}function Fs(e,t,n=0){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(Math.abs(e[r]-t[r])>n)return!1;return!0}function Bp(e,t,n){return e*(1-n)+t*n}function $p(e,t,n,r){for(let s=0;s<t.length;s++)e[s]=Bp(t[s],n[s],r);return e}function Vp(e,t,n,r){let s=t[0],i=t[1],o=t[2],a=t[3],u=n[0],f=n[1],m=n[2],y=n[3],g,p,M,R,h;return p=s*u+i*f+o*m+a*y,p<0&&(p=-p,u=-u,f=-f,m=-m,y=-y),1-p>Ku?(g=Math.acos(p),M=Math.sin(g),R=Math.sin((1-r)*g)/M,h=Math.sin(r*g)/M):(R=1-r,h=r),e[0]=R*s+h*u,e[1]=R*i+h*f,e[2]=R*o+h*m,e[3]=R*a+h*y,e}function ac(e,t){const n=Gp(e,t);return Math.acos(2*n*n-1)}function Gp(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function zp(e=Yu){return Dp(ya,async t=>{const n=t.getLogger(),r=t.getRoot().listBuffers()[0];t.getRoot().listAccessors().forEach(s=>s.setBuffer(r)),t.getRoot().listBuffers().forEach((s,i)=>i>0?s.dispose():null),n.debug(`${ya}: Complete.`)})}var Hp,Wp,Xp,qp,Kp,Yp,Jp,hs,lc,Zp,Qp,eg,tg,ng,rg,sg,Ys,cc,qu,ig,og,ag,lg,cg,ug,fg,hg,dg,pg,gg,mg,yg,uc,fc,Ku,vg,Tg,xg,wg,Eg,bg,_g,Jo,ya,Yu,Ju=ut({"node_modules/@gltf-transform/functions/dist/functions.modern.js"(){ar(),ps(Op()),{POINTS:Hp,LINES:Wp,LINE_STRIP:Xp,LINE_LOOP:qp,TRIANGLES:Kp,TRIANGLE_STRIP:Yp,TRIANGLE_FAN:Jp}=_n.Mode,hs=typeof Float32Array<"u"?Float32Array:Array,(function(e){e.RENDER="render",e.RENDER_CACHED="render-cached",e.UPLOAD="upload",e.UPLOAD_NAIVE="upload-naive",e.DISTINCT="distinct",e.DISTINCT_POSITION="distinct-position",e.UNUSED="unused"})(lc||(lc={})),(function(){var e=Pp();return function(t,n,r,s,i,o){var a,u;for(n||(n=3),r||(r=0),s?u=Math.min(s*n+r,t.length):u=t.length,a=r;a<u;a+=n)e[0]=t[a],e[1]=t[a+1],e[2]=t[a+2],i(e,e,o),t[a]=e[0],t[a+1]=e[1],t[a+2]=e[2];return t}})(),{FLOAT:Zp}=ge.ComponentType,{LINES:Qp,LINE_STRIP:eg,LINE_LOOP:tg,TRIANGLES:ng,TRIANGLE_STRIP:rg,TRIANGLE_FAN:sg}=_n.Mode,k.ACCESSOR,k.MESH,k.TEXTURE,k.MATERIAL,k.SKIN,{TEXTURE_INFO:Ys,ROOT:cc}=k,qu=new Set([Ys,cc]),(function(){var e=kp();return function(t,n,r,s,i,o){var a,u;for(n||(n=4),r||(r=0),s?u=Math.min(s*n+r,t.length):u=t.length,a=r;a<u;a+=n)e[0]=t[a],e[1]=t[a+1],e[2]=t[a+2],e[3]=t[a+3],i(e,e,o),t[a]=e[0],t[a+1]=e[1],t[a+2]=e[2],t[a+3]=e[3];return t}})(),k.NODE,k.SKIN,k.MESH,k.CAMERA,k.PRIMITIVE,k.PRIMITIVE_TARGET,k.ANIMATION,k.MATERIAL,k.TEXTURE,k.ACCESSOR,k.BUFFER,{LINE_STRIP:ig,LINE_LOOP:og,TRIANGLE_STRIP:ag,TRIANGLE_FAN:lg}=_n.Mode,{ROOT:cg,NODE:ug,MESH:fg,PRIMITIVE:hg,ACCESSOR:dg}=k,{TRANSLATION:pg,ROTATION:gg,SCALE:mg,WEIGHTS:yg}=Qr.TargetPath,uc={pattern:/.*/,quantizationVolume:"mesh",quantizePosition:14,quantizeNormal:10,quantizeTexcoord:12,quantizeColor:8,quantizeWeight:8,quantizeGeneric:12,normalizeWeights:!0,cleanup:!0},ga({level:"high"},uc),(function(e){e[e.STEP=0]="STEP",e[e.LERP=1]="LERP",e[e.SLERP=2]="SLERP"})(fc||(fc={})),Ku=1e-6,Promise.resolve(),{POINTS:vg,LINES:Tg,LINE_STRIP:xg,LINE_LOOP:wg,TRIANGLES:Eg,TRIANGLE_STRIP:bg,TRIANGLE_FAN:_g}=_n.Mode,(function(e){e.LANCZOS3="lanczos3",e.LANCZOS2="lanczos2"})(Jo||(Jo={})),Jo.LANCZOS3,ya="unpartition",Yu={}}});function Rg(e){const t=di.flatMap(r=>r.importFormats),n=Oa(e,t)??Na(e,t);if(!n)throw new Ca(e,t);return n}function fi(e){const t=typeof e=="string"?Rg(e):e;return di.find(n=>n.importFormats.includes(t))}function Ig(e){di.push(e)}async function Zu(e,t={}){const n=await Ag(e,t),r=n.getRoot().listNodes();if(!r.length)throw new $n(`Model imported from \`${e}\` contains no nodes.`);const s=new ei;if(s.document=n,r.length==1){const[i]=r;s.node=i,s.name=i.getName()}return typeof e=="string"&&(s.uri=e),s}async function Sg(e,t={}){const{document:n,node:r}=await Zu(e,t);try{return Ng(n,r,t.tolerance)}catch(s){if(s instanceof $n){const i=new Error(`Model imported from \`${e}\` contains no manifold geometry.`);throw i.cause=s,i}throw s}}async function Ag(e,t={}){if(e instanceof Blob)return await Mg(e,t);if(e instanceof ArrayBuffer)return await Cg(e,t.mimetype);let n=null;if(e instanceof URL?n=e.href:typeof e=="string"&&(n=e),n)return n.startsWith("data:")||n.startsWith("blob:")?await Zo(n,t):/^https?:\/\//.test(n)?await Zo(n,t):n.startsWith("file:")?hc(n,t):ms()?await hc(n,t):await Zo(n,t);throw new $n(`Could not import model \`${e}\`.`)}async function Zo(e,t={}){const n=fi(t.mimetype??e),s=await(await fetch(e)).blob();return hi(await n.fromArrayBuffer(await s.arrayBuffer(),t))}async function Mg(e,t={}){if(!e.type&&!t.mimetype)throw new $n("Could not infer format of Blob");const n=fi(t.mimetype??e.type);return hi(await n.fromArrayBuffer(await e.arrayBuffer(),t))}async function Cg(e,t){if(!t)throw new $n("Must specify a mime type when reading an ArrayBuffer");const n=fi(t);return hi(await n.fromArrayBuffer(e))}async function hc(e,t={}){if(!ms())throw new $n("Must have a filesystem to read files.");const n=fi(t.mimetype??e),r=await import("./__vite-browser-external-9wXp6ZBx.js"),{fileURLToPath:s}=await import("./__vite-browser-external-9wXp6ZBx.js"),i=e.startsWith("file:")?s(e):e,o=(await r.readFile(i)).buffer;return hi(await n.fromArrayBuffer(o,t))}function hi(e){for(const t of e.getRoot().listNodes()){if(t.getParentNode())continue;const n=t.getScale();t.setScale([n[0]*1e3,n[1]*1e3,n[2]*1e3]);const r=t.getRotation(),s=dd(r,ti([90,0,0]));t.setRotation(s)}return e}function Ng(e,t,n){const r=Og(e,t);if(!r.length)throw new $n("Model contains no meshes!");return Dg(r,n)}function Og(e,t){const n=[],r=s=>s.traverse(i=>n.push(i));if(t)r(t);else for(const s of e.getRoot().listNodes())s.getParentNode()||r(s);return n.map(s=>{const i=s.getMesh();return i?($s.set(s,e),rs.set(i,s),Pg(i)):null}).filter(s=>!!s)}function Dg(e,t){const{Manifold:n}=Rn(),r=[];for(const s of e){let i=Vs(s);if(i||(s.merge(),i=Vs(s)),!i&&t&&(s.tolerance=t,s.merge(),i=Vs(s)),!i)continue;const o=Js.get(s),a=o?rs.get(o):null;a?r.push(i.transform(a.getWorldMatrix())):r.push(i)}if(!r?.length)throw new $n("Model contains no manifold geometry.");return n.union(r)}function Pg(e){const{Manifold:t,Mesh:n}=Rn(),{mesh:r,runProperties:s}=ju(e),i=s.length,o=t.reserveIDs(i);r.runOriginalID=new Uint32Array(i);for(let u=0;u<i;++u){const f=o+u;r.runOriginalID[u]=f;const{attributes:m,material:y}=s[u];Bs.set(f,e),rf(f,{attributes:m.filter(g=>g!=="POSITION"),alpha:y.getAlpha(),baseColorFactor:y.getBaseColorFactor(),metallic:y.getMetallicFactor(),roughness:y.getRoughnessFactor(),name:y.getName(),sourceMaterial:y,sourceRunID:f})}const a=new n(r);return Js.set(a,e),a}var di,Bs,rs,Js,$s,Qu,ef,Vs,Ua=ut({"lib/import-model.ts"(){si(),li(),lr(),ys(),Aa(),ii(),Ar(),di=[],Ig(Da),Bs=new Map,rs=new Map,Js=new Map,$s=new Map,Qu=()=>{Bs.clear(),rs.clear(),Js.clear(),$s.clear()},ef=e=>{const t=Bs.get(e);if(!t)return null;const n=rs.get(t);return n?$s.get(n)??null:null},Vs=e=>{const{Manifold:t}=Rn();try{const n=new t(e);if(n&&!n.isEmpty())return n}catch(n){if(!(n?.name==="ManifoldError"||n?.code==="NotManifold"))throw n}return null}}});function Fg(){ss.clear(),is.clear()}function Ug(e,t){const n=e.asOriginal();return ss.set(n.originalID(),t),n}function tf(e){return e!=null&&(e instanceof sr||e instanceof ir)?e.material==null?tf(e.parent):e.material:{}}function Lg(e,t={}){if(!t.sourceMaterial||!t.sourceRunID)return null;const n=ef(t.sourceRunID),r=t.sourceMaterial;return ma(e,n,[r]).get(r)}function kg(e,t={}){const{roughness:n,metallic:r,baseColorFactor:s,alpha:i,unlit:o,doubleSided:a}={...nf,...t},u=Lg(e,t)??e.createMaterial(t.name??"");if(o){const f=e.createExtension(js).createUnlit();u.setExtension("KHR_materials_unlit",f)}return i<1&&u.setAlphaMode(Qn.AlphaMode.BLEND).setDoubleSided(!0),u.setRoughnessFactor(n).setMetallicFactor(r).setBaseColorFactor([...s,i]).setDoubleSided(!!a)}function ds(e,t){return is.has(t)||is.set(t,kg(e,t)),is.get(t)}var nf,ss,is,va,rf,ys=ut({"lib/material.ts"(){ar(),Lu(),Ju(),lr(),Ua(),nf={roughness:.2,metallic:1,baseColorFactor:[1,1,0],alpha:1,unlit:!1,doubleSided:!1},ss=new Map,is=new Map,va=e=>ss.get(e),rf=(e,t)=>{ss.set(e,t)}}});function jg(){Zs=!1,tr.clear(),os.clear()}function Bg(e){return La(e,tr)}function $g(e){return Zs=!0,La(e,os)}var Zs,tr,os,dc,pc,gc,mc,sf,La,of,ka=ut({"lib/debug.ts"(){li(),ys(),Zs=!1,tr=new Map,os=new Map,dc={baseColorFactor:[1,0,0],alpha:.25,roughness:1,metallic:0},pc={baseColorFactor:[.5,.5,.5],alpha:.25,roughness:1,metallic:0},gc=e=>tr.has(e)?tr.get(e):os.get(e),mc=e=>{const t=tr.has(e),n=t?tr.get(e):os.get(e);return t&&n?dc:va(e)},sf=e=>Zs?pc:va(e),La=(e,t)=>{let n=e.asOriginal();return t.set(n.originalID(),n.getMesh()),n},of=(e,t,n,r={})=>{const s=[];for(const[i,o]of t.runOriginalID.entries()){const a=gc(o);if(!a)continue;const u=mc(o)||r;n.get(o).material=ds(e,u);const f=e.createNode("debug").setMesh(ai(e,a,n)).setMatrix(t.transform(i));s.push(f)}return s}}}),af={};Sa(af,{CrossSection:()=>uf,CrossSectionGLTFNode:()=>ir,GLTFNode:()=>sr,Manifold:()=>cf,Mesh:()=>lf,VisualizationGLTFNode:()=>ei,getAnimationDuration:()=>vd,getAnimationFPS:()=>xd,getAnimationMode:()=>md,getCircularSegments:()=>Mp,getGLTFNodes:()=>gf,getMinCircularAngle:()=>Sp,getMinCircularEdgeLength:()=>Ap,importManifold:()=>Sg,importModel:()=>Zu,isManifoldCAD:()=>yf,only:()=>df,resetGLTFNodes:()=>mf,setMaterial:()=>pf,setMorphEnd:()=>Id,setMorphStart:()=>Rd,show:()=>hf,triangulate:()=>ff});var yc,lf,cf,uf,ff,hf,df,pf,gf,mf,yf,Vg=ut({async"lib/manifoldCAD.ts"(){ka(),Hu(),ys(),Ar(),ri(),lr(),Ua(),Fa(),yc=zu(await Gc()),{Mesh:lf,Manifold:cf,CrossSection:uf,triangulate:ff}=yc,hf=ns(Bg),df=ns($g),pf=ns(Ug),gf=()=>[],mf=()=>{},yf=()=>!1}});ri();var Gg=ps(tu()),vf=ps(Md());iu();var vc=class Tf{constructor(t){this.bits=t instanceof Tf?t.bits.slice():[]}add(t){this.bits[t>>5]|=1<<(t&31)}has(t){return!!(this.bits[t>>5]&1<<(t&31))}},Tc=class Ta{constructor(t,n,r){this.start=t,this.end=n,this.original=r,this.intro="",this.outro="",this.content=r,this.storeName=!1,this.edited=!1,this.previous=null,this.next=null}appendLeft(t){this.outro+=t}appendRight(t){this.intro=this.intro+t}clone(){const t=new Ta(this.start,this.end,this.original);return t.intro=this.intro,t.outro=this.outro,t.content=this.content,t.storeName=this.storeName,t.edited=this.edited,t}contains(t){return this.start<t&&t<this.end}eachNext(t){let n=this;for(;n;)t(n),n=n.next}eachPrevious(t){let n=this;for(;n;)t(n),n=n.previous}edit(t,n,r){return this.content=t,r||(this.intro="",this.outro=""),this.storeName=n,this.edited=!0,this}prependLeft(t){this.outro=t+this.outro}prependRight(t){this.intro=t+this.intro}reset(){this.intro="",this.outro="",this.edited&&(this.content=this.original,this.storeName=!1,this.edited=!1)}split(t){const n=t-this.start,r=this.original.slice(0,n),s=this.original.slice(n);this.original=r;const i=new Ta(t,this.end,s);return i.outro=this.outro,this.outro="",this.end=t,this.edited?(i.edit("",!1),this.content=""):this.content=r,i.next=this.next,i.next&&(i.next.previous=i),i.previous=this,this.next=i,i}toString(){return this.intro+this.content+this.outro}trimEnd(t){if(this.outro=this.outro.replace(t,""),this.outro.length)return!0;const n=this.content.replace(t,"");if(n.length)return n!==this.content&&(this.split(this.start+n.length).edit("",void 0,!0),this.edited&&this.edit(n,this.storeName,!0)),!0;if(this.edit("",void 0,!0),this.intro=this.intro.replace(t,""),this.intro.length)return!0}trimStart(t){if(this.intro=this.intro.replace(t,""),this.intro.length)return!0;const n=this.content.replace(t,"");if(n.length){if(n!==this.content){const r=this.split(this.end-n.length);this.edited&&r.edit(n,this.storeName,!0),this.edit("",void 0,!0)}return!0}else if(this.edit("",void 0,!0),this.outro=this.outro.replace(t,""),this.outro.length)return!0}};function zg(){return typeof globalThis<"u"&&typeof globalThis.btoa=="function"?e=>globalThis.btoa(unescape(encodeURIComponent(e))):typeof Buffer=="function"?e=>Buffer.from(e,"utf-8").toString("base64"):()=>{throw new Error("Unsupported environment: `window.btoa` or `Buffer` should be supported.")}}var Hg=zg(),Wg=class{constructor(e){this.version=3,this.file=e.file,this.sources=e.sources,this.sourcesContent=e.sourcesContent,this.names=e.names,this.mappings=Dd(e.mappings),typeof e.x_google_ignoreList<"u"&&(this.x_google_ignoreList=e.x_google_ignoreList),typeof e.debugId<"u"&&(this.debugId=e.debugId)}toString(){return JSON.stringify(this)}toUrl(){return"data:application/json;charset=utf-8;base64,"+Hg(this.toString())}};function Xg(e){const t=e.split(`
`),n=t.filter(i=>/^\t+/.test(i)),r=t.filter(i=>/^ {2,}/.test(i));if(n.length===0&&r.length===0)return null;if(n.length>=r.length)return"	";const s=r.reduce((i,o)=>{const a=/^ +/.exec(o)[0].length;return Math.min(a,i)},1/0);return new Array(s+1).join(" ")}function qg(e,t){const n=e.split(/[/\\]/),r=t.split(/[/\\]/);for(n.pop();n[0]===r[0];)n.shift(),r.shift();if(n.length){let s=n.length;for(;s--;)n[s]=".."}return n.concat(r).join("/")}var Kg=Object.prototype.toString;function Yg(e){return Kg.call(e)==="[object Object]"}function xc(e){const t=e.split(`
`),n=[];for(let r=0,s=0;r<t.length;r++)n.push(s),s+=t[r].length+1;return function(s){let i=0,o=n.length;for(;i<o;){const f=i+o>>1;s<n[f]?o=f:i=f+1}const a=i-1,u=s-n[a];return{line:a,column:u}}}var Jg=/\w/,Zg=class{constructor(e){this.hires=e,this.generatedCodeLine=0,this.generatedCodeColumn=0,this.raw=[],this.rawSegments=this.raw[this.generatedCodeLine]=[],this.pending=null}addEdit(e,t,n,r){if(t.length){const s=t.length-1;let i=t.indexOf(`
`,0),o=-1;for(;i>=0&&s>i;){const u=[this.generatedCodeColumn,e,n.line,n.column];r>=0&&u.push(r),this.rawSegments.push(u),this.generatedCodeLine+=1,this.raw[this.generatedCodeLine]=this.rawSegments=[],this.generatedCodeColumn=0,o=i,i=t.indexOf(`
`,i+1)}const a=[this.generatedCodeColumn,e,n.line,n.column];r>=0&&a.push(r),this.rawSegments.push(a),this.advance(t.slice(o+1))}else this.pending&&(this.rawSegments.push(this.pending),this.advance(t));this.pending=null}addUneditedChunk(e,t,n,r,s){let i=t.start,o=!0,a=!1;for(;i<t.end;){if(n[i]===`
`)r.line+=1,r.column=0,this.generatedCodeLine+=1,this.raw[this.generatedCodeLine]=this.rawSegments=[],this.generatedCodeColumn=0,o=!0,a=!1;else{if(this.hires||o||s.has(i)){const u=[this.generatedCodeColumn,e,r.line,r.column];this.hires==="boundary"?Jg.test(n[i])?a||(this.rawSegments.push(u),a=!0):(this.rawSegments.push(u),a=!1):this.rawSegments.push(u)}r.column+=1,this.generatedCodeColumn+=1,o=!1}i+=1}this.pending=null}advance(e){if(!e)return;const t=e.split(`
`);if(t.length>1){for(let n=0;n<t.length-1;n++)this.generatedCodeLine++,this.raw[this.generatedCodeLine]=this.rawSegments=[];this.generatedCodeColumn=0}this.generatedCodeColumn+=t[t.length-1].length}},Hr=`
`,Er={insertLeft:!1,insertRight:!1,storeName:!1},Qg=class xf{constructor(t,n={}){const r=new Tc(0,t.length,t);Object.defineProperties(this,{original:{writable:!0,value:t},outro:{writable:!0,value:""},intro:{writable:!0,value:""},firstChunk:{writable:!0,value:r},lastChunk:{writable:!0,value:r},lastSearchedChunk:{writable:!0,value:r},byStart:{writable:!0,value:{}},byEnd:{writable:!0,value:{}},filename:{writable:!0,value:n.filename},indentExclusionRanges:{writable:!0,value:n.indentExclusionRanges},sourcemapLocations:{writable:!0,value:new vc},storedNames:{writable:!0,value:{}},indentStr:{writable:!0,value:void 0},ignoreList:{writable:!0,value:n.ignoreList},offset:{writable:!0,value:n.offset||0}}),this.byStart[0]=r,this.byEnd[t.length]=r}addSourcemapLocation(t){this.sourcemapLocations.add(t)}append(t){if(typeof t!="string")throw new TypeError("outro content must be a string");return this.outro+=t,this}appendLeft(t,n){if(t=t+this.offset,typeof n!="string")throw new TypeError("inserted content must be a string");this._split(t);const r=this.byEnd[t];return r?r.appendLeft(n):this.intro+=n,this}appendRight(t,n){if(t=t+this.offset,typeof n!="string")throw new TypeError("inserted content must be a string");this._split(t);const r=this.byStart[t];return r?r.appendRight(n):this.outro+=n,this}clone(){const t=new xf(this.original,{filename:this.filename,offset:this.offset});let n=this.firstChunk,r=t.firstChunk=t.lastSearchedChunk=n.clone();for(;n;){t.byStart[r.start]=r,t.byEnd[r.end]=r;const s=n.next,i=s&&s.clone();i&&(r.next=i,i.previous=r,r=i),n=s}return t.lastChunk=r,this.indentExclusionRanges&&(t.indentExclusionRanges=this.indentExclusionRanges.slice()),t.sourcemapLocations=new vc(this.sourcemapLocations),t.intro=this.intro,t.outro=this.outro,t}generateDecodedMap(t){t=t||{};const n=0,r=Object.keys(this.storedNames),s=new Zg(t.hires),i=xc(this.original);return this.intro&&s.advance(this.intro),this.firstChunk.eachNext(o=>{const a=i(o.start);o.intro.length&&s.advance(o.intro),o.edited?s.addEdit(n,o.content,a,o.storeName?r.indexOf(o.original):-1):s.addUneditedChunk(n,o,this.original,a,this.sourcemapLocations),o.outro.length&&s.advance(o.outro)}),this.outro&&s.advance(this.outro),{file:t.file?t.file.split(/[/\\]/).pop():void 0,sources:[t.source?qg(t.file||"",t.source):t.file||""],sourcesContent:t.includeContent?[this.original]:void 0,names:r,mappings:s.raw,x_google_ignoreList:this.ignoreList?[n]:void 0}}generateMap(t){return new Wg(this.generateDecodedMap(t))}_ensureindentStr(){this.indentStr===void 0&&(this.indentStr=Xg(this.original))}_getRawIndentString(){return this._ensureindentStr(),this.indentStr}getIndentString(){return this._ensureindentStr(),this.indentStr===null?"	":this.indentStr}indent(t,n){const r=/^[^\r\n]/gm;if(Yg(t)&&(n=t,t=void 0),t===void 0&&(this._ensureindentStr(),t=this.indentStr||"	"),t==="")return this;n=n||{};const s={};n.exclude&&(typeof n.exclude[0]=="number"?[n.exclude]:n.exclude).forEach(m=>{for(let y=m[0];y<m[1];y+=1)s[y]=!0});let i=n.indentStart!==!1;const o=f=>i?`${t}${f}`:(i=!0,f);this.intro=this.intro.replace(r,o);let a=0,u=this.firstChunk;for(;u;){const f=u.end;if(u.edited)s[a]||(u.content=u.content.replace(r,o),u.content.length&&(i=u.content[u.content.length-1]===`
`));else for(a=u.start;a<f;){if(!s[a]){const m=this.original[a];m===`
`?i=!0:m!=="\r"&&i&&(i=!1,a===u.start||(this._splitChunk(u,a),u=u.next),u.prependRight(t))}a+=1}a=u.end,u=u.next}return this.outro=this.outro.replace(r,o),this}insert(){throw new Error("magicString.insert(...) is deprecated. Use prependRight(...) or appendLeft(...)")}insertLeft(t,n){return Er.insertLeft||(console.warn("magicString.insertLeft(...) is deprecated. Use magicString.appendLeft(...) instead"),Er.insertLeft=!0),this.appendLeft(t,n)}insertRight(t,n){return Er.insertRight||(console.warn("magicString.insertRight(...) is deprecated. Use magicString.prependRight(...) instead"),Er.insertRight=!0),this.prependRight(t,n)}move(t,n,r){if(t=t+this.offset,n=n+this.offset,r=r+this.offset,r>=t&&r<=n)throw new Error("Cannot move a selection inside itself");this._split(t),this._split(n),this._split(r);const s=this.byStart[t],i=this.byEnd[n],o=s.previous,a=i.next,u=this.byStart[r];if(!u&&i===this.lastChunk)return this;const f=u?u.previous:this.lastChunk;return o&&(o.next=a),a&&(a.previous=o),f&&(f.next=s),u&&(u.previous=i),s.previous||(this.firstChunk=i.next),i.next||(this.lastChunk=s.previous,this.lastChunk.next=null),s.previous=f,i.next=u||null,f||(this.firstChunk=s),u||(this.lastChunk=i),this}overwrite(t,n,r,s){return s=s||{},this.update(t,n,r,{...s,overwrite:!s.contentOnly})}update(t,n,r,s){if(t=t+this.offset,n=n+this.offset,typeof r!="string")throw new TypeError("replacement content must be a string");if(this.original.length!==0){for(;t<0;)t+=this.original.length;for(;n<0;)n+=this.original.length}if(n>this.original.length)throw new Error("end is out of bounds");if(t===n)throw new Error("Cannot overwrite a zero-length range  use appendLeft or prependRight instead");this._split(t),this._split(n),s===!0&&(Er.storeName||(console.warn("The final argument to magicString.overwrite(...) should be an options object. See https://github.com/rich-harris/magic-string"),Er.storeName=!0),s={storeName:!0});const i=s!==void 0?s.storeName:!1,o=s!==void 0?s.overwrite:!1;if(i){const f=this.original.slice(t,n);Object.defineProperty(this.storedNames,f,{writable:!0,value:!0,enumerable:!0})}const a=this.byStart[t],u=this.byEnd[n];if(a){let f=a;for(;f!==u;){if(f.next!==this.byStart[f.end])throw new Error("Cannot overwrite across a split point");f=f.next,f.edit("",!1)}a.edit(r,i,!o)}else{const f=new Tc(t,n,"").edit(r,i);u.next=f,f.previous=u}return this}prepend(t){if(typeof t!="string")throw new TypeError("outro content must be a string");return this.intro=t+this.intro,this}prependLeft(t,n){if(t=t+this.offset,typeof n!="string")throw new TypeError("inserted content must be a string");this._split(t);const r=this.byEnd[t];return r?r.prependLeft(n):this.intro=n+this.intro,this}prependRight(t,n){if(t=t+this.offset,typeof n!="string")throw new TypeError("inserted content must be a string");this._split(t);const r=this.byStart[t];return r?r.prependRight(n):this.outro=n+this.outro,this}remove(t,n){if(t=t+this.offset,n=n+this.offset,this.original.length!==0){for(;t<0;)t+=this.original.length;for(;n<0;)n+=this.original.length}if(t===n)return this;if(t<0||n>this.original.length)throw new Error("Character is out of bounds");if(t>n)throw new Error("end must be greater than start");this._split(t),this._split(n);let r=this.byStart[t];for(;r;)r.intro="",r.outro="",r.edit(""),r=n>r.end?this.byStart[r.end]:null;return this}reset(t,n){if(t=t+this.offset,n=n+this.offset,this.original.length!==0){for(;t<0;)t+=this.original.length;for(;n<0;)n+=this.original.length}if(t===n)return this;if(t<0||n>this.original.length)throw new Error("Character is out of bounds");if(t>n)throw new Error("end must be greater than start");this._split(t),this._split(n);let r=this.byStart[t];for(;r;)r.reset(),r=n>r.end?this.byStart[r.end]:null;return this}lastChar(){if(this.outro.length)return this.outro[this.outro.length-1];let t=this.lastChunk;do{if(t.outro.length)return t.outro[t.outro.length-1];if(t.content.length)return t.content[t.content.length-1];if(t.intro.length)return t.intro[t.intro.length-1]}while(t=t.previous);return this.intro.length?this.intro[this.intro.length-1]:""}lastLine(){let t=this.outro.lastIndexOf(Hr);if(t!==-1)return this.outro.substr(t+1);let n=this.outro,r=this.lastChunk;do{if(r.outro.length>0){if(t=r.outro.lastIndexOf(Hr),t!==-1)return r.outro.substr(t+1)+n;n=r.outro+n}if(r.content.length>0){if(t=r.content.lastIndexOf(Hr),t!==-1)return r.content.substr(t+1)+n;n=r.content+n}if(r.intro.length>0){if(t=r.intro.lastIndexOf(Hr),t!==-1)return r.intro.substr(t+1)+n;n=r.intro+n}}while(r=r.previous);return t=this.intro.lastIndexOf(Hr),t!==-1?this.intro.substr(t+1)+n:this.intro+n}slice(t=0,n=this.original.length-this.offset){if(t=t+this.offset,n=n+this.offset,this.original.length!==0){for(;t<0;)t+=this.original.length;for(;n<0;)n+=this.original.length}let r="",s=this.firstChunk;for(;s&&(s.start>t||s.end<=t);){if(s.start<n&&s.end>=n)return r;s=s.next}if(s&&s.edited&&s.start!==t)throw new Error(`Cannot use replaced character ${t} as slice start anchor.`);const i=s;for(;s;){s.intro&&(i!==s||s.start===t)&&(r+=s.intro);const o=s.start<n&&s.end>=n;if(o&&s.edited&&s.end!==n)throw new Error(`Cannot use replaced character ${n} as slice end anchor.`);const a=i===s?t-s.start:0,u=o?s.content.length+n-s.end:s.content.length;if(r+=s.content.slice(a,u),s.outro&&(!o||s.end===n)&&(r+=s.outro),o)break;s=s.next}return r}snip(t,n){const r=this.clone();return r.remove(0,t),r.remove(n,r.original.length),r}_split(t){if(this.byStart[t]||this.byEnd[t])return;let n=this.lastSearchedChunk,r=n;const s=t>n.end;for(;n;){if(n.contains(t))return this._splitChunk(n,t);if(n=s?this.byStart[n.end]:this.byEnd[n.start],n===r)return;r=n}}_splitChunk(t,n){if(t.edited&&t.content.length){const s=xc(this.original)(n);throw new Error(`Cannot split a chunk that has already been edited (${s.line}:${s.column}  "${t.original}")`)}const r=t.split(n);return this.byEnd[n]=t,this.byStart[n]=r,this.byEnd[r.end]=r,t===this.lastChunk&&(this.lastChunk=r),this.lastSearchedChunk=t,!0}toString(){let t=this.intro,n=this.firstChunk;for(;n;)t+=n.toString(),n=n.next;return t+this.outro}isEmpty(){let t=this.firstChunk;do if(t.intro.length&&t.intro.trim()||t.content.length&&t.content.trim()||t.outro.length&&t.outro.trim())return!1;while(t=t.next);return!0}length(){let t=this.firstChunk,n=0;do n+=t.intro.length+t.content.length+t.outro.length;while(t=t.next);return n}trimLines(){return this.trim("[\\r\\n]")}trim(t){return this.trimStart(t).trimEnd(t)}trimEndAborted(t){const n=new RegExp((t||"\\s")+"+$");if(this.outro=this.outro.replace(n,""),this.outro.length)return!0;let r=this.lastChunk;do{const s=r.end,i=r.trimEnd(n);if(r.end!==s&&(this.lastChunk===r&&(this.lastChunk=r.next),this.byEnd[r.end]=r,this.byStart[r.next.start]=r.next,this.byEnd[r.next.end]=r.next),i)return!0;r=r.previous}while(r);return!1}trimEnd(t){return this.trimEndAborted(t),this}trimStartAborted(t){const n=new RegExp("^"+(t||"\\s")+"+");if(this.intro=this.intro.replace(n,""),this.intro.length)return!0;let r=this.firstChunk;do{const s=r.end,i=r.trimStart(n);if(r.end!==s&&(r===this.lastChunk&&(this.lastChunk=r.next),this.byEnd[r.end]=r,this.byStart[r.next.start]=r.next,this.byEnd[r.next.end]=r.next),i)return!0;r=r.next}while(r);return!1}trimStart(t){return this.trimStartAborted(t),this}hasChanged(){return this.original!==this.toString()}_replaceRegexp(t,n){function r(i,o){return typeof n=="string"?n.replace(/\$(\$|&|\d+)/g,(a,u)=>u==="$"?"$":u==="&"?i[0]:+u<i.length?i[+u]:`$${u}`):n(...i,i.index,o,i.groups)}function s(i,o){let a;const u=[];for(;a=i.exec(o);)u.push(a);return u}if(t.global)s(t,this.original).forEach(o=>{if(o.index!=null){const a=r(o,this.original);a!==o[0]&&this.overwrite(o.index,o.index+o[0].length,a)}});else{const i=this.original.match(t);if(i&&i.index!=null){const o=r(i,this.original);o!==i[0]&&this.overwrite(i.index,i.index+i[0].length,o)}}return this}_replaceString(t,n){const{original:r}=this,s=r.indexOf(t);return s!==-1&&(typeof n=="function"&&(n=n(t,s,r)),t!==n&&this.overwrite(s,s+t.length,n)),this}replace(t,n){return typeof t=="string"?this._replaceString(t,n):this._replaceRegexp(t,n)}_replaceAllString(t,n){const{original:r}=this,s=t.length;for(let i=r.indexOf(t);i!==-1;i=r.indexOf(t,i+s)){const o=r.slice(i,i+s);let a=n;typeof n=="function"&&(a=n(o,i,r)),o!==a&&this.overwrite(i,i+s,a)}return this}replaceAll(t,n){if(typeof t=="string")return this._replaceAllString(t,n);if(!t.global)throw new TypeError("MagicString.prototype.replaceAll called with a non-global RegExp argument");return this._replaceRegexp(t,n)}};si();ii();var Gs=null,wf=!1,em=e=>{Gs=e},tm=e=>{wf=e},nm={"esm.sh":e=>`https://esm.sh/${e}`,jsDelivr:e=>`https://cdn.jsdelivr.net/npm/${e}/+esm`,skypack:e=>`https://cdn.skypack.dev/${e}`},wc=(e,t)=>{if(!t)return e;const n=nm[t];return n?n(e):`${t}${e}`};function rm(...e){typeof self<"u"&&self.console&&self.console.log(...e)}var xa=(e,t)=>{if(t){const n=new Qg(e);n.prepend(`const _import_meta_url=_manifold_runtime_url ?? '${t}';
`);const r=n.generateMap({hires:!0});return`${n.toString()}
//# sourceMappingURL=${r.toUrl()}`}return e},sm=(e={})=>({name:"esbuild-manifold-plugin",async setup(t){let n=null;const r="manifold-3d/manifoldCAD",s=/^manifold-3d\/manifoldCAD(.ts|.js)?$/,i=["Mesh","Manifold","CrossSection","triangulate","show","only","setMaterial","GLTFMaterial","GLTFNode","getGLTFNodes","VisualizationGLTFNode","CrossSectionGLTFNode","importModel","importManifold","getCircularSegments","getMinCircularAngle","getMinCircularEdgeLength","getAnimationDuration","getAnimationFPS","getAnimationMode","setMinCircularAngle","setMinCircularEdgeLength","setCircularSegments","resetToCircularDefaults","setMorphStart","setMorphEnd","setAnimationDuration","setAnimationFPS","setAnimationMode","resetGLTFNodes","isManifoldCAD"];ms()&&(async()=>{const{resolve:a,dirname:u}=await import("./__vite-browser-external-9wXp6ZBx.js"),{fileURLToPath:f}=await import("./__vite-browser-external-9wXp6ZBx.js"),m=typeof __dirname=="string"&&__dirname||typeof import.meta?.dirname=="string"&&import.meta.dirname||u(f(import.meta.url));n=a(m,"./manifoldCAD.ts")})();let o=null;t.onResolve({filter:/.*/},async a=>{if(a.pluginData!==void 0||a.namespace==="http-url"||a.path.match(/^https?:\/\//))return null;!o&&a.kind==="entry-point"&&(o=(0,Gg.default)(a.path,a.resolveDir+"/"));const u={toplevel:a.importer===o||a.importer===e.filename||a.importer==="<stdin>"};if(a.path.match(s))return{namespace:"manifold-cad-globals",path:a.path,pluginData:u};if(e.files&&Object.keys(e.files).includes(a.path))return{namespace:"virtual-file",path:a.path};const f=await t.resolve(a.path,{resolveDir:a.resolveDir,kind:"import-statement",pluginData:{resolveDir:e.resolveDir}});return f.errors.length===0?n&&n===f.path?{namespace:"manifold-cad-globals",path:a.path,pluginData:u}:(f.pluginData={resolveDir:a.resolveDir.endsWith("/")?a.resolveDir:`${a.resolveDir}/`},f):e.fetchRemotePackages!==!1&&e.jsCDN?{path:wc(a.path,e.jsCDN),namespace:"http-url"}:null}),t.onLoad({filter:/.*/,namespace:"manifold-cad-globals"},a=>{const u=a.pluginData?.toplevel?"_manifold_cad_top_level":"_manifold_cad_library";return{contents:`export const {${i}} = ${u};`}}),e.fetchRemotePackages!==!1&&(t.onResolve({filter:/^https?:\/\//},a=>({path:a.path,namespace:"http-url"})),t.onResolve({filter:/.*/,namespace:"http-url"},a=>{const u=new URL(a.path,a.importer).toString();return u===wc(r,e.jsCDN)?{path:u,namespace:"manifold-cad-globals",pluginData:{toplevel:!1}}:{path:u,namespace:"http-url"}}),t.onLoad({filter:/.*/,namespace:"http-url"},async a=>{const u=await fetch(a.path);return u.ok?(rm(`Fetching ${a.path}.`),{contents:await u.text()}):{errors:[{text:await u.text()}]}})),t.onLoad({filter:/.*/,namespace:"virtual-file"},a=>{const u=e.files[a.path],f=xa(u,`file://${a.path}`),m=a.path.match(/\.js$/)?"js":"ts";return{contents:f,loader:m}}),t.onLoad({filter:/.(ts|js)$/},async a=>{const f=await(await import("./__vite-browser-external-9wXp6ZBx.js")).readFile(a.path,"utf8"),m=xa(f,`file://${a.path}`),y=a.path.match(/\.js$/)?"js":"ts";return{contents:m,loader:y}})}}),Ec=!1,im=async(e={})=>{if(!Ec){const t={};typeof Gs=="string"&&Gs&&(t.wasmURL=Gs,t.worker=wf===!0),await vf.initialize(t),Ec=!0}return{bundle:!0,write:!1,platform:"neutral",treeShaking:!1,sourcemap:"inline",sourcesContent:!1,format:"cjs",logLevel:"silent",plugins:[sm(e)],logOverride:{"empty-import-meta":"info"},define:{"import.meta.url":"_import_meta_url"}}},om=async(e,t={})=>{try{let n;if(ms()&&t.filename){const{dirname:s}=await import("./__vite-browser-external-9wXp6ZBx.js");n=t.resolveDir??s(t.filename)}return(await vf.build({...await im(t),stdin:{contents:xa(e,`file://${t.filename}`),sourcefile:t.filename,resolveDir:n,loader:"ts"}})).outputFiles[0].text}catch(n){throw n.errors?.length?new ou(n):n}};si();si();var Ef={};Sa(Ef,{exportFormats:()=>Cm,toArrayBuffer:()=>Om});var bf=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_f=e=>{let t="";for(let n=0;n<16;n++)n%4!=3&&(n>0&&(t+=" "),t+=e[n]||0);return t},am=(e=1,t=bf)=>`    <item objectid="${e}" transform="${_f(t)}" />
`,bc=e=>e?e.toISOString().substring(0,10):"";function lm(e,{unit:t="millimeter",title:n="jscad model",author:r="",description:s="",application:i="jscad",creationDate:o=new Date,license:a="",modificationDate:u}={}){e.push(`<?xml version="1.0" encoding="UTF-8"?>
<model unit="${t}" xml:lang="en-US" xmlns="http://schemas.microsoft.com/3dmanufacturing/core/2015/02" xmlns:slic3rpe="http://schemas.slic3r.org/3mf/2017/06">
  <metadata name="slic3rpe:Version3mf">1</metadata>
  <metadata name="Title">${n}</metadata>
  <metadata name="Designer">${r}</metadata>
  <metadata name="Description">${s||n}</metadata>
  <metadata name="Copyright"></metadata>
  <metadata name="LicenseTerms">${a}</metadata>
  <metadata name="Rating"></metadata>
  <metadata name="CreationDate">${bc(o)}</metadata>
  <metadata name="ModificationDate">${bc(u||o)}</metadata>
  <metadata name="Application">${i}</metadata>
   `)}function cm(e,t,n,r){e.push(`<object id="${t}" type="model"${r==null?"":' name="'+r+'"'}>
`),e.push(` <components>
`),n.forEach(({objectID:s,transform:i})=>{um(e,s,i)}),e.push(` </components>
`),e.push(`</object>
`)}var um=(e,t=1,n=bf)=>{e.push(`    <component objectid="${t}" transform="${_f(n)}" />
`)};function fm(e,t,n,r,s,i){e.push(`  <object id="${t}" type="model"${i?' name="'+i+'"':""}>
   <mesh>
    <vertices>
`);for(let o=0;o<n.length;o+=3)e.push(`     <vertex x="${n[o].toPrecision(s)}" y="${n[o+1].toPrecision(s)}" z="${n[o+2].toPrecision(s)}" />
`);e.push(`    </vertices>
    <triangles>
`);for(let o=0;o<r.length;o+=3)e.push(`     <triangle v1="${r[o]}" v2="${r[o+1]}" v3="${r[o+2]}" />
`);return e.push(`    </triangles>
   </mesh>
  </object>
`),e}var _c={name:"[Content_Types].xml",content:`<?xml version="1.0" encoding="UTF-8"?>
<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">
<Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" />
<Default Extension="model" ContentType="application/vnd.ms-package.3dmanufacturing-3dmodel+xml" />
<Default Extension="png" ContentType="image/png" />
</Types>`};function hm({meshes:e=[],components:t=[],items:n=[],precision:r=17,header:s}){const i=[];return lm(i,s),i.push(`  <resources>
`),n.length==0&&console.error("3MF empty build! Include items or simple."),e.forEach(({id:o,vertices:a,indices:u,name:f})=>fm(i,o,a,u,r,f)),t.forEach(({id:o,children:a,name:u})=>{cm(i,o,a,u)}),i.push(`  </resources>
`),i.push(`<build>
`),n.forEach(({objectID:o,transform:a})=>{i.push(am(o,a))}),i.push(`</build>
`),i.push(`</model>
`),i.join("")}var dm=class{constructor(){this.idSeq=0,this.lines=['<?xml version="1.0" encoding="UTF-8"?>','<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">']}get name(){return"_rels/.rels"}addRel(e,t){this.lines.push(`  <Relationship Target="${e}" Id="rel-${++this.idSeq}" Type="${t}" />`)}add3dModel(e){this.addRel(e,"http://schemas.microsoft.com/3dmanufacturing/2013/01/3dmodel")}addThumbnail(e){this.addRel(e,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/thumbnail")}get content(){return this.lines.join(`
`)+`
</Relationships>`}},Mt=Uint8Array,en=Uint16Array,ja=Int32Array,Ba=new Mt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),$a=new Mt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Rc=new Mt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Rf=function(e,t){for(var n=new en(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var s=new ja(n[30]),r=1;r<30;++r)for(var i=n[r];i<n[r+1];++i)s[i]=i-n[r]<<5|r;return{b:n,r:s}},If=Rf(Ba,2),pm=If.b,wa=If.r;pm[28]=258,wa[258]=28;var gm=Rf($a,0),Ic=gm.r,Sf=new en(32768);for(We=0;We<32768;++We)Un=(We&43690)>>1|(We&21845)<<1,Un=(Un&52428)>>2|(Un&13107)<<2,Un=(Un&61680)>>4|(Un&3855)<<4,Sf[We]=((Un&65280)>>8|(Un&255)<<8)>>1;var Un,We,as=(function(e,t,n){for(var r=e.length,s=0,i=new en(t);s<r;++s)e[s]&&++i[e[s]-1];var o=new en(t);for(s=1;s<t;++s)o[s]=o[s-1]+i[s-1]<<1;var a;for(a=new en(r),s=0;s<r;++s)e[s]&&(a[s]=Sf[o[e[s]-1]++]>>15-e[s]);return a}),or=new Mt(288);for(We=0;We<144;++We)or[We]=8;var We;for(We=144;We<256;++We)or[We]=9;var We;for(We=256;We<280;++We)or[We]=7;var We;for(We=280;We<288;++We)or[We]=8;var We,Qs=new Mt(32);for(We=0;We<32;++We)Qs[We]=5;var We,mm=as(or,9),ym=as(Qs,5),Af=function(e){return(e+7)/8|0},Mf=function(e,t,n){return(n==null||n>e.length)&&(n=e.length),new Mt(e.subarray(t,n))},vm=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],pi=function(e,t,n){var r=new Error(t||vm[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,pi),!n)throw r;return r},Ln=function(e,t,n){n<<=t&7;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8},Wr=function(e,t,n){n<<=t&7;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8,e[r+2]|=n>>16},Qo=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var s=n.length,i=n.slice();if(!s)return{t:Nf,l:0};if(s==1){var o=new Mt(n[0].s+1);return o[n[0].s]=1,{t:o,l:1}}n.sort(function(G,v){return G.f-v.f}),n.push({s:-1,f:25001});var a=n[0],u=n[1],f=0,m=1,y=2;for(n[0]={s:-1,f:a.f+u.f,l:a,r:u};m!=s-1;)a=n[n[f].f<n[y].f?f++:y++],u=n[f!=m&&n[f].f<n[y].f?f++:y++],n[m++]={s:-1,f:a.f+u.f,l:a,r:u};for(var g=i[0].s,r=1;r<s;++r)i[r].s>g&&(g=i[r].s);var p=new en(g+1),M=Ea(n[m-1],p,0);if(M>t){var r=0,R=0,h=M-t,V=1<<h;for(i.sort(function(v,w){return p[w.s]-p[v.s]||v.f-w.f});r<s;++r){var I=i[r].s;if(p[I]>t)R+=V-(1<<M-p[I]),p[I]=t;else break}for(R>>=h;R>0;){var C=i[r].s;p[C]<t?R-=1<<t-p[C]++-1:++r}for(;r>=0&&R;--r){var S=i[r].s;p[S]==t&&(--p[S],++R)}M=t}return{t:new Mt(p),l:M}},Ea=function(e,t,n){return e.s==-1?Math.max(Ea(e.l,t,n+1),Ea(e.r,t,n+1)):t[e.s]=n},Sc=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new en(++t),r=0,s=e[0],i=1,o=function(u){n[r++]=u},a=1;a<=t;++a)if(e[a]==s&&a!=t)++i;else{if(!s&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(s),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(s);i=1,s=e[a]}return{c:n.subarray(0,r),n:t}},Xr=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},Cf=function(e,t,n){var r=n.length,s=Af(t+2);e[s]=r&255,e[s+1]=r>>8,e[s+2]=e[s]^255,e[s+3]=e[s+1]^255;for(var i=0;i<r;++i)e[s+i+4]=n[i];return(s+4+r)*8},Ac=function(e,t,n,r,s,i,o,a,u,f,m){Ln(t,m++,n),++s[256];for(var y=Qo(s,15),g=y.t,p=y.l,M=Qo(i,15),R=M.t,h=M.l,V=Sc(g),I=V.c,C=V.n,S=Sc(R),G=S.c,v=S.n,w=new en(19),N=0;N<I.length;++N)++w[I[N]&31];for(var N=0;N<G.length;++N)++w[G[N]&31];for(var P=Qo(w,7),U=P.t,B=P.l,Z=19;Z>4&&!U[Rc[Z-1]];--Z);var Se=f+5<<3,de=Xr(s,or)+Xr(i,Qs)+o,we=Xr(s,g)+Xr(i,R)+o+14+3*Z+Xr(w,U)+2*w[16]+3*w[17]+7*w[18];if(u>=0&&Se<=de&&Se<=we)return Cf(t,m,e.subarray(u,u+f));var Re,Ie,Ve,wt;if(Ln(t,m,1+(we<de)),m+=2,we<de){Re=as(g,p),Ie=g,Ve=as(R,h),wt=R;var Pt=as(U,B);Ln(t,m,C-257),Ln(t,m+5,v-1),Ln(t,m+10,Z-4),m+=14;for(var N=0;N<Z;++N)Ln(t,m+3*N,U[Rc[N]]);m+=3*Z;for(var at=[I,G],Ft=0;Ft<2;++Ft)for(var dt=at[Ft],N=0;N<dt.length;++N){var pt=dt[N]&31;Ln(t,m,Pt[pt]),m+=U[pt],pt>15&&(Ln(t,m,dt[N]>>5&127),m+=dt[N]>>12)}}else Re=mm,Ie=or,Ve=ym,wt=Qs;for(var N=0;N<a;++N){var Ge=r[N];if(Ge>255){var pt=Ge>>18&31;Wr(t,m,Re[pt+257]),m+=Ie[pt+257],pt>7&&(Ln(t,m,Ge>>23&31),m+=Ba[pt]);var O=Ge&31;Wr(t,m,Ve[O]),m+=wt[O],O>3&&(Wr(t,m,Ge>>5&8191),m+=$a[O])}else Wr(t,m,Re[Ge]),m+=Ie[Ge]}return Wr(t,m,Re[256]),m+Ie[256]},Tm=new ja([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Nf=new Mt(0),xm=function(e,t,n,r,s,i){var o=i.z||e.length,a=new Mt(r+o+5*(1+Math.ceil(o/7e3))+s),u=a.subarray(r,a.length-s),f=i.l,m=(i.r||0)&7;if(t){m&&(u[0]=i.r>>3);for(var y=Tm[t-1],g=y>>13,p=y&8191,M=(1<<n)-1,R=i.p||new en(32768),h=i.h||new en(M+1),V=Math.ceil(n/3),I=2*V,C=function(kt){return(e[kt]^e[kt+1]<<V^e[kt+2]<<I)&M},S=new ja(25e3),G=new en(288),v=new en(32),w=0,N=0,P=i.i||0,U=0,B=i.w||0,Z=0;P+2<o;++P){var Se=C(P),de=P&32767,we=h[Se];if(R[de]=we,h[Se]=de,B<=P){var Re=o-P;if((w>7e3||U>24576)&&(Re>423||!f)){m=Ac(e,u,0,S,G,v,N,U,Z,P-Z,m),U=w=N=0,Z=P;for(var Ie=0;Ie<286;++Ie)G[Ie]=0;for(var Ie=0;Ie<30;++Ie)v[Ie]=0}var Ve=2,wt=0,Pt=p,at=de-we&32767;if(Re>2&&Se==C(P-at))for(var Ft=Math.min(g,Re)-1,dt=Math.min(32767,P),pt=Math.min(258,Re);at<=dt&&--Pt&&de!=we;){if(e[P+Ve]==e[P+Ve-at]){for(var Ge=0;Ge<pt&&e[P+Ge]==e[P+Ge-at];++Ge);if(Ge>Ve){if(Ve=Ge,wt=at,Ge>Ft)break;for(var O=Math.min(at,Ge-2),qe=0,Ie=0;Ie<O;++Ie){var In=P-at+Ie&32767,Lt=R[In],nt=In-Lt&32767;nt>qe&&(qe=nt,we=In)}}}de=we,we=R[de],at+=de-we&32767}if(wt){S[U++]=268435456|wa[Ve]<<18|Ic[wt];var $e=wa[Ve]&31,Ct=Ic[wt]&31;N+=Ba[$e]+$a[Ct],++G[257+$e],++v[Ct],B=P+Ve,++w}else S[U++]=e[P],++G[e[P]]}}for(P=Math.max(P,B);P<o;++P)S[U++]=e[P],++G[e[P]];m=Ac(e,u,f,S,G,v,N,U,Z,P-Z,m),f||(i.r=m&7|u[m/8|0]<<3,m-=7,i.h=h,i.p=R,i.i=P,i.w=B)}else{for(var P=i.w||0;P<o+f;P+=65535){var Sn=P+65535;Sn>=o&&(u[m/8|0]=f,Sn=o),m=Cf(u,m+1,e.subarray(P,Sn))}i.i=o}return Mf(a,0,r+Af(m)+s)},wm=(function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var n=t,r=9;--r;)n=(n&1&&-306674912)^n>>>1;e[t]=n}return e})(),Em=function(){var e=-1;return{p:function(t){for(var n=e,r=0;r<t.length;++r)n=wm[n&255^t[r]]^n>>>8;e=n},d:function(){return~e}}},bm=function(e,t,n,r,s){if(!s&&(s={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),o=new Mt(i.length+e.length);o.set(i),o.set(e,i.length),e=o,s.w=i.length}return xm(e,t.level==null?6:t.level,t.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,n,r,s)},Of=function(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n},_t=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8};function _m(e,t){return bm(e,t||{},0,0)}var Df=function(e,t,n,r){for(var s in e){var i=e[s],o=t+s,a=r;Array.isArray(i)&&(a=Of(r,i[1]),i=i[0]),i instanceof Mt?n[o]=[i,a]:(n[o+="/"]=[new Mt(0),a],Df(i,o,n,r))}},Mc=typeof TextEncoder<"u"&&new TextEncoder,Rm=typeof TextDecoder<"u"&&new TextDecoder,Im=0;try{Rm.decode(Nf,{stream:!0}),Im=1}catch{}function ls(e,t){var n;if(Mc)return Mc.encode(e);for(var r=e.length,s=new Mt(e.length+(e.length>>1)),i=0,o=function(f){s[i++]=f},n=0;n<r;++n){if(i+5>s.length){var a=new Mt(i+8+(r-n<<1));a.set(s),s=a}var u=e.charCodeAt(n);u<128||t?o(u):u<2048?(o(192|u>>6),o(128|u&63)):u>55295&&u<57344?(u=65536+(u&1047552)|e.charCodeAt(++n)&1023,o(240|u>>18),o(128|u>>12&63),o(128|u>>6&63),o(128|u&63)):(o(224|u>>12),o(128|u>>6&63),o(128|u&63))}return Mf(s,0,i)}var ba=function(e){var t=0;if(e)for(var n in e){var r=e[n].length;r>65535&&pi(9),t+=r+4}return t},Cc=function(e,t,n,r,s,i,o,a){var u=r.length,f=n.extra,m=a&&a.length,y=ba(f);_t(e,t,o!=null?33639248:67324752),t+=4,o!=null&&(e[t++]=20,e[t++]=n.os),e[t]=20,t+=2,e[t++]=n.flag<<1|(i<0&&8),e[t++]=s&&8,e[t++]=n.compression&255,e[t++]=n.compression>>8;var g=new Date(n.mtime==null?Date.now():n.mtime),p=g.getFullYear()-1980;if((p<0||p>119)&&pi(10),_t(e,t,p<<25|g.getMonth()+1<<21|g.getDate()<<16|g.getHours()<<11|g.getMinutes()<<5|g.getSeconds()>>1),t+=4,i!=-1&&(_t(e,t,n.crc),_t(e,t+4,i<0?-i-2:i),_t(e,t+8,n.size)),_t(e,t+12,u),_t(e,t+14,y),t+=16,o!=null&&(_t(e,t,m),_t(e,t+6,n.attrs),_t(e,t+10,o),t+=14),e.set(r,t),t+=u,y)for(var M in f){var R=f[M],h=R.length;_t(e,t,+M),_t(e,t+2,h),e.set(R,t+4),t+=4+h}return m&&(e.set(a,t),t+=m),t},Sm=function(e,t,n,r,s){_t(e,t,101010256),_t(e,t+8,n),_t(e,t+10,n),_t(e,t+12,r),_t(e,t+16,s)};function Am(e,t){t||(t={});var n={},r=[];Df(e,"",n,t);var s=0,i=0;for(var o in n){var a=n[o],u=a[0],f=a[1],m=f.level==0?0:8,y=ls(o),g=y.length,p=f.comment,M=p&&ls(p),R=M&&M.length,h=ba(f.extra);g>65535&&pi(11);var V=m?_m(u,f):u,I=V.length,C=Em();C.p(u),r.push(Of(f,{size:u.length,crc:C.d(),c:V,f:y,m:M,u:g!=o.length||M&&p.length!=R,o:s,compression:m})),s+=30+g+h+I,i+=76+2*(g+h)+(R||0)+I}for(var S=new Mt(i+22),G=s,v=i-s,w=0;w<r.length;++w){var y=r[w];Cc(S,y.o,y,y.f,y.u,y.c.length);var N=30+y.f.length+ba(y.extra);S.set(y.c,y.o+N),Cc(S,s,y,y.f,y.u,y.c.length,y.o,y.m),s+=16+N+(y.m?y.m.length:0)}return Sm(S,s,r.length,v,G),S}vu();var Mm={extension:"3mf",mimetype:"model/3mf"},Cm=[Mm],Nm={unit:"millimeter",title:"ManifoldCAD.org model",description:"ManifoldCAD.org model",application:"ManifoldCAD.org"};async function Om(e,t){const n={meshes:[],components:[],items:[],precision:7,header:{...Nm,...t?.header??{}}};let r=1;const s=new Map,i=p=>`${s.get(p)}`,o=p=>{const{clonedFrom:M}=p.getExtras();return M?s.get(M):s.get(p)},a=p=>{const M=`${r++}`;return s.set(p,M),M};for(const p of e.getRoot().listMeshes()){const M=p.getExtension("EXT_mesh_manifold");if(M){const h=M.getIndices(),V=p.listPrimitives()[0].getAttribute("POSITION"),I=a(p);n.meshes.push({vertices:V.getArray(),indices:h.getArray(),id:I})}const{clonedFrom:R}=p.getExtras();!M&&R||!M&&!R&&console.log("skipping non-ManifoldCAD mesh")}const u=e.getRoot().listNodes().reverse();for(const p of u){const M=p.getMesh()&&o(p.getMesh());n.components.push({id:a(p),name:p.getName(),children:M?[{objectID:M}]:[],transform:p.getMatrix().map(R=>R.toFixed(n.precision))})}for(const p of e.getRoot().listNodes()){const M=i(p);if(!M){console.log(`Could not find object ID for ${p.getName()}`);continue}const R={objectID:M,transform:p.getMatrix().map(V=>V.toFixed(n?.precision))},h=p.getParentNode();if(h){const V=i(h);n.components.find(C=>C.id==V).children.push(R)}else n.items.push({objectID:M})}const f=new dm;f.add3dModel("3D/3dmodel.model");const m=hm(n),y={};return y["3D/3dmodel.model"]=ls(m),y[_c.name]=ls(_c.content),y[f.name]=ls(f.content),Am(y).buffer}li();ii();var Va=[];Ff(Da);Ff(Ef);function Pf(e){const t=Va.flatMap(r=>r.exportFormats),n=Oa(e,t)??Na(e,t);if(!n)throw new Ca(e,t);return n}function Dm(e){const t=typeof e=="string"?Pf(e):e;return Va.find(n=>n.exportFormats.includes(t))}function Ff(e){Va.push(e)}async function Pm(e,t={}){if(!(t.mimetype||t.extension))throw new Error("Must specify a mimetype or extension when exporting to a Blob.");const n=Pf(t.mimetype||t.extension),r=await Dm(n).toArrayBuffer(e,t);return new Blob([r],{type:n.mimetype})}Hu();lr();Fa();ar();Ju();ri();ka();li();lr();Ua();ys();Aa();Ar();ri();ka();lr();Fa();ys();function Fm(){wd(),jg(),Fg(),Qu()}function Ut(...e){typeof self<"u"&&self.console&&self.console.log(...e)}function Ga(e,t,n){const r=Xi(e,"translation",t,n);r!=null&&n.setTranslation(r);const s=Xi(e,"rotation",t,n);s!=null&&n.setRotation(ti(s));const i=Xi(e,"scale",t,n);i!=null&&n.setScale(i)}function Um(e,t,n,r={}){n.name&&t.setName(n.name);const s=n.manifold,i=s.getMesh(),o=n.name?`"${n.name}"`:"object";Ut(`Exporting Manifold ${o} as mesh:`),Ut(`  Triangles: ${s.numTri().toLocaleString()}`);const a=s.boundingBox(),u=[0,0,0];for(let R=0;R<3;R++)u[R]=Math.round((a.max[R]-a.min[R])*10)/10;Ut(`  Bounding Box: X = ${u[0].toLocaleString()} mm, Y = ${u[1].toLocaleString()} mm, Z = ${u[2].toLocaleString()} mm`),Ut(`  Genus: ${s.genus().toLocaleString()}`);const f=Math.round(s.volume()/10);Ut(`  Volume: ${(f/100).toLocaleString()} cm^3`);const m=new Map;for(const R of i.runOriginalID){const h=sf(R)||r;m.set(R,{material:ds(e,h),attributes:["POSITION",...h.attributes??[]]})}const y=eu(s),g=bd(i,y),p=ai(e,i,m);t.setMesh(p),_d(e,i,p,g,y);const M=of(e,i,m,r);for(const R of M)t.addChild(R)}function Lm(e,t,n){t.setName(n.name||`CrossSection_${n.runID}`);const r=n.crossSection,{Mesh:s,triangulate:i}=Rn(),o=r.toPolygons(),a=i(o);Ut(`Exporting CrossSection ${n.name?`"${n.name}"`:"object"} as mesh:`),Ut(`  Triangles: ${a.length.toLocaleString()}`);const u=r.bounds(),f=[0,0];for(let M=0;M<2;M++)f[M]=Math.round((u.max[M]-u.min[M])*10)/10;Ut(`  Bounding Box: X = ${f[0].toLocaleString()} mm, Y = ${f[1].toLocaleString()} mm`);const m=Math.round(r.area());Ut(`  Area: ${(m/100).toLocaleString()} cm^2`);const y=new Map;y.set(n.runID,{material:ds(e,{baseColorFactor:[1,0,1],...n.material??{},doubleSided:!0}),attributes:["POSITION"]});const g=new s({numProp:3,vertProperties:new Float32Array(o.flat().map(M=>[...M,0]).flat()),triVerts:new Uint32Array(a.flat()),runIndex:new Uint32Array([0,3*a.length]),runOriginalID:new Uint32Array(a.length).fill(n.runID)}),p=ai(e,g,y,!1);t.setMesh(p)}function Uf(e,t){e.setMesh(t.getMesh()),t.listChildren().forEach(n=>{const r=n.clone();e.addChild(r)})}function km(e,t,n,r,s){Uf(t,n);const i=n.getMesh(),o=e.createMesh();t.setMesh(o),i.listPrimitives().forEach(a=>{const u=a.clone();a.getMaterial()===s&&u.setMaterial(r),o.addPrimitive(u)}),o.setExtras({clonedFrom:i})}function jm(e,t,n){const r=e.createNode(t.name);Ga(e,t,r),t instanceof sr&&Ed(e,r,t.manifold);const s=()=>t instanceof ir?t.crossSection:t.manifold,i=n.get(s()),o=tf(t);if(i==null){t instanceof ir?Lm(e,r,t):Um(e,r,t,o);const a=new Map;a.set(o,r),n.set(s(),a)}else{const a=i.get(o);if(a==null){const[u,f]=i.entries().next().value;km(e,r,f,ds(e,o),ds(e,u)),i.set(o,r)}else Uf(r,a)}return r}function Bm(e,t){const n=t.document;let r=null;if(t.node){const s=t.node;r=ma(e,n,[s]).get(s)}else{r=e.createNode();const s=n.getRoot().listNodes(),i=ma(e,n,s);for(const o of s)o.getParentNode()||r.addChild(i.get(o))}return Ga(e,t,r),r}function $m(e){const n=e.createNode("wrapper");return n.setRotation(ti([-90,0,0])),n.setScale([.001,.001,.001]),e.createScene().addChild(n),n}async function Vm(e){const t=new Ls;t.createBuffer(),Sd(t);const n=new Map,r=new Map;let s=0,i=0,o=0,a=0;for(const f of e){let m=null;f.isEmpty()?(m=t.createNode(f.name),Ga(t,f,m),++a):f instanceof ei?(m=Bm(t,f),++i):(m=jm(t,f,r),f instanceof sr&&++s,f instanceof ir&&++o),n.set(f,m)}const u=$m(t);for(const f of e){const m=n.get(f),{parent:y}=f;y?n.get(y).addChild(m):u.addChild(m)}return Ut(`Total glTF nodes: ${e.length}`),s&&Ut(`  Manifold meshes: ${s}`),o&&Ut(`  CrossSection meshes: ${o}`),i&&Ut(`  Visualization-only (imported) nodes: ${i}`),a&&Ut(`  Nodes without geometry: ${a}`),Ad(),await t.transform(zp()),t}ii();Ar();var Gm=Object.getPrototypeOf(async function(){}).constructor;function _a(...e){typeof self<"u"&&self.console&&self.console.log(...e)}function zm(){Gu(),Fm(),Xu(),Xc()}async function Hm(e,t={}){zm();const n=performance.now(),{doNotBundle:r,...s}=t,i=r===!0?e:await om(e,s),o=performance.now();r!==!0&&_a(`Bundling code took ${((o-n)/1e3).toFixed(2)} seconds`);const u={...await Vg().then(()=>af),isManifoldCAD:()=>!0},f={...u,GLTFNode:Wc,getGLTFNodes:wl,resetGLTFNodes:zc},m={setCircularSegments:Ip,setMinCircularAngle:_p,setMinCircularEdgeLength:Rp,resetToCircularDefaults:Wu,setAnimationDuration:yd,setAnimationFPS:Td,setAnimationMode:gd,_manifold_cad_top_level:f,_manifold_cad_library:u,_manifold_runtime_url:t.baseUrl??null,exports:{},module:{exports:{default:null}}};let y=null;try{await new Gm(...Object.keys(m),i)(...Object.values(m)),y=m.module?.exports?.default,typeof y=="function"&&(y=await y())}catch(R){const h=yu(i,R,-2);let V=null;const I=Object.keys(f).find(C=>R.message.match(C));throw R.name==="ReferenceError"&&I?V=new ks(R,R.message+`.  Import it by adding \`import {${I}} from 'manifold-3d/manifoldCAD';\` to the top of your model.`):R.name==="ReferenceError"&&R.message.match(/glMatrix/)?V=new ks(R,"ManifoldCAD no longer includes gl-matrix directly.  Import it by adding `import * as glMatrix from 'gl-matrix';` to the top of your model."):V=new ks(R),V.manifoldStack=h,V}if(!y||Array.isArray(y)&&!y.length)throw wl().length?new Error("GLTF Nodes were created, but not exported.  Add `const nodes = getGLTFNodes();` and `export default nodes;` to the end of your model."):new Error("No output as no model was exported.  Add a default export (e.g.: `export default result;`) to the bottom of your model.  The default export must be a `Manifold` or `GLTFNode` object, an array of `Manifold` or `GLTFNode` objects, or a function that returns any of the above.");const g=await Hc(y),p=await Vm(g),M=performance.now();return _a(`Manifold took ${((M-o)/1e3).toFixed(2)} seconds`),p}var Wm=async(e,t)=>{const n=performance.now(),r=await Pm(e,{extension:t}),s=URL.createObjectURL(r),i=performance.now();return _a(`Exporting ${t.toUpperCase()} took ${(Math.round((i-n)/10)/100).toLocaleString()} seconds`),s},Xm=()=>{const e=()=>{if(console.debug("Intercepting console.log() in manifoldCAD worker."),self.console){const o=self.console.log;self.console.log=function(...a){let u="";for(const f of a)f==null?u+="undefined":typeof f=="object"?u+=JSON.stringify(f,null,4):u+=f.toString();self.postMessage({type:"log",message:u}),o(...a)}}},t=o=>{console.error(o),o.cause&&console.error("Caused by:",o.cause),o.manifoldStack&&console.error("manifoldStack:",o.manifoldStack),self.postMessage({type:"error",name:o.name,message:o.message,stack:o.manifoldStack??o.stack})},n=async o=>{try{console.debug("Initializing ManifoldCAD worker."),o.manifoldWasmUrl&&fd(o.manifoldWasmUrl),o.esbuildWasmUrl&&em(o.esbuildWasmUrl),tm(o.esbuildHasOwnWorker===!0),await Gc(),e(),self.postMessage({type:"ready"}),console.debug("Successfully initialized ManifoldCAD worker!")}catch(a){t(a)}};let r=null;const s=async o=>{try{const{code:a,...u}=o;r=await Hm(o.code,u),self.postMessage({type:"done"})}catch(a){t(a)}},i=async o=>{try{self.postMessage({type:"blob",extension:o.extension,blobURL:await Wm(r,o.extension)})}catch(a){t(a)}};self.onmessage=async o=>{const a=o.data;a.type==="initialize"?n(a):a.type==="evaluate"?s(a):a.type==="export"&&i(a)}};mu()&&Xm();
