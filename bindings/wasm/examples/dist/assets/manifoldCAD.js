import"./modulepreload-polyfill.js";function H(){return new Worker("/assets/worker-c7ca4872.js",{type:"module"})}const m=self.examples.functionBodies;navigator.serviceWorker&&navigator.serviceWorker.register("/service-worker.js",{scope:"./index.html"});let i;const K=document.querySelector("#file"),d=document.querySelector("#current"),j=document.querySelector(".uparrow"),E=document.querySelector(".dropdown"),G=function(){E.classList.remove("show"),j.classList.remove("down")},J=function(e){e.stopPropagation(),E.classList.toggle("show"),j.classList.toggle("down")};K.onclick=J;document.body.onclick=G;const g="ManifoldCAD";function w(e){return window.localStorage.getItem(g+e)}function f(e,t){window.localStorage.setItem(g+e,t)}function D(e){window.localStorage.removeItem(g+e)}function Q(e){if(e>=window.localStorage.length)return;const t=window.localStorage.key(e);if(t.startsWith(g))return t.slice(g.length)}function x(){if(i){const e=d.textContent;m.get(e)||f(e,i.getValue())}}window.onpagehide=x;window.beforeunload=x;let S=!1,R=!0;function L(e){if(i){S=!0,d.textContent=e,f("currentName",e);const t=m.get(e)??w(e)??"";R=m.get(e)!=null,i.setValue(t)}}function k(e){const t=document.createElement("div");t.classList.add("item");const n=document.createElement("button");t.appendChild(n),n.type="button",n.classList.add("blue","item");const c=document.createElement("span");return n.appendChild(c),c.textContent=e,n.onclick=function(){x(),L(c.textContent)},n.onkeyup=function(o){o.preventDefault()},n}function I(e){const t=document.createElement("button");return t.classList.add("icon"),e.parentElement.appendChild(t),t}function A(e){let t=1,n=e;for(;w(n)!=null||m.get(n)!=null;)n=e+" "+t++;return n}function B(e){const t=e.firstChild,n=I(e);n.classList.add("edit"),n.onclick=function(a){a.stopPropagation();const l=t.textContent,V=w(l),y=document.createElement("form"),u=document.createElement("input");u.value=l,t.textContent="",e.appendChild(y),y.appendChild(u),u.focus(),u.setSelectionRange(0,l.length);function F(){const h=u.value;if(u.blur(),!h)return;const v=A(h);t.textContent=v,d.textContent==l&&(d.textContent=v),D(l),f(v,V)}y.onsubmit=F,u.onclick=function(h){h.stopPropagation()},u.onblur=function(){e.removeChild(y),t.textContent=l}};const c=I(e);c.classList.add("trash");let o=0;c.onclick=function(a){if(a.stopPropagation(),e.classList.contains("blue"))o=performance.now(),e.classList.remove("blue"),e.classList.add("red"),document.body.addEventListener("click",function(){e.classList.add("blue"),e.classList.remove("red")},{once:!0});else if(performance.now()-o>500){D(t.textContent),d.textContent==t.textContent&&L("Intro");const l=e.parentElement;l.parentElement.removeChild(l)}}}const M=document.querySelector("#new");function P(e){const t=A("New Script");f(t,e);const n=k(t);M.insertAdjacentElement("afterend",n.parentElement),B(n),n.click()}M.onclick=function(){P("")};const r=document.querySelector("#compile"),T=document.querySelector("#poster");let b=!1,N=!0;function $(){r.disabled=!1,N?r.click():T.textContent="Auto-run disabled due to prior failure"}let q;async function X(){const e=await fetch("/manifold-global-types.d.ts").then(n=>n.text()),t=await fetch("/manifold-encapsulated-types.d.ts").then(n=>n.text());return`
${e.replaceAll("export","")}
${t.replace(/^import.*$/gm,"").replaceAll("export","declare")}
declare interface ManifoldStatic {
  cube: typeof cube;
  cylinder: typeof cylinder;
  sphere: typeof sphere;
  smooth: typeof smooth;
  tetrahedron: typeof tetrahedron;
  extrude: typeof extrude;
  revolve: typeof revolve;
  union: typeof union;
  difference: typeof difference;
  intersection: typeof intersection;
  compose: typeof compose;
  levelSet: typeof levelSet;
  setMinCircularAngle: typeof setMinCircularAngle;
  setMinCircularEdgeLength: typeof setMinCircularEdgeLength;
  setCircularSegments: typeof setCircularSegments;
  getCircularSegments: typeof getCircularSegments;
  reserveIDs: typeof reserveIDs;
}
declare const module: ManifoldStatic;
`}require.config({paths:{vs:"https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.0/min/vs"}});require(["vs/editor/editor.main"],async function(){async function e(c){const o=await fetch(c).then(a=>a.text());monaco.languages.typescript.typescriptDefaults.addExtraLib(o)}monaco.languages.typescript.typescriptDefaults.addExtraLib(await X()),await e("/editor.d.ts"),i=monaco.editor.create(document.getElementById("editor"),{language:"typescript",automaticLayout:!0}),q=await(await monaco.languages.typescript.getTypeScriptWorker())(i.getModel().uri),i.getModel().updateOptions({tabSize:2});for(const[c]of m){const o=k(c);E.appendChild(o.parentElement)}let n=d.textContent;for(let c=0;c<window.localStorage.length;c++){const o=Q(c);if(o)if(o==="currentName")n=w(o);else if(o==="safe")N=w(o)!=="false";else{const a=k(o);M.insertAdjacentElement("afterend",a.parentElement),B(a)}}L(n),b&&$(),i.onDidChangeModelContent(c=>{if(r.disabled=!1,S){S=!1;return}if(R){const o=i.getPosition();P(i.getValue()),i.setPosition(o)}}),window.onresize=()=>{i.layout({})}});const s=document.querySelector("#console"),Y=console.log;console.log=function(e){s.textContent+=e+`\r
`,s.scrollTop=s.scrollHeight,Y(e)};function Z(){s.textContent=""}function _(){r.firstChild.style.visibility="hidden",r.classList.add("red","cancel")}function ee(){r.firstChild.style.visibility="visible",r.classList.remove("red","cancel")}let z=performance.now();function O(){ee();const e=performance.now(),t=s.textContent;s.textContent=t.substring(t.indexOf(`
`)+1),console.log(`Took ${(Math.round((e-z)/10)/100).toLocaleString()} seconds`)}const W=document.querySelector("model-viewer");let p=null,C=null;function U(){C=new H,C.onmessage=function(e){if(e.data==null){q!=null&&!b&&$(),b=!0;return}if(e.data.log!=null){s.textContent+=e.data.log+`\r
`,s.scrollTop=s.scrollHeight;return}O(),r.disabled=!0,f("safe","true"),URL.revokeObjectURL(p),p=e.data.objectURL,W.src=p,p==null&&(W.showPoster(),T.textContent="Error")}}U();async function te(){x(),f("safe","false"),_(),Z(),console.log("Running...");const e=await q.getEmitOutput(i.getModel().uri.toString());C.postMessage(e.outputFiles[0].text),z=performance.now()}function ne(){C.terminate(),U(),O(),console.log("Run canceled")}r.onclick=function(){r.classList.contains("cancel")?ne():te()};const oe=document.querySelector("#download");oe.onclick=function(){const e=document.createElement("a");e.download="manifold.glb",e.href=p,e.click()};
